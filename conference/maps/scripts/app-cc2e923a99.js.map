{"version":3,"sources":["scripts/app.js"],"names":["angular","module","controller","$meeting","$member","$rootScope","$scope","$q","$location","$log","$mdSidenav","$base64","sharedProperties","localStorageService","getMembersOfRoom","room","deffered","defer","membersList","info","token","meetingId","_id","listMember","result","status","data","memberList","error","resolve","promise","getRoomsList","roomsList","listMeeting","meetingList","get","toggleSidenav","eleId","toggle","showRoomDetail","then","gotoEditRoom","set","path","reverse","$mdToast","viMdToast","_","updateRoomsList","map","updateRoom","meeting","id","name","meetingRef","welcome","duration","logoutUrl","base64EncodedString","encode","encodeURIComponent","updateMeeting","success","updateMembersList","action","memberId","memberIdx","member","unshift","findIndex","splice","addMember","updateMember","role","toLowerCase","removeMember","decodeURIComponent","decode","showMemberForm","cancel","save","saveMember","showEditMemberForm","showAddMemberForm","cancelMember","showMemberDetail","Fullscreen","createRoom","createMeeting","$auth","auth","emailLogin","passwordLogin","loginAccount","email","password","loginAccountKeyPress","event","code","directive","$http","$timeout","restrict","templateUrl","link","measureDownloadSpeed","startTime","endTime","deferred","Date","getTime","method","url","imageUrl","response","bitsLoaded","downloadSize","speedDownBps","toFixed","speedDownKbps","speedDownMbps","speedDownMbpsOri","Number","protocol","host","port","measureDownloadSpeedArr","measureDownloadSpeedAverage","i","push","reduce","previousValue","currentValue","factory","http","callback","param","toJson","postRequest","putRequest","deleteRequest","getRequest","login","trustedLogin","payload","checksum","endMeeting","getMeeting","setMeetingConfig","config","getMeetingConfig","uploadFile","file","uploadRequest","socketUrl","ws","WebSocket","exc","apiUrl","blockUI","transform","str","p","join","req","headers","Content-Type","transformRequest","timeout","start","stop","params","xhr","XMLHttpRequest","fd","FormData","open","onreadystatechange","readyState","fromJson","responseText","append","send","$routeParams","$interval","$sce","$socket","$window","deviceDetector","iceServers","$recorder","ngAudio","$activityIndicator","toastr","$route","pdfDelegate","RoomMember","profile","this","avail","invited","pubWebRtcEndpoint","pubOfferSdp","pubState","PUB_INITIAL","pubGatherToken","pubTimeoutToken","pubCandidateSendQueue","subWebRtcEndpoint","subOfferSdp","subState","SUB_INITIAL","subGatherToken","subCandidateSendQueue","pubCamera","subVideoSlot","markedForSubscription","init","audio","video","handUp","notiHandUp","toggleVideoFlag","sound","load","pdfUrl","zoom","countAllocated","myProfile","memberProfiles","videoSlots","chatMessage","count","each","allocated","videoId","index","me","find","m","document","getElementById","presenter","viewerList","filter","sendMessage","message","jsonMessage","JSON","stringify","location","reload","joinResponse","publish","receiveWhiteboard","whiteboard","options","localVideo","localCamera","onicecandidate","onPublishIceCandidate","oncandidategatheringdone","onPublishComplete","kurentoUtils","WebRtcPeer","WebRtcPeerSendonly","stopAnimating","generateOffer","onPublish","startAnimating","PUB_CONNECTING","sendPublishData","GATHER_TIMEOUT","candidate","offerSdp","publishResponse","disconnect","processAnswer","sdpAnswer","candidateList","addIceCandidate","PUB_CONNECTED","length","sdpOffer","CALLING_TIMEOUT","unsubscribe","close","e","subscribe","slot","s","SUB_INPROGRESS","remoteCamera","remoteVideo","onSubscribeIceCandidate","bind","onSubscribeComplete","SUB_CONNECTING","sendSubscribeData","WebRtcPeerRecvonly","onSubscribe","subSdpOffer","subscribeResponse","pubId","muted","SUB_CONNECTED","nextSubscriber","endConference","href","memberStatus","updateMemberList","onlineList","unSubList","curVal","newVal","online","receiveChat","user","text","msg","onWhiteboardEvent","object","getPageInfo","receiveWhiteboardEvent","$getByHandle","next","zoomOut","zoomIn","currPage","getCurrentPage","totalPages","getPageCount","PUB_INPROGRESS","connect","loop","play","onmessage","parsedMessage","parse","console","handDown","$apply","resubscribe","publisher","leave","endLesson","toggleAudio","localStream","getLocalStream","audioTrack","getAudioTracks","enabled","toggleVideo","videoTrack","getVideoTracks","toggleHand","toggleMainVideo","memberInvite","inviteeId","memberDiscard","chat","chatInput","sendChatMessage","$event","byIndex","$on","current","onbeforeunload","recordToken","pdfNext","pdfPrev","prev","uploadDoc","log","trustedLoginKind","loginMeeting","all","kind","loginMeetingKeyPress","meetingAuth","width","numOfAllocated","getAllocatedSlots","calcGridSlots","slotsPerRow","slotsList","rows","Math","floor","firstSlot","allocatedSlotArr","disableState","$routeProvider","when","controllerAs","otherwise","redirectTo","utilities","resizeImg","img","maxWidth","maxHeight","degrees","imgWidth","imgHeight","height","ratio","ratio1","ratio2","canvas","createElement","canvasContext","getContext","canvasCopy","copyContext","canvasCopy2","copyContext2","drawImage","rounds","roundRatio","clearRect","translate","rotate","PI","dataURL","toDataURL","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","offset","slice","byteNumbers","Array","charCodeAt","byteArray","Uint8Array","blob","Blob","type","handleDataAvailable","size","recordedBlobs","browser","recording","superBuffer","File","onFileReady","handleStop","mediaRecorder","stream","mimeType","MediaRecorder","isTypeSupported","alert","onstop","ondataavailable","scope","element","attrs","which","$eval","keyEnter","preventDefault","$parse","model","fileModel","modelSetter","assign","files","$templateCache","$interpolate","elem","ctrl","clickoutHandlerForDropdown","mousedownOn","hideResults","body","removeEventListener","handleRequired","valid","notEmpty","validState","searchStr","fieldRequired","inputName","$setValidity","requiredClassName","callOrAssign","value","selectedObject","extractValue","obj","key","keys","split","extractTitle","titleField","field","handleInputChange","newval","initial","originalObject","clearResults","showDropdown","results","dd","scrollTop","ie8EventNormalizer","keyCode","callFunctionOrIdentity","fn","setInputString","clearSelected","findMatchString","target","matches","re","RegExp","replace","match","toString","matchClass","trustAsHtml","initResults","displaySearching","currentIndex","focusFirst","searchTimerComplete","minlength","localData","getLocalResults","remoteApiHandler","getRemoteResultsWithCustomHandler","getRemoteResults","keyupHandler","KEY_LF","KEY_RT","KEY_UP","KEY_EN","KEY_DW","searching","KEY_ES","inputField","val","searchTimer","pause","cancelHttpRequest","httpCanceller","handleOverrideSuggestions","overrideSuggestions","dropdownRowOffsetHeight","row","css","getComputedStyle","offsetHeight","parseInt","marginTop","marginBottom","dropdownHeight","getBoundingClientRect","top","dropdownRow","querySelectorAll","dropdownRowTop","paddingTop","dropdownScrollTopTo","updateInputField","title","keydownHandler","rowTop","selectResult","isScrollOn","bottom","KEY_TAB","$digest","processResults","responseData","description","image","formattedText","formattedDesc","subTitleField","descriptionField","imageField","autoMatch","checkExactMatch","desc","displayNoResults","httpSuccessCallbackGen","responseFormatter","remoteUrlDataField","httpErrorCallback","errorRes","remoteUrlErrorCallback","remoteUrl","remoteUrlRequestFormatter","remoteUrlRequestWithCredentials","withCredentials","searchFields","parseInput","indexOf","showAll","hideTimer","unbindInitialValue","MIN_LENGTH","REQUIRED_CLASS","querySelector","on","addEventListener","className","$watch","oldval","elementId","onFocusHandler","focusIn","BLUR_TIMEOUT","focusOut","resetHideResults","hoverRow","inputChangeHandler","inputChanged","fieldRequiredClass","PAUSE","initialValue","inputType","textSearching","TEXT_SEARCHING","textNoResults","TEXT_NORESULTS","maxlength","MAX_LENGTH","overflowY","TEMPLATE_URL","put","require","disableInput","remoteUrlResponseFormatter","placeholder","inputClass","compile","tElement","startSym","startSymbol","endSym","endSymbol","interpolatedHtml","html","$sceDelegateProvider","localStorageServiceProvider","constant","credential","username","service","objectValue","setObject","getObject","showToast","msgClass","show","simple","textContent","position","toastClass","hideDelay","timeDelay","errorClass","successClass","run","debug","base64Str","$logProvider","$mdThemingProvider","$mdIconProvider","$translateProvider","toastrConfig","enabledLog","$activityIndicatorProvider","debugEnabled","allowHtml","timeOut","positionClass","preventDuplicates","closeButton","progressBar","useStaticFilesLoader","prefix","suffix","preferredLanguage","fallbackLanguage","setActivityIndicatorStyle"],"mappings":"AAAA,YACAA,SAAQC,OAAO,cAAe,MAAO,SAAU,SAAU,aAAc,qBACnE,yBAAyB,WAQ7BD,QAAQC,OAAO,cACdC,WAAW,sBAAA,WAAA,UAAA,aAAA,SAAA,KAAA,YAAA,OAAA,aAAA,UAAA,mBAAA,sBAAsB,SAAUC,EAAUC,EAASC,EAAYC,EAAQC,EAAIC,EAAWC,EAAMC,EAAYC,EAASC,EAAkBC,GAI3I,QAASC,GAAiBC,GACtB,GAAIC,GAAcT,EAAGU,QACjBC,EAAc,KACdC,GACIC,MAAOd,EAAOc,MACdC,UAAWN,EAAKO,IAaxB,OAVAlB,GAAQmB,WAAWJ,EAAM,SAASK,GAC1BA,EAAOC,OACPP,EAAcM,EAAOE,KAAKC,WAE1BlB,EAAKmB,MAAM,yBAA0BJ,GAGzCR,EAASa,QAAQX,KAGdF,EAASc,QAqBpB,QAASC,KACL,GAAIf,GAAcT,EAAGU,QACjBe,EAAc,KACdb,GACIC,MAAOd,EAAOc,MAatB,OAVAjB,GAAS8B,YAAYd,EAAM,SAASK,GAC5BA,EAAOC,OACPO,EAAYR,EAAOE,KAAKQ,YAExBzB,EAAKmB,MAAM,wBAAyBJ,GAGxCR,EAASa,QAAQG,KAGdhB,EAASc,QA3DpBxB,EAAOc,MAAQP,EAAoBsB,IAAI,mBACvC7B,EAAOS,KAAO,KAuBdT,EAAO8B,cAAgB,SAASC,GAC5B3B,EAAW2B,GAAOC,UAGtBhC,EAAOiC,eAAiB,SAASxB,GAC7BT,EAAOS,KAAOA,EAEdD,EAAiBC,GAChByB,KAAK,SAAStB,GACXZ,EAAOS,KAAKG,YAAcA,EAAcA,QAIhDZ,EAAOmC,aAAe,WAClB5B,EAAoB6B,IAAI,YAAapC,EAAOS,MAC5CP,EAAUmC,KAAK,sBAuBnBZ,IACCS,KAAK,SAASR,GACX1B,EAAO0B,UAAYA,EAAYA,EAAUY,kBASjD5C,QAAQC,OAAO,cACdC,WAAW,qBAAA,WAAA,UAAA,aAAA,SAAA,KAAA,YAAA,OAAA,WAAA,aAAA,UAAA,YAAA,mBAAA,sBAAA,IAAqB,SAAUC,EAAUC,EAASC,EAAYC,EAAQC,EAAIC,EAAWC,EAAMoC,EAAUnC,EAAYC,EAASmC,EAAWlC,EAAkBC,EAAqBkC,GAWpL,QAAShB,KACL,GAAIf,GAAcT,EAAGU,QACjBe,EAAc,KACdb,GACIC,MAAOd,EAAOc,MAatB,OAVAjB,GAAS8B,YAAYd,EAAM,SAASK,GAC5BA,EAAOC,OACPO,EAAYR,EAAOE,KAAKQ,YAExBzB,EAAKmB,MAAM,wBAGfZ,EAASa,QAAQG,KAGdhB,EAASc,QAGpB,QAAShB,KACL,GAAIE,GAAcT,EAAGU,QACjBC,EAAc,KACdC,GACIC,MAAOd,EAAOc,MACdC,UAAWf,EAAOS,KAAKO,IAa/B,OAVAlB,GAAQmB,WAAWJ,EAAM,SAASK,GAC1BA,EAAOC,OACPP,EAAcM,EAAOE,KAAKC,WAE1BlB,EAAKmB,MAAM,yBAGfZ,EAASa,QAAQX,KAGdF,EAASc,QAepB,QAASkB,KACL1C,EAAO0B,UAAY1B,EAAO0B,UAAUiB,IAAI,SAASlC,GAC7C,MAAQA,GAAQA,EAAKO,MAAQhB,EAAOS,KAAKO,IAAOhB,EAAOS,KAAOA,IAItE,QAASmC,KACL,GAAI/B,IACAC,MAAOd,EAAOc,MACd+B,SACIC,GAAI9C,EAAOS,KAAKO,IAChB+B,KAAM/C,EAAOS,KAAKsC,KAClBC,WAAYhD,EAAOS,KAAKuC,WACxBC,QAASjD,EAAOS,KAAKwC,QACrBC,SAAUlD,EAAOS,KAAKyC,SACtBC,UAAWnD,EAAOS,KAAK0C,WAI/B,IAAItC,EAAKgC,QAAQM,UAAW,CACxB,GAAIC,GAAsB/C,EAAQgD,OAAOxC,EAAKgC,QAAQM,UACtDtC,GAAKgC,QAAQM,UAAYG,mBAAmBF,GAGhDvD,EAAS0D,cAAc1C,EAAM,SAASK,GAC9BA,EAAOC,QACPqB,EAAUgB,QAAQ,wBAClBd,IACAnC,EAAoB6B,IAAI,YAAapC,EAAO0B,UAAU,KAEtDc,EAAUlB,MAAM,wBAwB5B,QAASmC,GAAkBC,EAAQC,GAC/B,GAAIC,EACW,YAAXF,GAAuBC,GACvB3D,EAAO6D,OAAO7C,IAAM2C,EACpB3D,EAAOY,YAAYkD,QAAQ9D,EAAO6D,SAChB,WAAXH,GAAuBC,GAC9BC,EAAYnB,EAAEsB,UAAU/D,EAAOY,aAAcI,IAAK2C,IAChC,KAAdC,GACA5D,EAAOY,YAAYoD,OAAOJ,EAAW,KAGzCA,EAAYnB,EAAEsB,UAAU/D,EAAOY,aAAcI,IAAK2C,IAChC,KAAdC,IACA5D,EAAOY,YAAY+C,GAAY3D,EAAO6D,SAKlD,QAASI,KACL,GAAIvD,GAAWT,EAAGU,QACdE,GACIC,MAAOd,EAAOc,MACdC,UAAWf,EAAOS,KAAKO,IACvB6C,OAAQ7D,EAAO6D,OAgBvB,OAbA/D,GAAQmE,UAAUpD,EAAM,SAASK,GAC7B,GAAI2C,GAAS,IAET3C,GAAOC,QAAUD,EAAOE,KAAKD,QAC7BqB,EAAUgB,QAAQ,uBAClBK,EAAS3C,EAAOE,MAEhBoB,EAAUlB,MAAM,qBAGpBZ,EAASa,QAAQsC,KAGdnD,EAASc,QAGpB,QAAS0C,KACLlE,EAAO6D,OAAOM,KAAOnE,EAAO6D,OAAOM,KAAKC,aACxC,IAAI1D,GAAcT,EAAGU,QACjBkD,EAAc,KACdhD,GACIC,MAAOd,EAAOc,MACdC,UAAWf,EAAOS,KAAKO,IACvB6C,OAAQ7D,EAAO6D,OAcvB,OAXA/D,GAAQoE,aAAarD,EAAM,SAASK,GAC5BA,EAAOC,QAAUD,EAAOE,KAAKD,QAC7BqB,EAAUgB,QAAQ,0BAClBK,EAAS3C,EAAOE,MAEhBoB,EAAUlB,MAAM,wBAGpBZ,EAASa,QAAQsC,KAGdnD,EAASc,QAqBpB,QAAS6C,KACL,GAAI3D,GAAcT,EAAGU,QACjBE,GACIC,MAAOd,EAAOc,MACdgC,GAAI9C,EAAO6D,OAAO7C,IAY1B,OATAlB,GAAQuE,aAAaxD,EAAM,SAASK,GAC5BA,EAAOC,OACPqB,EAAUgB,QAAQ,0BAElBhB,EAAUlB,MAAM,wBAEpBZ,EAASa,QAAQvB,EAAO6D,OAAO7C,OAG5BN,EAASc,QAvNpB,GAFAxB,EAAOc,MAAQP,EAAoBsB,IAAI,mBACvC7B,EAAOS,KAAOF,EAAoBsB,IAAI,aAClC7B,EAAOS,KAAK0C,UAAW,CACvB,GAAIC,GAAsBkB,mBAAmBtE,EAAOS,KAAK0C,UACzDnD,GAAOS,KAAK0C,UAAY9C,EAAQkE,OAAOnB,GAE3CpD,EAAO6D,OAAS,KAChB7D,EAAOwE,gBAAiB,EA4CxB/C,IACCS,KAAK,SAASR,GACX1B,EAAO0B,UAAYA,EAAYA,EAAUY,eAE5CJ,KAAK,WACF,MAAO1B,OAEV0B,KAAK,SAAStB,GACXZ,EAAOY,YAAcA,EAAcA,EAAY0B,eAuCnDtC,EAAOyE,OAAS,WACZvE,EAAUmC,KAAK,iBAGnBrC,EAAO0E,KAAO,WACV9B,KAGJ5C,EAAOiC,eAAiB,SAASxB,GAC7BT,EAAOwE,gBAAiB,EACxBxE,EAAOS,KAAOA,EAEdD,IACC0B,KAAK,SAAStB,GACXZ,EAAOY,YAAcA,EAAcA,EAAY0B,gBAuEvDtC,EAAO2E,WAAa,WACZ3E,EAAO6D,QAAU7D,EAAO6D,OAAO7C,IAC/BkD,IACChC,KAAK,SAAShB,GACPA,GACAuC,EAAkB,SAAU,QAIpCQ,IACC/B,KAAK,SAAShB,GACPA,GACAuC,EAAkB,SAAUvC,EAAO4B,OAyBnD9C,EAAOqE,aAAe,WAClBA,IACCnC,KAAK,SAASyB,GACX3D,EAAO6D,OAAS,KAChBJ,EAAkB,SAAUE,MAIpC3D,EAAO4E,mBAAqB,WACxB5E,EAAOwE,gBAAiB,GAG5BxE,EAAO6E,kBAAoB,WACvB7E,EAAOwE,gBAAiB,EACxBxE,EAAO6D,WAGX7D,EAAO8E,aAAe,WAClB9E,EAAOwE,gBAAiB,GAG5BxE,EAAO+E,iBAAmB,SAASlB,GAC/B7D,EAAOwE,gBAAiB,EACxBxE,EAAO6D,OAASA,GAGpB7D,EAAO8B,cAAgB,SAASC,GAC5B3B,EAAW2B,GAAOC,aAS1BtC,QAAQC,OAAO,cACdC,WAAW,uBAAA,WAAA,aAAA,SAAA,KAAA,YAAA,OAAA,aAAA,UAAA,YAAA,aAAA,sBAAuB,SAAUC,EAAUE,EAAYC,EAAQC,EAAIC,EAAWC,EAAMC,EAAYC,EAASmC,EAAWwC,EAAYzE,GAQxI,QAAS0E,KACL,GAAIpE,IACAC,MAAOd,EAAOc,MACd+B,QAAS7C,EAAOS,KAGpB,IAAIT,EAAOS,KAAK0C,UAAW,CACvB,GAAIC,GAAsB/C,EAAQgD,OAAOrD,EAAOS,KAAK0C,UACrDtC,GAAKgC,QAAQM,UAAYG,mBAAmBF,GAGhDvD,EAASqF,cAAcrE,EAAM,SAASK,GAC9BA,EAAOC,QAAUD,EAAOE,KAAKD,QAC7BqB,EAAUgB,QAAQ,wBAClBxD,EAAOS,KAAKO,IAAME,EAAOE,KAAK0B,GAC9BvC,EAAoB6B,IAAI,YAAapC,EAAOS,MAC5CP,EAAUmC,KAAK,sBAEfG,EAAUlB,MAAM,wBAa5B,QAASG,KACL,GAAIf,GAAcT,EAAGU,QACjBe,EAAc,KACdb,GACIC,MAAOd,EAAOc,MAatB,OAVAjB,GAAS8B,YAAYd,EAAM,SAASK,GAC5BA,EAAOC,OACPO,EAAYR,EAAOE,KAAKQ,YAExBzB,EAAKmB,MAAM,wBAAyBJ,GAGxCR,EAASa,QAAQG,KAGdhB,EAASc,QAvDpBxB,EAAOc,MAAQP,EAAoBsB,IAAI,mBACvC7B,EAAOS,QAEFT,EAAOc,OACRZ,EAAUmC,KAAK,UA0BnBrC,EAAO0E,KAAO,WACVO,KAGJjF,EAAOyE,OAAS,WACZvE,EAAUmC,KAAK,iBAuBnBZ,IACCS,KAAK,SAASR,GACX1B,EAAO0B,UAAYA,EAAYA,EAAUY,eAG7CtC,EAAO8B,cAAgB,SAASC,GAC5B3B,EAAW2B,GAAOC,aAS1BtC,QAAQC,OAAO,cACdC,WAAW,iBAAA,QAAA,aAAA,SAAA,KAAA,YAAA,WAAA,YAAA,aAAA,sBAAiB,SAAUuF,EAAOpF,EAAYC,EAAQC,EAAIC,EAAWqC,EAAUC,EAAWwC,EAAYzE,GAChHP,EAAOoF,MACLC,WAAY,GACZC,cAAe,IAGjBtF,EAAOuF,aAAe,WACpB,GAAI1E,KACJA,GAAK2E,MAAQxF,EAAOoF,KAAKC,WACzBxE,EAAK4E,SAAWzF,EAAOoF,KAAKE,cAE5BH,EAAMI,aAAa1E,EAAM,SAASK,GAC5BA,EAAOC,QACTZ,EAAoB6B,IAAI,kBAAmBlB,EAAOE,KAAKN,OACvDZ,EAAUmC,KAAK,iBAEfG,EAAUlB,MAAM,mCAKtBtB,EAAO0F,qBAAuB,SAASC,GAClB,UAAfA,EAAMC,MACR5F,EAAOuF,mBAMb7F,QAAQC,OAAO,OAEX,YAAa,YAAa,aAAc,aAAc,SAAU,UAAW,WAC3E,SAAU,yBAA0B,eAAgB,YAAa,aAAa,YAC9E,8BAA8B,sBAAyB,sBAAsB,UAC7E,qBAAsB,eAAgB,YAAY,cAAc,SAAS,cAAc,oBACvF,QAAS,aAAc,aAAc,yBAAyB,sBAAuB,MAGrF,SAAU,MAAQ,aAAc,cAAe,mBAAoB,mBAUvED,QAAQC,OAAO,OACVkG,UAAU,iBAAkB,QAAS,KAAM,YAAa,WAAY,SAASC,EAAO7F,EAAIC,EAAW6F,GAChG,OACIC,SAAU,IACVC,YAAa,6DACbC,KAAM,SAASlG,GAOX,QAASmG,KACL,GACIC,GACAC,EAFAC,EAAWrG,EAAGU,OAgClB,OA7BAyF,IAAY,GAAKG,OAAQC,UAEzBV,GACIW,OAAQ,MACRC,IAAKC,IACNzE,KAAK,SAAyB0E,GAC7BP,GAAU,GAAKE,OAAQC,SACvB,IAAItD,IAAYmD,EAAUD,GAAa,IACnCS,EAA4B,EAAfC,EACbC,GAAgBF,EAAa3D,GAAU8D,QAAQ,GAC/CC,GAAiBF,EAAe,MAAMC,QAAQ,GAC9CE,GAAiBD,EAAgB,MAAMD,QAAQ,EAEnDjB,GAAS,WACwB,IAAzB/F,EAAOkH,eACPlH,EAAOmH,iBAAmBC,OAAOF,GACjClH,EAAOkH,cAA0C,EAA1BlH,EAAOmH,mBAE9BD,GAAiBlH,EAAOmH,iBAAmBC,OAAOF,IAAkB,EACpElH,EAAOmH,iBAAmBC,OAAOF,EAAcF,QAAQ,IACvDhH,EAAOkH,cAA0C,EAA1BlH,EAAOmH,kBAGlCb,EAAS/E,WACV,KACJ,SAAuBqF,GACtBN,EAAS/E,QAAQ,QAGd+E,EAAS9E,QAtCpB,GAAImF,GAAWzG,EAAUmH,WAAa,MAAQnH,EAAUoH,OAAS,IAAMpH,EAAUqH,OAAS,4BACtFT,EAAe,MAEfU,IAsCJxH,GAAOyH,4BAA8B,WACjCzH,EAAOmH,iBAAmB,EAC1BnH,EAAOkH,cAAgB,CAEvB,KAAK,GAAIQ,GAAI,EAAO,IAAJA,EAASA,IACrBF,EAAwBG,KAAKxB,EAGjCqB,GAAwBI,OAAO,SAASC,EAAeC,GACnD,MAAOD,GAAc3F,KAAK,WACtB,MAAO4F,QAEZ7H,EAAGsB,YAaVvB,EAAOyH,mCAKvB/H,QAAQC,OAAO,OAAO,SAAS,YAG/BD,QAAQC,OAAO,OAAOoI,QAAQ,WAAA,OAAW,SAASC,GAE9C,OAEI/D,UAAW,SAASpD,EAAMoH,GAEtB,GAAI5F,GAAO,UACP6F,GACApH,MAAOD,EAAKC,MACZC,UAAWF,EAAKE,UAChB8C,OAAQnE,QAAQyI,OAAOtH,EAAKgD,QAEhCmE,GAAKI,YAAY/F,EAAM6F,EAAOD,IAElC/D,aAAc,SAASrD,EAAMoH,GAEzB,GAAI5F,GAAO,UACP6F,GACApH,MAAOD,EAAKC,MACZC,UAAWF,EAAKE,UAChB8C,OAAQnE,QAAQyI,OAAOtH,EAAKgD,QAEhCmE,GAAKK,WAAWhG,EAAM6F,EAAOD,IAEjC5D,aAAc,SAASxD,EAAMoH,GAEzB,GAAI5F,GAAO,UACP6F,GACApH,MAAOD,EAAKC,MACZgC,GAAIjC,EAAKiC,GAEbkF,GAAKM,cAAcjG,EAAM6F,EAAOD,IAEpChH,WAAY,SAASJ,EAAMoH,GAEvB,GAAI5F,GAAO,UACP6F,GACApH,MAAOD,EAAKC,MACZC,UAAWF,EAAKE,UAEpBiH,GAAKO,WAAWlG,EAAM6F,EAAOD,IAEjCO,MAAO,SAAS3H,EAAMoH,GAElB,GAAI5F,GAAO,gBACP6F,GACAnH,UAAWF,EAAKE,UAChByE,MAAO3E,EAAK2E,MACZC,SAAU5E,EAAK4E,SAEnBuC,GAAKI,YAAY/F,EAAM6F,EAAOD,IAElCQ,aAAc,SAAS5H,EAAMoH,GAEzB,GAAI5F,GAAO,iBACP6F,GACAQ,QAAS7H,EAAK6H,QACdC,SAAU9H,EAAK8H,SAEnBX,GAAKI,YAAY/F,EAAM6F,EAAOD,QAK1CvI,QAAQC,OAAO,OAAOoI,QAAQ,YAAA,OAAY,SAASC,GAE/C,OACI9C,cAAe,SAASrE,EAAMoH,GAE1B,GAAI5F,GAAO,WACP6F,GACApH,MAAOD,EAAKC,MACZ+B,QAASnD,QAAQyI,OAAOtH,EAAKgC,SAEjCmF,GAAKI,YAAY/F,EAAM6F,EAAOD,IAElC1E,cAAe,SAAS1C,EAAMoH,GAE1B,GAAI5F,GAAO,WACP6F,GACApH,MAAOD,EAAKC,MACZ+B,QAASnD,QAAQyI,OAAOtH,EAAKgC,SAEjCmF,GAAKK,WAAWhG,EAAM6F,EAAOD,IAEjCW,WAAY,SAAS/H,EAAMoH,GAEvB,GAAI5F,GAAO,eACP6F,GACApH,MAAOD,EAAKC,MACZgC,GAAIjC,EAAKE,UAEbiH,GAAKI,YAAY/F,EAAM6F,EAAOD,IAElCtG,YAAa,SAASd,EAAMoH,GAExB,GAAI5F,GAAO,YACP6F,GACApH,MAAOD,EAAKC,MAEhBkH,GAAKO,WAAWlG,EAAM6F,EAAOD,IAEjCY,WAAY,SAAShI,EAAMoH,GAEvB,GAAI5F,GAAO,YACP6F,GACApH,MAAOD,EAAKC,MACZgC,GAAIjC,EAAKE,UAEbiH,GAAKO,WAAWlG,EAAM6F,EAAOD,IAEjCa,iBAAkB,SAASjI,EAAMoH,GAE7B,GAAI5F,GAAO,kBACP6F,GACApH,MAAOD,EAAKC,MACZiI,OAAQlI,EAAKkI,OAEjBf,GAAKK,WAAWhG,EAAM6F,EAAOD,IAEjCe,iBAAkB,SAASnI,EAAMoH,GAE7B,GAAI5F,GAAO,kBACP6F,GACApH,MAAOD,EAAKC,MAEhBkH,GAAKO,WAAWlG,EAAM6F,EAAOD,IAEjCgB,WAAY,SAASpI,EAAMoH,GAEvB,GAAI5F,GAAO,kBACP6G,EAAOrI,EAAKqI,IAChBlB,GAAKmB,cAAc9G,EAAM6G,EAAMjB,QAK3CvI,QAAQC,OAAO,OAAOoI,QAAQ,SAAA,OAAS,SAASC,GAE5C,OACIzC,aAAc,SAAS1E,EAAMoH,GAEzB,GAAI5F,GAAO,cACP6F,GACA1C,MAAO3E,EAAK2E,MACZC,SAAU5E,EAAK4E,SAEnBuC,GAAKI,YAAY/F,EAAM6F,EAAOD,QAK1CvI,QAAQC,OAAO,OAAOoI,QAAQ,WAAA,OAAA,YAAW,SAAS5H,EAAMiJ,GAEpD,IACI,GAAIC,GAAK,GAAIC,WAAUF,EACvB,OAAOC,GACT,MAAOE,GAEL,MADApJ,GAAKmB,MAAM,4BACJ,SAIf5B,QAAQC,OAAO,OAAOoI,QAAQ,QAAA,QAAA,SAAA,UAAA,OAAQ,SAASjC,EAAO0D,EAAQC,EAAStJ,GAEnE,GAAIuJ,GAAY,SAAStI,GACrB,GAAIuI,KAEJ,KAAI,GAAIC,KAAKxI,GACTuI,EAAIhC,KAAKrE,mBAAmBsG,GAAK,IAAMtG,mBAAmBlC,EAAKwI,IAGnE,OAAOD,GAAIE,KAAK,KAGpB,QACIzB,YAAa,SAAS/F,EAAM6F,EAAOD,GAE/B,GAAIvB,GAAM8C,EAASnH,EACfyH,GACArD,OAAQ,OACRC,IAAKA,EACLqD,SAEIC,eAAgB,oDAEpBC,iBAAkBP,EAClBQ,QAAS,IACT9I,KAAM8G,EAEVuB,GAAQU,QACRhK,EAAKU,KAAK,iBAAmBiJ,EAAI1I,MACjC0E,EAAMgE,GAAK5H,KAAK,SAASd,GAED,MAAhBA,EAAKD,SAELsI,EAAQW,OAWJnC,EATA,iBADO7G,GAAKA,KAAK,QACHA,EAAKA,KAAKF,QAWpBC,QAAQ,EACRC,KAAMA,EAAKA,OARXD,QAAQ,MAYrB,SAASG,GAERmI,EAAQW,OACRjK,EAAKmB,MAAMA,GACX2G,GAEI9G,QAAQ,OAIpBoH,WAAY,SAASlG,EAAM6F,EAAOD,GAE9B,GAAIvB,GAAM8C,EAASnH,EACfyH,GACArD,OAAQ,MACRC,IAAKA,EACLqD,SAEIC,eAAgB,oDAEpBC,iBAAkBP,EAClBW,OAAQnC,EAEZuB,GAAQU,QACRhK,EAAKU,KAAK,gBAAkBiJ,EAAIO,QAChCvE,EAAMgE,GAAK5H,KAAK,SAASd,GAErBqI,EAAQW,OACY,MAAhBhJ,EAAKD,QAYD8G,EATA,iBADO7G,GAAKA,KAAK,QACHA,EAAKA,KAAKF,QAWpBC,QAAQ,EACRC,KAAMA,EAAKA,OARXD,QAAQ,KAYrB,SAASG,GAERmI,EAAQW,OACRjK,EAAKmB,MAAMA,GACX2G,GAEI9G,QAAQ,OAIpBkH,WAAY,SAAShG,EAAM6F,EAAOD,GAE9B,GAAIvB,GAAM8C,EAASnH,EACfyH,GACArD,OAAQ,MACRC,IAAKA,EACLqD,SAEIC,eAAgB,oDAEpBC,iBAAkBP,EAClBtI,KAAM8G,EAEV/H,GAAKU,KAAK,gBAAkBiJ,EAAIO,QAChCZ,EAAQU,QACRrE,EAAMgE,GAAK5H,KAAK,SAASd,GAErBqI,EAAQW,OACY,MAAhBhJ,EAAKD,QAYD8G,EATA,iBADO7G,GAAKA,KAAK,QACHA,EAAKA,KAAKF,QAWpBC,QAAQ,EACRC,KAAMA,EAAKA,OARXD,QAAQ,KAYrB,SAASG,GAERmI,EAAQW,OACRjK,EAAKmB,MAAMA,GACX2G,GAEI9G,QAAQ,OAIpBmH,cAAe,SAASjG,EAAM6F,EAAOD,GAEjC,GAAIvB,GAAM8C,EAASnH,EACfyH,GACArD,OAAQ,SACRC,IAAKA,EACLqD,SAEIC,eAAgB,oDAEpBC,iBAAkBP,EAClBtI,KAAM8G,EAEV/H,GAAKU,KAAK,mBAAqBiJ,EAAI1I,MACnCqI,EAAQU,QACRrE,EAAMgE,GAAK5H,KAAK,SAASd,GAED,MAAhBA,EAAKD,SAELsI,EAAQW,OAWJnC,EATA,iBADO7G,GAAKA,KAAK,QACHA,EAAKA,KAAKF,QAWpBC,QAAQ,EACRC,KAAMA,EAAKA,OARXD,QAAQ,MAYrB,SAASG,GAERmI,EAAQW,OACRjK,EAAKmB,MAAMA,GACX2G,GAEI9G,QAAQ,OAIpBgI,cAAe,SAAS9G,EAAM6G,EAAMjB,GAEhC,GAAIvB,GAAM8C,EAASnH,EACfiI,EAAM,GAAIC,gBACVC,EAAK,GAAIC,SACbH,GAAII,KAAK,OAAQhE,GAAK,GACtB+C,EAAQU,QACRhK,EAAKU,KAAK,mBAAqBwB,GAC/BiI,EAAIK,mBAAqB,WAEE,IAAnBL,EAAIM,YAAmC,MAAfN,EAAInJ,SAE5BsI,EAAQW,OACRnC,GAEI9G,QAAQ,EACRC,KAAM1B,QAAQmL,SAASP,EAAIQ,kBAKvCN,EAAGO,OAAO,OAAQ7B,GAClBoB,EAAIU,KAAKR,QAMrB9K,QAAQC,OAAO,kBAAkB,MAAM,SAAS,SAAS,aAAa,qBAAqB,sBAAsB,SAC9E,sBAAsB,UAAU,wBAEnED,QAAQC,OAAO,kBAAkBC,WAAW,0BAAA,SAAA,aAAA,YAAA,eAAA,IAAA,sBAAA,OAAA,YAAA,OAAA,UAAA,UAAA,iBAAA,aAAA,YAAA,aAAA,UAAA,WAAA,UAAA,qBAAA,SAAA,SAAA,cAAA,WAA0B,SAASI,EAAQD,EAAYG,EAAW+K,EAAcxI,EACxHlC,EAAqBJ,EAAM+K,EAAWC,EAAMC,EAASC,EAASC,EAAgBC,EAAYC,EAC1FpL,EAAYC,EAAS0F,EAAU0F,EAASC,EAAoBC,EAAQC,EAAQC,EAAYhM,GAgBxF,QAASiM,GAAWhJ,EAAGiJ,GAEnBC,KAAKlJ,GAAKA,EACVkJ,KAAKC,OAAQ,EACbD,KAAKD,QAAUA,EACfC,KAAKE,SAAU,EACfF,KAAKG,kBAAoB,KACzBH,KAAKI,YAAc,KACnBJ,KAAKK,SAAWC,EAChBN,KAAKO,eAAiB,KACtBP,KAAKQ,gBAAkB,KACvBR,KAAKS,yBACLT,KAAKU,kBAAoB,KACzBV,KAAKW,YAAc,KACnBX,KAAKY,SAAWC,EAChBb,KAAKc,eAAiB,KACtBd,KAAKe,yBACLf,KAAKgB,UAAY,KACjBhB,KAAKiB,aAAe,KACpBjB,KAAKkB,uBAAwB,EAGjC,QAASC,KACLnN,EAAOoN,OAAQ,EACfpN,EAAOqN,OAAQ,EACfrN,EAAOsN,QAAS,EAChBtN,EAAOuN,YAAa,EACpBvN,EAAOwN,iBAAkB,EACzBxN,EAAOyN,MAAQhC,EAAQiC,KAAK,0BAE5B1N,EAAO2N,OAAS,0BAChB3N,EAAO4N,KAAO,GACd5N,EAAO6N,eAAiB,EAExB7N,EAAO6C,QAAUtC,EAAoBsB,IAAI,WACzC7B,EAAO8N,UAAYvN,EAAoBsB,IAAI,UAC3C7B,EAAO+N,eAAiBxN,EAAoBsB,IAAI,cAChD7B,EAAOqB,cACPrB,EAAOgO,cACPhO,EAAOiO,cACP,IAAIC,GAAQ,CACZzL,GAAE0L,KAAKnO,EAAO+N,eAAe,SAAShC,GAClC/L,EAAOqB,WAAWsG,KAAK,GAAImE,GAAWC,EAAQ/K,IAAI+K,IAClD/L,EAAOgO,WAAWrG,MACdyG,WAAW,EACXC,QAAS,eAAiBH,EAC1BI,MAAOJ,EACPrK,OAAO,OAEXqK,MAEJlO,EAAOuO,GAAK9L,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC3C,MAAOA,GAAE3L,IAAM9C,EAAO8N,UAAU9M,MAEpChB,EAAOuO,GAAGvB,UAAY0B,SAASC,eAAe,eAC9C3O,EAAO4O,UAAYnM,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAClD,MAAyB,aAAlBA,EAAE1C,QAAQ5H,OAErBnE,EAAO4O,UAAU3B,aAAejN,EAAOgO,WAAW,GAClDhO,EAAO6O,WAAapM,EAAEqM,OAAO9O,EAAOqB,WAAY,SAASoN,GACrD,MAAyB,aAAlBA,EAAE1C,QAAQ5H,OAwEzB,QAAS4K,GAAYC,GACjBA,EAAQrL,SAAW3D,EAAOuO,GAAGzL,GAC7BkM,EAAQjO,UAAYf,EAAO6C,QAAQ7B,GACnC,IAAIiO,GAAcC,KAAKC,UAAUH,EACjC7O,GAAKU,KAAK,oBAAsBoO,EAChC,KACI7D,EAAQJ,KAAKiE,GACf,MAAO1F,GACLpJ,EAAKU,KAAK,2BACVwK,EAAQ+D,SAASC,UAIzB,QAASC,GAAaN,GACM,YAApBA,EAAQpI,UACR2I,IACAC,EAAkBR,EAAQS,aAE1BvP,EAAUmC,KAAK,KAIvB,QAASkN,KACL,GAAIG,IACAC,WAAYC,YACZC,eAAgBC,EAChBvE,WAAWA,EACXwE,yBAA0BC,EAE9BhQ,GAAOuO,GAAGpC,kBAAoB8D,aAAaC,WAAWC,mBAAmBT,EAAS,SAASpO,GACvF,MAAIA,IACAoK,EAAmB0E,oBACnBjQ,GAAKmB,MAAMA,QAGf0K,MAAKqE,cAAcC,KAEvB5E,EAAmB6E,iBACnBvQ,EAAOuO,GAAGhC,eAAiBxG,EAAS,WAC5B/F,EAAOuO,GAAGlC,UAAYmE,IACtBxQ,EAAOuO,GAAGlC,SAAWmE,EACrBC,MAENC,IAGN,QAASZ,GAAsBa,GAC3B3Q,EAAOuO,GAAG9B,sBAAsB9E,KAAKgJ,GAGzC,QAASL,GAAUhP,EAAOsP,GACtB,MAAItP,IACAoK,EAAmB0E,oBACnBjQ,GAAKU,KAAKS,SAGdtB,EAAOuO,GAAGnC,YAAcwE,GAG5B,QAASC,GAAgB7B,GACrBtD,EAAmB0E,gBACK,YAApBpB,EAAQpI,UACRzG,EAAKU,KAAK,wCACVb,EAAO8Q,eAEP9Q,EAAOuO,GAAGpC,kBAAkB4E,cAAc/B,EAAQgC,WAClDvO,EAAE0L,KAAKa,EAAQiC,cAAc,SAASN,GAClC3Q,EAAOuO,GAAGpC,kBAAkB+E,gBAAgBP,KAEhD5B,GACIjM,GAAI,iBAER9C,EAAOuO,GAAGlC,SAAW8E,EACrBnR,EAAOyN,MAAMrD,QAIrB,QAAS4F,KACLjK,EAAStB,OAAOzE,EAAOuO,GAAGhC,gBACtBvM,EAAOuO,GAAGlC,UAAYmE,IACtBxQ,EAAOuO,GAAGlC,SAAWmE,EACrBC,KAIR,QAASA,KACL,IAAKzQ,EAAOuO,GAAGnC,cAAgBpM,EAAOuO,GAAG9B,sBAAsB2E,OAG3D,MAFAjR,GAAKU,KAAK,sCACVb,GAAO8Q,YAGX,IAAI9B,IACIlM,GAAI,UACJuO,SAAUrR,EAAOuO,GAAGnC,YACpB6E,cAAejR,EAAOuO,GAAG9B,sBAEjCsC,GAAYC,GACZhP,EAAOuO,GAAGnC,YAAc,KACxBpM,EAAOuO,GAAG9B,yBACVzM,EAAOuO,GAAG/B,gBAAkBzG,EAAS,WAC7B/F,EAAOuO,GAAGlC,UAAY8E,IACtBhR,EAAKU,KAAK,qCACVb,EAAO8Q,eAEbQ,IAaN,QAASC,GAAY1N,GAEjB,GADAA,EAAOqJ,uBAAyB,EAC5BrJ,EAAOoJ,aAAc,CACrBpJ,EAAO+I,SAAWC,EACdhJ,EAAOf,IAAK9C,EAAO4O,UAAU9L,KACzBe,EAAOoJ,aAAamB,WACpBpO,EAAO6N,iBAEXhK,EAAOoJ,aAAamB,WAAY,EAChCvK,EAAOoJ,aAAapJ,OAAS,KAC7BA,EAAOoJ,aAAe,MAEtBpJ,EAAOiJ,gBACP/G,EAAStB,OAAOZ,EAAOiJ,eAC3B,KACQjJ,EAAO6I,mBACP7I,EAAO6I,kBAAkB,eAAkB8E,QACjD,MAAOC,GACLtR,EAAKmB,MAAMmQ,KAKvB,QAASC,GAAU7N,GACf,GAAK7D,EAAOuO,GAAGtC,MAAf,CAGA,GAAI0F,GAAO,IAQX,IANIA,EADA9N,EAAOoJ,aACApJ,EAAOoJ,aAEPxK,EAAE+L,KAAKxO,EAAOgO,WAAY,SAAS4D,GACtC,OAAQA,EAAExD,WAAcwD,EAAEtD,MAAQ,IAG1C,CACIzK,EAAOf,KAAO9C,EAAO4O,UAAU9L,IAC/B9C,EAAO6N,iBAEXhK,EAAOoJ,aAAe0E,EACtBA,EAAK9N,OAASA,EACd8N,EAAKvD,WAAY,EACjBvK,EAAO+I,SAAWiF,EAClB,IAAIC,GAAepD,SAASC,eAAegD,EAAKtD,SAC5CqB,GACAqC,YAAaD,EACbjC,eAAgBmC,EAAwBC,MAAMpO,OAAOA,IACrD0H,WAAYA,EACZwE,yBAA0BmC,EAAoBD,MAAMpO,OAAOA,IAE/DA,GAAOiJ,eAAiB/G,EAAS,SAAS0I,GAClCA,EAAE7B,UAAYuF,KACdC,EAAkB3D,GAClBA,EAAE7B,SAAWuF,KAEnBzB,IAAe,EAAK7M,GAEtBA,EAAO6I,kBAAoBuD,aAAaC,WAAWmC,mBAAmB3C,EAAS,SAASpO,GACpF,MAAIA,OACAnB,GAAKmB,MAAMA,OAGf0K,MAAKqE,cAAciC,EAAYL,MAC3BpO,OAAQA,SAKpB,QAASmO,GAAwBrB,GAC7B3E,KAAKnI,OAAOkJ,sBAAsBpF,KAAKgJ,GAG3C,QAAS2B,GAAYhR,EAAOsP,GACxB,MAAItP,OACAnB,GAAKmB,MAAMA,QAGf0K,KAAKnI,OAAO0O,YAAc3B,GAG9B,QAAS4B,GAAkBxD,GACvB,GAAInL,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMkM,EAAQyD,OAEH,aAApBzD,EAAQpI,UACR/C,EAAO+I,SAAWC,EAClBlB,EAAOrK,MAAM,0CAGbuC,EAAO6I,kBAAkBqE,cAAc/B,EAAQgC,WAC3CnN,EAAOf,IAAM9C,EAAOuO,GAAGzL,KACvBe,EAAO6I,kBAAkBqF,YAAYW,OAAQ,GAE7C7O,EAAOoJ,eACPpJ,EAAO+I,SAAW+F,GAClBlQ,EAAE0L,KAAKa,EAAQiC,cAAc,SAASN,GAClC9M,EAAO6I,kBAAkBwE,gBAAgBP,KAE7C5B,GACIjM,GAAI,iBACJ2P,MAAMzD,EAAQyD,SAGtBG,KAIR,QAASV,KACLnM,EAAStB,OAAOuH,KAAKnI,OAAOiJ,gBACxBd,KAAKnI,OAAO+I,UAAYuF,KACxBC,EAAkBpG,KAAKnI,QACvBmI,KAAKnI,OAAO+I,SAAWuF,IAK/B,QAASC,GAAkBvO,GACvB,IAAKA,EAAO0O,cAAgB1O,EAAOkJ,sBAAsBqE,OAErD,WADAzF,GAAOrK,MAAM,eAGjB,IAAI0N,IACIlM,GAAI,YACJ2P,MAAO5O,EAAOf,GACduO,SAAUxN,EAAO0O,YACjBtB,cAAcpN,EAAOkJ,sBAE7BgC,GAAYC,GACZnL,EAAO0O,YAAc,KACrB1O,EAAOkJ,yBAGX,QAAS8F,GAAc7D,GACnB,GAAItI,GAAM,GAEV,IAAI1G,EAAO6C,QAAQM,UAAW,CAC1B,GAAIC,GAAsBkB,mBAAmBtE,EAAO6C,QAAQM,UAC5DuD,GAAMrG,EAAQkE,OAAOnB,GAGzBiI,EAAQ+D,SAAS0D,KAAOpM,EAG5B,QAASqM,GAAa/D,GAClBgE,EAAiBhE,EAAQiE,YAG7B,QAASL,KACL,GAAI/O,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAEvB,uBAETrJ,KACAA,EAAOqJ,uBAAyB,EAChCwE,EAAU7N,IAIlB,QAASmP,GAAiBC,GACtB,GAAIC,KACJzQ,GAAE0L,KAAKnO,EAAOqB,WAAY,SAAS8R,GAC/B,GAAIC,GAAS3Q,EAAE+L,KAAKyE,EAAY,SAASxE,GACrC,MAAO0E,GAAOrQ,IAAM2L,EAAEzN,KAEtBoS,IACAD,EAAOlH,MAAQmH,EAAOnH,MACtBkH,EAAOjH,QAAUkH,EAAOlH,QACxBiH,EAAOE,QAAS,EACZF,EAAOjH,QACHiH,EAAOlH,OACFkH,EAAOlG,eACRkG,EAAOjG,uBAAyB,GAChCiG,EAAOlG,cAAgBkG,EAAOvG,UAAUC,IACxCsG,EAAOjG,uBAAyB,IAEhCiG,EAAOlG,cACPiG,EAAUvL,KAAKwL,GAGvBD,EAAUvL,KAAKwL,KAGfA,EAAOjH,SACPgH,EAAUvL,KAAKwL,GACnBA,EAAOjH,SAAU,EACjBiH,EAAOlH,OAAQ,EACfkH,EAAOE,QAAS,KAGxB5Q,EAAE0L,KAAK+E,EAAW,SAASrP,GACvB0N,EAAY1N,KAEhB+O,IA4GJ,QAASU,GAAYtE,GACjBhP,EAAOiO,YAAYtG,MACf4L,KAAQvE,EAAQuE,KAChBC,KAAQxE,EAAQwE,OAmBxB,QAAShE,GAAkBC,GACvBhN,EAAE0L,KAAKsB,EAAW,SAASgE,GACvBC,EAAkBD,EAAI9N,MAAM8N,EAAIE,QAChCC,MAIR,QAASC,GAAuBlO,EAAMgO,GAClCD,EAAkB/N,EAAMgO,GACxBC,IAGJ,QAASF,GAAkB/N,EAAMgO,GAClB,eAAPhO,GAEAkG,EACSiI,aAAa,oBACbpG,KAAKiG,GAEP,iBAAPhO,GACAkG,EAAYiI,aAAa,oBAAoBC,OAEtC,iBAAPpO,GACAkG,EAAYiI,aAAa,oBAAoBC,OAEtC,gBAAPpO,GACAkG,EAAYiI,aAAa,oBAAoBE,UAEtC,eAAPrO,GACAkG,EAAYiI,aAAa,oBAAoBG,SAKrD,QAASL,KACL5T,EAAOkU,SAAWrI,EAAYiI,aAAa,oBAAoBK,iBAC/DnU,EAAOoU,WAAavI,EAAYiI,aAAa,oBAAoBO,eA5mBrE,GAAI/H,GAAc,EACdgI,EAAiB,EACjB9D,EAAiB,EACjBW,EAAgB,EAGhBtE,EAAc,EACdgF,GAAiB,EACjBM,GAAiB,EACjBQ,GAAgB,EAEhBjC,GAAiB,IACjBY,GAAkB,GAkEtBtR,GAAOuU,QAAU,WACa,GAAtBnJ,EAAQR,YAERmE,GAAcjM,GAAI,SAClB9C,EAAOyN,MAAM+G,MAAO,EACpBxU,EAAOyN,MAAMgH,OACbzU,EAAOuO,GAAGlC,SAAWiI,GAErBjJ,EAAQ+D,SAASC,UAIzBrP,EAAO8Q,WAAa,WAEhB9Q,EAAOuO,GAAGlC,SAAWC,EACrBtM,EAAOyN,MAAMrD,MACb,KACQpK,EAAOuO,GAAGpC,mBACVnM,EAAOuO,GAAGpC,kBAAkB,eAAkBqF,QAClD/O,EAAE0L,KAAKnO,EAAOqB,WAAY,SAASwC,GAC3BA,EAAO+I,UAAYC,GACnB0E,EAAY1N,KAEpBkL,GACIjM,GAAI,UAEV,MAAO2O,GACLtR,EAAKmB,MAAMmQ,KAInBrG,EAAQsJ,UAAY,SAAS1F,GACzB,GAAI2F,GAAgBzF,KAAK0F,MAAM5F,EAAQ5N,KAEvC,QADAyT,QAAQhU,KAAK,qBAAuBmO,EAAQ5N,MACpCuT,EAAc7R,IAClB,IAAK,eACDwM,EAAaqF,EACb,MACJ,KAAK,MACD9B,GACA,MACJ,KAAK,eACDE,EAAa4B,EACb,MACJ,KAAK,SACDrH,GAAOqH,EACP,MACJ,KAAK,WACDG,GAASH,EACT,MACJ,KAAK,kBACD9D,EAAgB8D,EAChB,MACJ,KAAK,oBACDnC,EAAkBmC,EAClB,MACJ,KAAK,OACDrB,EAAYqB,EACZ,MACJ,KAAK,aACDd,EAAuBc,EAAchP,MAAMgP,EAAchB,OACzD,MACJ,SACIkB,QAAQvT,MAAM,uBAAwBqT,GAE9C3U,EAAO+U,UA8GX/U,EAAOgV,YAAc,SAASvC,GAC1B,GAAIwC,GAAYxS,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC/C,MAAOA,GAAE3L,IAAM2P,GAEfwC,GAAU/I,SAAW+I,EAAUhJ,QAC/BsF,EAAY0D,GACZvD,EAAUuD,KAqMlBjV,EAAOkV,MAAQ,WACX,GAAIxO,GAAM,GAEV,IAAI1G,EAAO6C,QAAQM,UAAW,CAC1B,GAAIC,GAAsBkB,mBAAmBtE,EAAO6C,QAAQM,UAC5DuD,GAAMrG,EAAQkE,OAAOnB,GAGzB2L,GACIjM,GAAI,UAGRuI,EAAQ+D,SAAS0D,KAAOpM,GAE5B1G,EAAOmV,UAAY,WACfpG,GACIjM,GAAI,SAGZ9C,EAAOoV,YAAc,WACjB,GAAIC,GAAcrV,EAAOuO,GAAGpC,kBAAkBmJ,gBAC9C,IAAID,EAAa,CACb,GAAIE,GAAaF,EAAYG,iBAAiB,EAC9CxV,GAAOoN,OAASpN,EAAOoN,MACvBmI,EAAWE,QAAUzV,EAAOoN,QAGpCpN,EAAO0V,YAAc,WACjB,GAAIL,GAAcrV,EAAOuO,GAAGpC,kBAAkBmJ,gBAC9C,IAAID,EAAa,CACb,GAAIM,GAAaN,EAAYO,iBAAiB,EAC9C5V,GAAOqN,OAASrN,EAAOqN,MACvBsI,EAAWF,QAAUzV,EAAOqN,QAGpCrN,EAAO6V,WAAa,WAChB7V,EAAOsN,QAAUtN,EAAOsN,OACxBtN,EAAOuN,YAAa,EAIhBwB,EAHC/O,EAAOsN,QAGKxK,GAAI,aAFJA,GAAI,YAKzB9C,EAAO8B,cAAgB,SAASC,GAC5B3B,EAAW2B,GAAOC,UAEtBhC,EAAO8V,gBAAkB,WACrB9V,EAAOwN,iBAAmBxN,EAAOwN,iBAErCxN,EAAO+V,aAAe,SAASpS,GAC3B,KAAI3D,EAAO6N,eAAiB,GAA5B,CAGA7N,EAAOuN,YAAa,CAEpB,IAAI1J,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMa,GAEnBE,GAAOyJ,QAAS,GAEXzJ,EAAOqI,SAAWrI,EAAOwP,QAC1BtE,GACIjM,GAAI,SACJkT,UAAanS,EAAOf,OAIhC9C,EAAOiW,cAAgB,SAAStE,GAC5B,GAAI9N,GAAS8N,EAAK9N,MACdA,KACA7D,EAAO6N,iBACPhK,EAAOyJ,QAAS,EAChByB,GACIjM,GAAI,UACJkT,UAAanS,EAAOf,MAIhC,IAAIwK,IAAS,SAAS0B,GAClB,GAAInL,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMkM,EAAQrL,UAE3BE,GAAOyJ,QAAS,GAEhBwH,GAAW,SAAS9F,GACpB,GAAInL,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMkM,EAAQrL,UAE3BE,GAAOyJ,QAAS,EAEpBtN,GAAOkW,KAAO,WACV,GAAIlH,IACAlM,GAAI,OACJ0Q,KAAMxT,EAAOmW,UAEjBpH,GAAYC,GACZhP,EAAOmW,UAAY,IAGvBnW,EAAOoW,gBAAkB,SAASC,GACX,UAAf1Q,MAAMC,MACN5F,EAAOkW,QAUflW,EAAOsW,QAAU,SAAS3E,GACtB,MAAOA,GAAKrD,MAAQ,GAGxBvO,EAAWwW,IAAI,oBAAqB,SAAS5Q,EAAOoO,EAAMyC,GACjDA,GACDpL,EAAQoG,UAGhBnG,EAAQoL,eAAiB,WACrBrL,EAAQoG,QACRtG,EAAUzG,OAAOiS,cAGrBvJ,IAyCAnN,EAAO2W,QAAU,WACb9K,EAAYiI,aAAa,oBAAoBC,OAC7CH,IACA7E,GAAajM,GAAG,aAAa6C,MAAM,gBAAgBgO,OAAO,QAG9D3T,EAAO4W,QAAU,WACb/K,EAAYiI,aAAa,oBAAoB+C,OAC7CjD,IACA7E,GAAajM,GAAG,aAAa6C,MAAM,gBAAgBgO,OAAO,QAG9D3T,EAAOgU,QAAU,WACbnI,EAAYiI,aAAa,oBAAoBE,UAC7CjF,GAAajM,GAAG,aAAa6C,MAAM,eAAegO,OAAO,OACzD3T,EAAO4N,KAAwB,KAAhB5N,EAAO4N,KAAe,GAAM5N,EAAO4N,KAAO,IAG7D5N,EAAOiU,OAAS,WACZpI,EAAYiI,aAAa,oBAAoBG,SAC7ClF,GAAajM,GAAG,aAAa6C,MAAM,cAAcgO,OAAO,OACxD3T,EAAO4N,MAAQ,IAKnB5N,EAAO8W,UAAY,SAAU5N,GACzB2L,QAAQkC,IAAI,OAAQ7N,GACfA,GAGLrJ,EAASoJ,YAAYC,KAAKA,GAAM,SAAShI,GACjCA,EAAOC,QAAUD,EAAOE,KAAKD,SAC7B0T,QAAQkC,IAAI,MAAO7V,EAAOE,KAAKsF,KAC9B1G,EAAO2N,OAASzM,EAAOE,KAAKsF,IAC5B1G,EAAO+U,SACPlJ,EACIiI,aAAa,oBACbpG,KAAKxM,EAAOE,KAAKsF,KACtBqI,GAAajM,GAAG,aAAa6C,MAAM,cAAcgO,OAAOzS,EAAOE,KAAKsF,aAepFhH,QAAQC,OAAO,cACVC,WAAW,0BAAA,aAAA,SAAA,UAAA,YAAA,OAAA,eAAA,YAAA,aAAA,sBAAA,UAA0B,SAAUG,EAAYC,EAAQF,EAASI,EAAWC,EAAM8K,EAAazI,EACnGwC,EAAYzE,EAAoBF,GACpCL,EAAOgX,iBAAmB,WAG1BhX,EAAOiX,aAAe,WAClBjS,EAAWkS,KACX,IAAIrW,IACA6H,QAASrI,EAAQkE,OAAO0G,EAAavC,SACrCC,SAAUsC,EAAatC,SAG3B7I,GAAQ2I,aAAa5H,EAAM,SAASK,GAC5BA,EAAOC,QAAUD,EAAOE,KAAKD,QAC7BZ,EAAoB6B,IAAI,UAAUlB,EAAOE,KAAKyB,SAC9CtC,EAAoB6B,IAAI,SAASlB,EAAOE,KAAKyC,QAC7CtD,EAAoB6B,IAAI,aAAalB,EAAOE,KAAKC,YAEvB,eAAtB4J,EAAakM,KACbjX,EAAUmC,KAAK,SAEfnC,EAAUmC,KAAK,eAGnBlC,EAAKmB,MAAMJ,GACXsB,EAAUlB,MAAM,yBAK5BtB,EAAOoX,qBAAuB,SAASzR,GAChB,UAAfA,EAAMC,MACN5F,EAAOiX,mBAcvBvX,QAAQC,OAAO,cACVC,WAAW,kBAAA,aAAA,SAAA,UAAA,YAAA,OAAA,YAAA,aAAA,sBAAkB,SAAUG,EAAYC,EAAQF,EAASI,EAAWC,EAAMqC,EAAWwC,EAAYzE,GACzGP,EAAOqX,aAAeF,KAAM,YAG/BnX,EAAOiX,aAAe,WACrBjS,EAAWkS,KACL,IAAIrW,IACAE,UAAWf,EAAOqX,YAAYtW,UAC9ByE,MAAOxF,EAAOqX,YAAY7R,MAC1BC,SAAUzF,EAAOqX,YAAY5R,SAGjC3F,GAAQ0I,MAAM3H,EAAM,SAASK,GACrBA,EAAOC,QAAUD,EAAOE,KAAKD,QAC7BZ,EAAoB6B,IAAI,UAAUlB,EAAOE,KAAKyB,SAC9CtC,EAAoB6B,IAAI,SAASlB,EAAOE,KAAKyC,QAC7CtD,EAAoB6B,IAAI,aAAalB,EAAOE,KAAKC,YAEjB,aAA5BrB,EAAOqX,YAAYF,KACnBjX,EAAUmC,KAAK,aAEfnC,EAAUmC,KAAK,WAGnBlC,EAAKmB,MAAMJ,GACXsB,EAAUlB,MAAM,wBAK5BtB,EAAOoX,qBAAuB,SAASzR,GAChB,UAAfA,EAAMC,MACN5F,EAAOiX,mBAOvBvX,QAAQC,OAAO,oBAAoB,MAAM,SAAS,SAAS,aAAa,qBAAqB,sBAAsB,SAChF,sBAAsB,UAAU,wBAEnED,QAAQC,OAAO,oBAAoBC,WAAW,kBAAA,SAAA,aAAA,YAAA,eAAA,IAAA,sBAAA,OAAA,YAAA,OAAA,UAAA,UAAA,iBAAA,aAAA,YAAA,aAAA,UAAA,WAAA,UAAA,qBAAA,SAAA,SAAkB,SAASI,EAAQD,EAAYG,EAAW+K,EAAcxI,EAClHlC,EAAqBJ,EAAM+K,EAAWC,EAAMC,EAASC,EAASC,EAAgBC,EAAYC,EAC1FpL,EAAWC,EAAQ0F,EAAS0F,EAAQC,EAAmBC,EAAOC,GAgB9D,QAASE,GAAWhJ,EAAGiJ,GAEnBC,KAAKlJ,GAAKA,EACVkJ,KAAKC,OAAQ,EACbD,KAAKD,QAAUA,EACfC,KAAKE,SAAU,EACfF,KAAKG,kBAAoB,KACzBH,KAAKI,YAAc,KACnBJ,KAAKK,SAAWC,EAChBN,KAAKO,eAAiB,KACtBP,KAAKQ,gBAAkB,KACvBR,KAAKS,yBACLT,KAAKU,kBAAoB,KACzBV,KAAKW,YAAc,KACnBX,KAAKY,SAAWC,EAChBb,KAAKc,eAAiB,KACtBd,KAAKe,yBACLf,KAAKgB,UAAY,KACjBhB,KAAKiB,aAAe,KACpBjB,KAAKkB,uBAAwB,EAGjC,QAASC,KACLnN,EAAOoN,OAAQ,EACfpN,EAAOqN,OAAQ,EACfrN,EAAOsN,QAAS,EAChBtN,EAAOuN,YAAa,EACpBvN,EAAOyN,MAAQhC,EAAQiC,KAAK,0BAE5B1N,EAAO6C,QAAUtC,EAAoBsB,IAAI,WACzC7B,EAAO8N,UAAYvN,EAAoBsB,IAAI,UAC3C7B,EAAO+N,eAAiBxN,EAAoBsB,IAAI,cAChD7B,EAAOqB,cACPrB,EAAOgO,cACPhO,EAAOiO,cACP,IAAIC,GAAQ,CACZzL,GAAE0L,KAAKnO,EAAO+N,eAAe,SAAShC,GAClC/L,EAAOqB,WAAWsG,KAAK,GAAImE,GAAWC,EAAQ/K,IAAI+K,IAClD/L,EAAOgO,WAAWrG,MACdyG,WAAW,EACXC,QAAS,eAAiBH,EAC1BI,MAAOJ,EACPrK,OAAO,KACPyT,MAAO,IAEXpJ,MAEJlO,EAAOuO,GAAK9L,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC3C,MAAOA,GAAE3L,IAAM9C,EAAO8N,UAAU9M,MAEpChB,EAAOuO,GAAGvB,UAAY0B,SAASC,eAAe,eAC9C3O,EAAO4O,UAAYnM,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAClD,MAAyB,aAAlBA,EAAE1C,QAAQ5H,OAErBnE,EAAO4O,UAAU3B,aAAejN,EAAOgO,WAAW,GAClDhO,EAAO6O,WAAapM,EAAEqM,OAAO9O,EAAOqB,WAAY,SAASoN,GACrD,MAAyB,aAAlBA,EAAE1C,QAAQ5H,OAkEzB,QAAS4K,GAAYC,GACjBA,EAAQrL,SAAW3D,EAAOuO,GAAGzL,GAC7BkM,EAAQjO,UAAYf,EAAO6C,QAAQ7B,GACnC,IAAIiO,GAAcC,KAAKC,UAAUH,EACjC7O,GAAKU,KAAK,oBAAsBoO,EAChC,KACI7D,EAAQJ,KAAKiE,GACf,MAAO1F,GACLpJ,EAAKU,KAAK,2BACVwK,EAAQ+D,SAASC,UAIzB,QAASC,GAAaN,GACM,YAApBA,EAAQpI,SACR2I,IAEArP,EAAUmC,KAAK,KAIvB,QAASkN,KACL,GAAIG,IACAC,WAAYC,YACZC,eAAgBC,EAChBvE,WAAWA,EACXwE,yBAA0BC,EAE9BhQ,GAAOuO,GAAGpC,kBAAoB8D,aAAaC,WAAWC,mBAAmBT,EAAS,SAASpO,GACvF,MAAIA,IACAoK,EAAmB0E,oBACnBjQ,GAAKmB,MAAMA,QAGf0K,MAAKqE,cAAcC,KAEvB5E,EAAmB6E,iBACnBvQ,EAAOuO,GAAGhC,eAAiBxG,EAAS,WAC5B/F,EAAOuO,GAAGlC,UAAYmE,IACtBxQ,EAAOuO,GAAGlC,SAAWmE,EACrBC,MAENC,GAGN,QAASZ,GAAsBa,GAC3B3Q,EAAOuO,GAAG9B,sBAAsB9E,KAAKgJ,GAGzC,QAASL,GAAUhP,EAAOsP,GACtB,MAAItP,IACAoK,EAAmB0E,oBACnBjQ,GAAKU,KAAKS,SAGdtB,EAAOuO,GAAGnC,YAAcwE,GAG5B,QAASC,GAAgB7B,GACrBtD,EAAmB0E,gBACK,YAApBpB,EAAQpI,UACRzG,EAAKU,KAAK,wCACVb,EAAO8Q,eAEP9Q,EAAOuO,GAAGpC,kBAAkB4E,cAAc/B,EAAQgC,WAClDvO,EAAE0L,KAAKa,EAAQiC,cAAc,SAASN,GAClC3Q,EAAOuO,GAAGpC,kBAAkB+E,gBAAgBP,KAEhD5B,GACIjM,GAAI,iBAER9C,EAAOuO,GAAGlC,SAAW8E,EACrBnR,EAAOyN,MAAMrD,QAIrB,QAAS4F,KACLjK,EAAStB,OAAOzE,EAAOuO,GAAGhC,gBACtBvM,EAAOuO,GAAGlC,UAAYmE,IACtBxQ,EAAOuO,GAAGlC,SAAWmE,EACrBC,KAIR,QAASA,KACL,IAAKzQ,EAAOuO,GAAGnC,cAAgBpM,EAAOuO,GAAG9B,sBAAsB2E,OAG3D,MAFAjR,GAAKU,KAAK,sCACVb,GAAO8Q,YAGX,IAAI9B,IACIlM,GAAI,UACJuO,SAAUrR,EAAOuO,GAAGnC,YACpB6E,cAAejR,EAAOuO,GAAG9B,sBAEjCsC,GAAYC,GACZhP,EAAOuO,GAAGnC,YAAc,KACxBpM,EAAOuO,GAAG9B,yBACVzM,EAAOuO,GAAG/B,gBAAkBzG,EAAS,WAC7B/F,EAAOuO,GAAGlC,UAAY8E,IACtBhR,EAAKU,KAAK,qCACVb,EAAO8Q,eAEbQ,IAGN,QAASC,GAAY1N,GAEjB,GADAA,EAAOqJ,uBAAyB,EAC5BrJ,EAAOoJ,aAAc,CACrBpJ,EAAO+I,SAAWC,EACdhJ,EAAOf,IAAK9C,EAAO4O,UAAU9L,KAC7Be,EAAOoJ,aAAamB,WAAY,EAChCvK,EAAOoJ,aAAapJ,OAAS,KAC7BA,EAAOoJ,aAAe,MAEtBpJ,EAAOiJ,gBACP/G,EAAStB,OAAOZ,EAAOiJ,eAC3B,KACQjJ,EAAO6I,mBACP7I,EAAO6I,kBAAkB,eAAkB8E,QACjD,MAAOC,GACLtR,EAAKmB,MAAMmQ,KAqBvB,QAASC,GAAU7N,GACf,GAAK7D,EAAOuO,GAAGtC,MAAf,CAGA,GAAI0F,GAAO,IAQX,IANIA,EADA9N,EAAOoJ,aACApJ,EAAOoJ,aAEPxK,EAAE+L,KAAKxO,EAAOgO,WAAY,SAAS4D,GACtC,OAAQA,EAAExD,WAAcwD,EAAEtD,MAAQ,IAG1C,CACAzK,EAAOoJ,aAAe0E,EACtBA,EAAK9N,OAASA,EACd8N,EAAKvD,WAAY,EACjBvK,EAAO+I,SAAWiF,EAClB7R,EAAOuX,eAAiBC,EAAkBxX,EAAOgO,YAAYoD,OAC7DqG,EAAc,EAAGzX,EAAOuX,eAAgBvX,EAAOgO,WAC/C,IAAI8D,GAAepD,SAASC,eAAegD,EAAKtD,SAC5CqB,GACAqC,YAAaD,EACbjC,eAAgBmC,EAAwBC,MAAMpO,OAAOA,IACrD0H,WAAYA,EACZwE,yBAA0BmC,EAAoBD,MAAMpO,OAAOA,IAE/DA,GAAOiJ,eAAiB/G,EAAS,SAAS0I,GAClCA,EAAE7B,UAAYuF,IACdC,EAAkB3D,GAClBA,EAAE7B,SAAWuF,IAEnBzB,GAAe,EAAK7M,GAEtBA,EAAO6I,kBAAoBuD,aAAaC,WAAWmC,mBAAmB3C,EAAS,SAASpO,GACpF,MAAIA,OACAnB,GAAKmB,MAAMA,OAGf0K,MAAKqE,cAAciC,EAAYL,MAC3BpO,OAAQA,SAKpB,QAAS4T,GAAcC,EAAaH,EAAgBI,GAChD,GAAIC,GAAOC,KAAKC,MAAMP,EAAiBG,EAE1B,KAATE,EACuB,IAAnBL,EACAvX,EAAO+X,UAAY,IACO,IAAnBR,IACPvX,EAAO+X,UAAYF,KAAKC,MAAM,IAC9BH,EAAUhV,IAAI,SAASgP,GACfA,EAAKvD,YACLuD,EAAK2F,MAAQO,KAAKC,MAAM,QAKpCH,EAAUhV,IAAI,SAASgP,GACfA,EAAKvD,YACLuD,EAAK2F,MAAQO,KAAKC,MAAM,IAAMJ,GAC9B1X,EAAO+X,UAAYpG,EAAK2F,SAMxC,QAASE,GAAkBnW,GACvB,GAAI2W,GAAmBvV,EAAEqM,OAAOzN,EAAY,SAASwC,GACjD,MAAOA,GAAOuK,WAGlB,OAAO4J,GAGX,QAAShG,GAAwBrB,GAC7B3E,KAAKnI,OAAOkJ,sBAAsBpF,KAAKgJ,GAG3C,QAAS2B,GAAYhR,EAAOsP,GACxB,MAAItP,OACAnB,GAAKmB,MAAMA,QAGf0K,KAAKnI,OAAO0O,YAAc3B,GAG9B,QAAS4B,GAAkBxD,GACvB,GAAInL,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMkM,EAAQyD,OAEH,aAApBzD,EAAQpI,UACR/C,EAAO+I,SAAWC,EAClBlB,EAAOrK,MAAM,0CAGbuC,EAAO6I,kBAAkBqE,cAAc/B,EAAQgC,WAC3CnN,EAAOf,IAAM9C,EAAOuO,GAAGzL,KACvBe,EAAO6I,kBAAkBqF,YAAYW,OAAQ,GAE7C7O,EAAOoJ,eACPpJ,EAAO+I,SAAW+F,EAClBlQ,EAAE0L,KAAKa,EAAQiC,cAAc,SAASN,GAClC9M,EAAO6I,kBAAkBwE,gBAAgBP,KAE7C5B,GACIjM,GAAI,iBACJ2P,MAAMzD,EAAQyD,SAGtBG,KAIR,QAASV,KACLnM,EAAStB,OAAOuH,KAAKnI,OAAOiJ,gBACxBd,KAAKnI,OAAO+I,UAAYuF,IACxBC,EAAkBpG,KAAKnI,QACvBmI,KAAKnI,OAAO+I,SAAWuF,GAK/B,QAASC,GAAkBvO,GACvB,IAAKA,EAAO0O,cAAgB1O,EAAOkJ,sBAAsBqE,OAErD,WADAzF,GAAOrK,MAAM,eAGjB,IAAI0N,IACIlM,GAAI,YACJ2P,MAAO5O,EAAOf,GACduO,SAAUxN,EAAO0O,YACjBtB,cAAcpN,EAAOkJ,sBAE7BgC,GAAYC,GACZnL,EAAO0O,YAAc,KACrB1O,EAAOkJ,yBAGX,QAAS8F,GAAc7D,GACnB,GAAItI,GAAM1G,EAAO6C,QAAQM,UAAY9C,EAAQkE,OAAOvE,EAAO6C,QAAQM,WAAa,GAChFkI,GAAQ+D,SAAS0D,KAAOpM,EAG5B,QAASqM,GAAa/D,GAClBgE,EAAiBhE,EAAQiE,YAG7B,QAASL,KACL,GAAI/O,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAEvB,uBAETrJ,KACAA,EAAOqJ,uBAAyB,EAChCwE,EAAU7N,IAIlB,QAASmP,GAAiBC,GACtB,GAAIC,KACJzQ,GAAE0L,KAAKnO,EAAOqB,WAAY,SAAS8R,GAC/B,GAAIC,GAAS3Q,EAAE+L,KAAKyE,EAAY,SAASxE,GACrC,MAAO0E,GAAOrQ,IAAM2L,EAAEzN,KAEtBoS,IACAD,EAAOlH,MAAQmH,EAAOnH,MACtBkH,EAAOjH,QAAUkH,EAAOlH,QACxBiH,EAAOE,QAAS,EACZF,EAAOjH,QACHiH,EAAOlH,OACFkH,EAAOlG,eACRkG,EAAOjG,uBAAyB,GAChCiG,EAAOlG,cAAgBkG,EAAOvG,UAAUC,IACxCsG,EAAOjG,uBAAyB,IAEhCiG,EAAOlG,cACPiG,EAAUvL,KAAKwL,GAGvBD,EAAUvL,KAAKwL,KAGfA,EAAOjH,SACPgH,EAAUvL,KAAKwL,GACnBA,EAAOjH,SAAU,EACjBiH,EAAOlH,OAAQ,EACfkH,EAAOE,QAAS,KAGxB5Q,EAAE0L,KAAK+E,EAAW,SAASrP,GACvB0N,EAAY1N,KAEhB+O,IA0FJ,QAASU,GAAYtE,GACjBhP,EAAOiO,YAAYtG,MACf4L,KAAQvE,EAAQuE,KAChBC,KAAQxE,EAAQwE,OApjBxB,GAAIlH,GAAc,EACdgI,EAAiB,EACjB9D,EAAiB,EACjBW,EAAgB,EAGhBtE,EAAc,EACdgF,EAAiB,EACjBM,EAAiB,EACjBQ,EAAgB,EAEhBjC,EAAiB,IACjBY,GAAkB,GA8DtBtR,GAAOuU,QAAU,WACa,GAAtBnJ,EAAQR,YACRmE,GAAcjM,GAAI,SAClB9C,EAAOyN,MAAM+G,MAAO,EACpBxU,EAAOyN,MAAMgH,OACbzU,EAAOuO,GAAGlC,SAAWiI,GAErBjJ,EAAQ+D,SAASC,UAGzBrP,EAAO8Q,WAAa,WAChB9Q,EAAOuO,GAAGlC,SAAWC,EACrBtM,EAAOyN,MAAMrD,MACb,KACQpK,EAAOuO,GAAGpC,mBACVnM,EAAOuO,GAAGpC,kBAAkB,eAAkBqF,QAClD/O,EAAE0L,KAAKnO,EAAOqB,WAAY,SAASwC,GAC3BA,EAAO+I,UAAYC,GACnB0E,EAAY1N,KAEpBkL,GACIjM,GAAI,UAEV,MAAO2O,GACLtR,EAAKmB,MAAMmQ,KAInBrG,EAAQsJ,UAAY,SAAS1F,GACzB,GAAI2F,GAAgBzF,KAAK0F,MAAM5F,EAAQ5N,KAEvC,QADAyT,QAAQhU,KAAK,qBAAuBmO,EAAQ5N,MACpCuT,EAAc7R,IAClB,IAAK,eACDwM,EAAaqF,EACb,MACJ,KAAK,MACD9B,GACA,MACJ,KAAK,eACDE,EAAa4B,EACb,MACJ,KAAK,SACDrH,GAAOqH,EACP,MACJ,KAAK,WACDG,GAASH,EACT,MACJ,KAAK,kBACD9D,EAAgB8D,EAChB,MACJ,KAAK,oBACDnC,EAAkBmC,EAClB,MACJ,KAAK,OACDrB,EAAYqB,EACZ,MACJ,SACIE,QAAQvT,MAAM,uBAAwBqT,GAE9C3U,EAAO+U,UAiIX/U,EAAOgV,YAAc,SAASvC,GAC1BzS,EAAOiY,cAAe,CACtB,IAAIhD,GAAYxS,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC/C,MAAOA,GAAE3L,IAAM2P,GAGfwC,GAAU/I,SAAW+I,EAAUhJ,QAC/BsF,EAAY0D,GACZvD,EAAUuD,IAGdlP,EAAS,WACL/F,EAAOiY,cAAe,GACvB,MAsMPjY,EAAOkV,MAAQ,WACX,GAAIxO,GAAM1G,EAAO6C,QAAQM,UAAYnD,EAAO6C,QAAQM,UAAY,GAChE4L,IACIjM,GAAI,UAERuI,EAAQ+D,SAAS0D,KAAOpM,GAE5B1G,EAAOmV,UAAY,WACfpG,GACIjM,GAAI,SAGZ9C,EAAOoV,YAAc,WACjB,GAAIC,GAAcrV,EAAOuO,GAAGpC,kBAAkBmJ,gBAC9C,IAAID,EAAa,CACb,GAAIE,GAAaF,EAAYG,iBAAiB,EAC9CxV,GAAOoN,OAASpN,EAAOoN,MACvBmI,EAAWE,QAAUzV,EAAOoN,QAGpCpN,EAAO0V,YAAc,WACjB,GAAIL,GAAcrV,EAAOuO,GAAGpC,kBAAkBmJ,gBAC9C,IAAID,EAAa,CACb,GAAIM,GAAaN,EAAYO,iBAAiB,EAC9C5V,GAAOqN,OAASrN,EAAOqN,MACvBsI,EAAWF,QAAUzV,EAAOqN,QAGpCrN,EAAO6V,WAAa,WAChB7V,EAAOsN,QAAUtN,EAAOsN,OAEpByB,EADA/O,EAAOsN,QACMxK,GAAI,WAEJA,GAAI,cAGzB9C,EAAO8B,cAAgB,SAASC,GAC5B3B,EAAW2B,GAAOC,UAEtBhC,EAAO+V,aAAe,SAASpS,GAC3B,GAAIE,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMa,GAEnBE,GAAOyJ,QAAS,GACXzJ,EAAOqI,SAAWrI,EAAOwP,QAC1BtE,GACIjM,GAAI,SACJkT,UAAanS,EAAOf,MAIhC9C,EAAOiW,cAAgB,SAAStE,GAC5B,GAAI9N,GAAS8N,EAAK9N,MACdA,KACAA,EAAOyJ,QAAS,EAChByB,GACIjM,GAAI,UACJkT,UAAanS,EAAOf,MAIhC,IAAIwK,IAAS,SAAS0B,GAClB,GAAInL,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMkM,EAAQrL,UAE3BE,GAAOyJ,QAAS,GAEhBwH,GAAW,SAAS9F,GACpB,GAAInL,GAASpB,EAAE+L,KAAKxO,EAAOqB,WAAY,SAASoN,GAC5C,MAAOA,GAAE3L,IAAMkM,EAAQrL,UAE3BE,GAAOyJ,QAAS,EAEpBtN,GAAOkW,KAAO,WACV,GAAIlH,IACAlM,GAAI,OACJ0Q,KAAMxT,EAAOmW,UAEjBpH,GAAYC,GACZhP,EAAOmW,UAAY,IAGvBnW,EAAOoW,gBAAkB,SAASC,GACX,UAAf1Q,MAAMC,MACN5F,EAAOkW,QAUflW,EAAOsW,QAAU,SAAS3E,GACtB,MAAOA,GAAKrD,MAAQ,GAGxBvO,EAAWwW,IAAI,oBAAqB,SAAS5Q,EAAOoO,EAAMyC,GACjDA,GACDpL,EAAQoG,UAGhBnG,EAAQoL,eAAiB,WACrBrL,EAAQoG,QACRtG,EAAUzG,OAAOiS,cAGrBvJ,OAIJzN,QAAQC,OAAO,eAAe,MAAM,SAAS,SAAS,aAAa,uBAEnED,QAAQC,OAAO,eAAeoJ,QAAA,iBAAO,SAAUmP,GAC3CA,EACKC,KAAK,UACFlS,YAAa,6CACbrG,WAAY,gBACZwY,aAAc,sDAEjBD,KAAK,gBACFlS,YAAa,kDACbrG,WAAY,qBACZwY,aAAc,2DAEjBD,KAAK,uBACFlS,YAAa,mDACbrG,WAAY,sBACZwY,aAAc,4DAEjBD,KAAK,qBACFlS,YAAa,iDACbrG,WAAY,oBACZwY,aAAc,oDAEjBC,WACGC,WAAY,SAMxB5Y,QAAQC,OAAO,OACZoI,QAAQ,aAAc,WACrB,GAAIwQ,IACHC,UAAW,SAASC,EAAKC,EAAUC,EAAWC,GAC7C,GAAIC,GAAWJ,EAAInB,MACjBwB,EAAYL,EAAIM,OAEdC,EAAQ,EACVC,EAAS,EACTC,EAAS,CACXD,GAASP,EAAWG,EACpBK,EAASP,EAAYG,EAInBE,EADWE,EAATD,EACMA,EAEAC,CAEV,IAAIC,GAASzK,SAAS0K,cAAc,UAChCC,EAAgBF,EAAOG,WAAW,MAClCC,EAAa7K,SAAS0K,cAAc,UACpCI,EAAcD,EAAWD,WAAW,MACpCG,EAAc/K,SAAS0K,cAAc,UACrCM,EAAeD,EAAYH,WAAW;AAC1CC,EAAWjC,MAAQuB,EACnBU,EAAWR,OAASD,EACpBU,EAAYG,UAAUlB,EAAK,EAAG,GAG9BgB,EAAYnC,MAAQuB,EACpBY,EAAYV,OAASD,EACrBY,EAAaC,UAAUJ,EAAY,EAAG,EAAGA,EAAWjC,MAAOiC,EAAWR,OAAQ,EAAG,EAAGU,EAAYnC,MAAOmC,EAAYV,OAKnH,KAAK,GAFDa,GAAS,EACTC,EAAab,EAAQY,EAChBlS,EAAI,EAAQkS,GAALlS,EAAaA,IAG3B6R,EAAWjC,MAAQuB,EAAWgB,EAAanS,EAC3C6R,EAAWR,OAASD,EAAYe,EAAanS,EAE7C8R,EAAYG,UAAUF,EAAa,EAAG,EAAGA,EAAYnC,MAAOmC,EAAYV,OAAQ,EAAG,EAAGQ,EAAWjC,MAAOiC,EAAWR,QAGnHU,EAAYnC,MAAQuB,EAAWgB,EAAanS,EAC5C+R,EAAYV,OAASD,EAAYe,EAAanS,EAC9CgS,EAAaC,UAAUJ,EAAY,EAAG,EAAGA,EAAWjC,MAAOiC,EAAWR,OAAQ,EAAG,EAAGU,EAAYnC,MAAOmC,EAAYV,OAIrHI,GAAO7B,MAAQuB,EAAWgB,EAAaD,EACvCT,EAAOJ,OAASD,EAAYe,EAAaD,EACzCP,EAAcM,UAAUF,EAAa,EAAG,EAAGA,EAAYnC,MAAOmC,EAAYV,OAAQ,EAAG,EAAGI,EAAO7B,MAAO6B,EAAOJ,QAG9F,IAAXH,GAA4B,KAAXA,GACnBO,EAAO7B,MAAQmC,EAAYV,OAC3BI,EAAOJ,OAASU,EAAYnC,QAE5B6B,EAAO7B,MAAQmC,EAAYnC,MAC3B6B,EAAOJ,OAASU,EAAYV,QAG9BM,EAAcS,UAAU,EAAG,EAAGX,EAAO7B,MAAO6B,EAAOJ,QACpC,IAAXH,GAA4B,KAAXA,EACnBS,EAAcU,UAAUN,EAAYV,OAAS,EAAGU,EAAYnC,MAAQ,GAEpE+B,EAAcU,UAAUN,EAAYnC,MAAQ,EAAGmC,EAAYV,OAAS,GAEtEM,EAAcW,OAAOpB,EAAUf,KAAKoC,GAAK,KACzCZ,EAAcM,UAAUF,GAAcA,EAAYnC,MAAQ,GAAImC,EAAYV,OAAS,EAGnF,IAAImB,GAAUf,EAAOgB,WACrB,OAAOD,IAETE,UAAW,SAASC,EAASC,EAAaC,GACxCD,EAAcA,GAAe,GAC7BC,EAAYA,GAAa,GAKzB,KAAK,GAHDC,GAAiBC,KAAKJ,GACtBK,KAEKC,EAAS,EAAGA,EAASH,EAAepJ,OAAQuJ,GAAUJ,EAAW,CAIxE,IAAK,GAHDK,GAAQJ,EAAeI,MAAMD,EAAQA,EAASJ,GAE9CM,EAAc,GAAIC,OAAMF,EAAMxJ,QACzB1J,EAAI,EAAGA,EAAIkT,EAAMxJ,OAAQ1J,IAChCmT,EAAYnT,GAAKkT,EAAMG,WAAWrT,EAGpC,IAAIsT,GAAY,GAAIC,YAAWJ,EAE/BH,GAAW/S,KAAKqT,GAGlB,GAAIE,GAAO,GAAIC,MAAKT,GAAcU,KAAMd,GACxC,OAAOY,IAGT,OAAO3C,KAKX7Y,QAAQC,OAAO,OACZoI,QAAQ,aAAc,WACrB,GAAIwQ,IACHC,UAAW,SAASC,EAAKC,EAAUC,EAAWC,GAC7C,GAAIC,GAAWJ,EAAInB,MACjBwB,EAAYL,EAAIM,OAEdC,EAAQ,EACVC,EAAS,EACTC,EAAS,CACXD,GAASP,EAAWG,EACpBK,EAASP,EAAYG,EAInBE,EADWE,EAATD,EACMA,EAEAC,CAEV,IAAIC,GAASzK,SAAS0K,cAAc,UAChCC,EAAgBF,EAAOG,WAAW,MAClCC,EAAa7K,SAAS0K,cAAc,UACpCI,EAAcD,EAAWD,WAAW,MACpCG,EAAc/K,SAAS0K,cAAc,UACrCM,EAAeD,EAAYH,WAAW,KAC1CC,GAAWjC,MAAQuB,EACnBU,EAAWR,OAASD,EACpBU,EAAYG,UAAUlB,EAAK,EAAG,GAG9BgB,EAAYnC,MAAQuB,EACpBY,EAAYV,OAASD,EACrBY,EAAaC,UAAUJ,EAAY,EAAG,EAAGA,EAAWjC,MAAOiC,EAAWR,OAAQ,EAAG,EAAGU,EAAYnC,MAAOmC,EAAYV,OAKnH,KAAK,GAFDa,GAAS,EACTC,EAAab,EAAQY,EAChBlS,EAAI,EAAQkS,GAALlS,EAAaA,IAG3B6R,EAAWjC,MAAQuB,EAAWgB,EAAanS,EAC3C6R,EAAWR,OAASD,EAAYe,EAAanS,EAE7C8R,EAAYG,UAAUF,EAAa,EAAG,EAAGA,EAAYnC,MAAOmC,EAAYV,OAAQ,EAAG,EAAGQ,EAAWjC,MAAOiC,EAAWR,QAGnHU,EAAYnC,MAAQuB,EAAWgB,EAAanS,EAC5C+R,EAAYV,OAASD,EAAYe,EAAanS,EAC9CgS,EAAaC,UAAUJ,EAAY,EAAG,EAAGA,EAAWjC,MAAOiC,EAAWR,OAAQ,EAAG,EAAGU,EAAYnC,MAAOmC,EAAYV,OAIrHI,GAAO7B,MAAQuB,EAAWgB,EAAaD,EACvCT,EAAOJ,OAASD,EAAYe,EAAaD,EACzCP,EAAcM,UAAUF,EAAa,EAAG,EAAGA,EAAYnC,MAAOmC,EAAYV,OAAQ,EAAG,EAAGI,EAAO7B,MAAO6B,EAAOJ,QAG9F,IAAXH,GAA4B,KAAXA,GACnBO,EAAO7B,MAAQmC,EAAYV,OAC3BI,EAAOJ,OAASU,EAAYnC,QAE5B6B,EAAO7B,MAAQmC,EAAYnC,MAC3B6B,EAAOJ,OAASU,EAAYV,QAG9BM,EAAcS,UAAU,EAAG,EAAGX,EAAO7B,MAAO6B,EAAOJ,QACpC,IAAXH,GAA4B,KAAXA,EACnBS,EAAcU,UAAUN,EAAYV,OAAS,EAAGU,EAAYnC,MAAQ,GAEpE+B,EAAcU,UAAUN,EAAYnC,MAAQ,EAAGmC,EAAYV,OAAS,GAEtEM,EAAcW,OAAOpB,EAAUf,KAAKoC,GAAK,KACzCZ,EAAcM,UAAUF,GAAcA,EAAYnC,MAAQ,GAAImC,EAAYV,OAAS,EAGnF,IAAImB,GAAUf,EAAOgB,WACrB,OAAOD,IAETE,UAAW,SAASC,EAASC,EAAaC,GACxCD,EAAcA,GAAe,GAC7BC,EAAYA,GAAa,GAKzB,KAAK,GAHDC,GAAiBC,KAAKJ,GACtBK,KAEKC,EAAS,EAAGA,EAASH,EAAepJ,OAAQuJ,GAAUJ,EAAW,CAIxE,IAAK,GAHDK,GAAQJ,EAAeI,MAAMD,EAAQA,EAASJ,GAE9CM,EAAc,GAAIC,OAAMF,EAAMxJ,QACzB1J,EAAI,EAAGA,EAAIkT,EAAMxJ,OAAQ1J,IAChCmT,EAAYnT,GAAKkT,EAAMG,WAAWrT,EAGpC,IAAIsT,GAAY,GAAIC,YAAWJ,EAE/BH,GAAW/S,KAAKqT,GAGlB,GAAIE,GAAO,GAAIC,MAAKT,GAAcU,KAAMd,GACxC,OAAOY,IAGT,OAAO3C,KAGX7Y,QAAQC,OAAO,OAAOoI,QAAQ,aAAA,OAAa,SAAU5H,GAOjD,QAASkb,GAAoB1V,GAIzB,GAHIA,EAAMvE,MAAQuE,EAAMvE,KAAKka,KAAO,GAChCC,EAAc5T,KAAKhC,EAAMvE,MAEC,WAA1BkK,eAAekQ,UAAyBxb,OAAOyb,UAAW,CAC1D,GAAIC,GAAc,GAAIP,MAAKI,GACvBH,KAAM,eAENlS,EAAO,GAAIyS,OAAMD,GAAc,cACnCvb,GAAKU,KAAK,qBACV+a,EAAY1S,IAIpB,QAAS2S,GAAWlW,GAChBxF,EAAKU,KAAK,qBAAsB8E,GApBpC,GAAImW,GACAP,EAEAK,CAoBJ,QACIzR,MAAO,SAAS4R,GAEZR,IACA,IAAI7L,IACAsM,SAAU,wBAETC,eAAcC,gBAAgBxM,EAAQsM,YACvC7b,EAAKU,KAAK6O,EAAQsM,SAAW,qBAC7BtM,GACIsM,SAAU,yBAETC,cAAcC,gBAAgBxM,EAAQsM,YACvC7b,EAAKU,KAAK6O,EAAQsM,SAAW,qBAC7BtM,GACIsM,SAAU,cAETC,cAAcC,gBAAgBxM,EAAQsM,YACvC7b,EAAKU,KAAK6O,EAAQsM,SAAW,qBAC7BtM,GACIsM,SAAU,MAK1B,KACIF,EAAgB,GAAIG,eAAcF,EAAQrM,GAC5C,MAAO+B,GAGL,MAFAoD,SAAQvT,MAAM,2CAA6CmQ,OAC3D0K,OAAM,2CAA6C1K,EAAI,eAAiB/B,EAAQsM,UAGpF7b,EAAKU,KAAK,wBAAyBib,EAAe,eAAgBpM,GAClEoM,EAAcM,OAASP,EACvBC,EAAcO,gBAAkBhB,EAChCS,EAAc3R,SAElBC,KAAM,SAASnC,GAOX,GALA2T,EAAe3T,EACf6T,EAAc1R,OACdjK,EAAKU,KAAK,iBAAkB0a,GAGE,UAA1BjQ,eAAekQ,QAAqB,CACpC,GAAIE,GAAc,GAAIP,MAAKI,GACvBH,KAAM,eAENlS,EAAO,GAAIyS,OAAMD,GAAc,cACnCvb,GAAKU,KAAK,oBACV+a,EAAY1S,SAM5BxJ,QAAQC,OAAO,OAAOkG,UAAU,WAAY,WACxC,MAAO,UAAUyW,EAAOC,EAASC,GAC7BD,EAAQtK,KAAK,mBAAoB,SAAUtM,GACpB,KAAhBA,EAAM8W,QACLH,EAAMvH,OAAO,WACTuH,EAAMI,MAAMF,EAAMG,YAGtBhX,EAAMiX,uBAKtBld,QAAQC,OAAO,OAAOkG,UAAU,aAAc,SAAU,SAAUgX,GAC/D,OACG7W,SAAU,IACVE,KAAM,SAASoW,EAAOC,EAASC,GAC5B,GAAIM,GAAQD,EAAOL,EAAMO,WACrBC,EAAcF,EAAMG,MAExBV,GAAQtK,KAAK,SAAU,WACpBqK,EAAMvH,OAAO,WACViI,EAAYV,EAAOC,EAAQ,GAAGW,MAAM,aAQnDxd,QAAQC,OAAO,OAAOkG,UAAU,mBAAoB,KAAM,SAAU,QAAS,OAAQ,WAAY,iBAAkB,eAAgB,SAAU5F,EAAI4c,EAAQ/W,EAAOqF,EAAMpF,EAAUoX,EAAgBC,GA0C5L,QAASlX,GAAKoW,EAAOe,EAAMb,EAAOc,GAiBhC,QAASC,GAA2B5X,GAClC6X,GAAc,KACdlB,EAAMmB,YAAY9X,GAClB+I,SAASgP,KAAKC,oBAAoB,QAASJ,GAkB7C,QAASK,GAAeC,GACtBvB,EAAMwB,SAAWD,EACjBE,GAAazB,EAAM0B,UACf1B,EAAM2B,eAAiBX,GAAQhB,EAAM4B,WACvCZ,EAAKhB,EAAM4B,WAAWC,aAAaC,GAAmBP,GAI1D,QAASQ,GAAaC,GACgB,kBAAzBhC,GAAMiC,eACfjC,EAAMiC,eAAeD,GAGrBhC,EAAMiC,eAAiBD,EAIvBV,EADEU,GACa,GAGA,GAInB,QAASE,GAAaC,EAAKC,GACzB,GAAIC,GAAMzd,CACV,IAAIwd,EAAK,CACPC,EAAMD,EAAIE,MAAM,KAChB1d,EAASud,CACT,KAAK,GAAI/W,GAAI,EAAGA,EAAIiX,EAAKvN,OAAQ1J,IAC/BxG,EAASA,EAAOyd,EAAKjX,QAIvBxG,GAASud,CAEX,OAAOvd,GAGT,QAAS2d,GAAazd,GAEpB,MAAOkb,GAAMwC,WAAWF,MAAM,KAC3Bjc,IAAI,SAASoc,GACZ,MAAOP,GAAapd,EAAM2d,KAE3BlV,KAAK,KAGV,QAASmV,GAAkBC,EAAQC,GAC7BD,IACoB,gBAAXA,IACT3C,EAAM0B,UAAYa,EAAaI,GAC/BZ,GAAcc,eAAgBF,KACH,gBAAXA,IAAuBA,EAAO7N,OAAS,EACvDkL,EAAM0B,UAAYiB,EAEdpK,SAAWA,QAAQvT,OACrBuT,QAAQvT,MAAM,iBAAqB4d,EAAU,UAAY,IAAM,4BAA6BD,EAAQ,6BAIxGrB,GAAe,IA2BnB,QAASwB,KACP9C,EAAM+C,cAAe,EACrB/C,EAAMgD,WACFC,KACFA,GAAGC,UAAY,GAoBnB,QAASC,GAAmB9Z,GAC1B,MAAOA,GAAM8W,MAAQ9W,EAAM8W,MAAQ9W,EAAM+Z,QAG3C,QAASC,GAAuBC,GAC9B,MAAO,UAASxe,GACd,MAAOkb,GAAMsD,GAAMtD,EAAMsD,GAAIxe,GAAQA,GAIzC,QAASye,GAAelW,GACtB0U,GAAcc,eAAgBxV,IAE1B2S,EAAMwD,gBACRxD,EAAM0B,UAAY,MAEpBoB,IAGF,QAASW,GAAgBC,EAAQrW,GAC/B,GAAIzI,GAAQ+e,EAASC,CAIrB,OADAA,GAAK,GAAIC,QAAOxW,EAAIyW,QAAQ,sBAAuB,QAAS,KACvDJ,GACAA,EAAOK,OAAUL,EAAOI,UAAWJ,EAASA,EAAOM,YACxDL,EAAUD,EAAOK,MAAMH,GAErBhf,EADE+e,EACOD,EAAOI,QAAQF,EACpB,gBAAiB5D,EAAMiE,WAAY,KAAMN,EAAQ,GAAI,WAGhDD,EAEJ7U,EAAKqV,YAAYtf,IAVxB,OAaF,QAASuf,KACPnE,EAAM+C,aAAeqB,GACrBpE,EAAMqE,aAAerE,EAAMsE,WAAa,EAAI,GAC5CtE,EAAMgD,WAGR,QAASuB,GAAoBlX,IAEtBA,GAAOA,EAAIyH,OAAS0P,KAGrBxE,EAAMyE,UACRzE,EAAMvH,OAAO,WACXiM,EAAgBrX,KAGX2S,EAAM2E,iBACbC,EAAkCvX,GAElCwX,EAAiBxX,IAIrB,QAASyX,GAAazb,GACpB,GAAI8W,GAAQgD,EAAmB9Z,EAC/B,IAAI8W,IAAU4E,GAAU5E,IAAU6E,EAKlC,GAAI7E,IAAU8E,GAAU9E,IAAU+E,EAChC7b,EAAMiX,qBAEH,IAAIH,IAAUgF,EACjB9b,EAAMiX,kBACDN,EAAM+C,cAAgB/C,EAAM0B,WAAa1B,EAAM0B,UAAU5M,QAAU0P,KACtEL,IACAnE,EAAMoF,WAAY,EAClBb,EAAoBvE,EAAM0B,gBAGzB,IAAIvB,IAAUkF,EACjBvC,IACA9C,EAAMvH,OAAO,WACX6M,GAAWC,IAAIvF,EAAM0B,iBAGpB,CACH,GAAkB,IAAd8C,KAAoBxE,EAAM0B,UAC5B,MAGG1B,GAAM0B,WAAiC,KAApB1B,EAAM0B,UAEnB1B,EAAM0B,UAAU5M,QAAU0P,KACnCL,IAEIqB,IACF/b,EAAStB,OAAOqd,IAGlBxF,EAAMoF,WAAY,EAElBI,GAAc/b,EAAS,WACrB8a,EAAoBvE,EAAM0B,YACzB1B,EAAMyF,QAZTzF,EAAM+C,cAAe,EAenBtB,IAAcA,KAAezB,EAAM0B,YAAc1B,EAAMwD,eACzDxD,EAAMvH,OAAO,WACXsJ,OAMR,QAAS2D,KACHC,IACFA,GAAc1gB,UAIlB,QAAS2gB,GAA0Bvc,IAC7B2W,EAAM6F,qBACJ7F,EAAMiC,gBAAkBjC,EAAMiC,eAAeY,iBAAmB7C,EAAM0B,YACtErY,GACFA,EAAMiX,iBAIR7W,EAAStB,OAAOqd,IAEhBE,IAEAnC,EAAevD,EAAM0B,YAIzB,QAASoE,GAAwBC,GAC/B,GAAIC,GAAMC,iBAAiBF,EAC3B,OAAOA,GAAIG,aACTC,SAASH,EAAII,UAAW,IAAMD,SAASH,EAAIK,aAAc,IAG7D,QAASC,KACP,MAAOrD,IAAGsD,wBAAwBC,IAChCL,SAASF,iBAAiBhD,IAAI5G,UAAW,IAG7C,QAASoK,KACP,MAAO1F,GAAK,GAAG2F,iBAAiB,qBAAqB1G,EAAMqE,cAG7D,QAASsC,KACP,MAAOF,KAAcF,wBAAwBC,KAC1CvD,GAAGsD,wBAAwBC,IAC3BL,SAASF,iBAAiBhD,IAAI2D,WAAY,KAG/C,QAASC,GAAoBxI,GAC3B4E,GAAGC,UAAYD,GAAGC,UAAY7E,EAGhC,QAASyI,KACP,GAAI5M,GAAU8F,EAAMgD,QAAQhD,EAAMqE,aAC9BrE,GAAMiE,WACRqB,GAAWC,IAAIhD,EAAarI,EAAQ2I,iBAGpCyC,GAAWC,IAAIrL,EAAQ6M,OAI3B,QAASC,GAAe3d,GACtB,GAAI8W,GAAQgD,EAAmB9Z,GAC3B0c,EAAM,KACNkB,EAAS,IAET9G,KAAU+E,GAAUlF,EAAMgD,SACxBhD,EAAMqE,cAAgB,GAAKrE,EAAMqE,aAAerE,EAAMgD,QAAQlO,QAChEzL,EAAMiX,iBACNN,EAAMkH,aAAalH,EAAMgD,QAAQhD,EAAMqE,iBAEvCuB,EAA0Bvc,GAC1ByZ,KAEF9C,EAAMvH,UACG0H,IAAUgF,GAAUnF,EAAMgD,SACnC3Z,EAAMiX,iBACDN,EAAMqE,aAAe,EAAKrE,EAAMgD,QAAQlO,QAAUkL,EAAM+C,eAC3D/C,EAAMvH,OAAO,WACXuH,EAAMqE,eACNyC,MAGEK,KACFpB,EAAMU,IACFH,IAAmBP,EAAIQ,wBAAwBa,QACjDP,EAAoBf,EAAwBC,OAIzC5F,IAAU8E,GAAUjF,EAAMgD,SACnC3Z,EAAMiX,iBACFN,EAAMqE,cAAgB,GACxBrE,EAAMvH,OAAO,WACXuH,EAAMqE,eACNyC,MAGEK,KACFF,EAASN,IACI,EAATM,GACFJ,EAAoBI,EAAS,KAIH,IAAvBjH,EAAMqE,cACbrE,EAAMvH,OAAO,WACXuH,EAAMqE,aAAe,GACrBiB,GAAWC,IAAIvF,EAAM0B,cAGhBvB,IAAUkH,EACfrH,EAAMgD,SAAWhD,EAAMgD,QAAQlO,OAAS,GAAKkL,EAAM+C,aAC1B,KAAvB/C,EAAMqE,cAAuBrE,EAAM6F,oBAGrCD,KAG2B,KAAvB5F,EAAMqE,eACRrE,EAAMqE,aAAe,GAEvBrE,EAAMkH,aAAalH,EAAMgD,QAAQhD,EAAMqE,eACvCrE,EAAMsH,WAOJtH,EAAM0B,WAAa1B,EAAM0B,UAAU5M,OAAS,GAC9C8Q,IAGKzF,IAAUkF,GAGnBhc,EAAMiX,iBAIV,QAASiH,GAAeC,EAAcna,GACpC,GAAIjC,GAAGqc,EAAaC,EAAOxQ,EAAMyQ,EAAeC,CAEhD,IAAIJ,GAAgBA,EAAa1S,OAAS,EAGxC,IAFAkL,EAAMgD,WAED5X,EAAI,EAAGA,EAAIoc,EAAa1S,OAAQ1J,IAAK,CAKxC,GAJI4U,EAAMwC,YAAmC,KAArBxC,EAAMwC,aAC5BtL,EAAOyQ,EAAgBpF,EAAaiF,EAAapc,KAGhD4U,EAAM6H,eAAyC,KAAxB7H,EAAM6H,cAAqB,CACnD,GAAIA,GAAgB3F,EAAasF,EAAapc,GAAI4U,EAAM6H,cACrDA,KACD3Q,GAAQ,KAAO2Q,GAInBJ,EAAc,GACVzH,EAAM8H,mBACRL,EAAcG,EAAgB1F,EAAasF,EAAapc,GAAI4U,EAAM8H,mBAGpEJ,EAAQ,GACJ1H,EAAM+H,aACRL,EAAQxF,EAAasF,EAAapc,GAAI4U,EAAM+H,aAG1C/H,EAAMiE,aACR0D,EAAgBlE,EAAgBvM,EAAM7J,GACtCua,EAAgBnE,EAAgBgE,EAAapa,IAG/C2S,EAAMgD,QAAQhD,EAAMgD,QAAQlO,SAC1BiS,MAAOY,EACPF,YAAaG,EACbF,MAAOA,EACP7E,eAAgB2E,EAAapc,QAKjC4U,GAAMgD,UAGJhD,GAAMgI,WAAsC,IAAzBhI,EAAMgD,QAAQlO,QACjCmT,EAAgBjI,EAAMgD,QAAQ,IAC3B+D,MAAO7P,EAAMgR,KAAMT,GAAe,IAAKzH,EAAM0B,WAClD1B,EAAM+C,cAAe,EACa,IAAzB/C,EAAMgD,QAAQlO,QAAiBqT,GAGxCnI,EAAM+C,cAAe,EAFrB/C,EAAM+C,cAAe,EAKvB/C,EAAMgD,QAAUhD,EAAMgD,QAAQ1E,MAAM,EAAE,IAGxC,QAAS8J,GAAuB/a,GAC9B,MAAO,UAASma,EAAc3iB,EAAQ4I,EAAShB,GAExC5H,GAAW4I,GAAYhB,IAAU+a,EAAa1iB,OACjD0iB,EAAeA,EAAa1iB,MAE9Bkb,EAAMoF,WAAY,EAClBmC,EACErF,EAAamG,GAAkBb,GAAexH,EAAMsI,oBACpDjb,IAIN,QAASkb,GAAkBC,EAAU3jB,EAAQ4I,EAAShB,GAErC,IAAX5H,GAA2B,KAAXA,IAGfA,GAAW4I,GAAYhB,IAC1B5H,EAAS2jB,EAAS3jB,QAEhBmb,EAAMyI,uBACRzI,EAAMyI,uBAAuBD,EAAU3jB,EAAQ4I,EAAShB,GAGpD8L,SAAWA,QAAQvT,OACrBuT,QAAQvT,MAAM,eAKpB,QAAS6f,GAAiBxX,GACxB,GAAIU,MACA3D,EAAM4V,EAAM0I,UAAY1hB,mBAAmBqG,EAC3C2S,GAAM2I,4BACR5a,GAAUA,OAAQiS,EAAM2I,0BAA0Btb,IAClDjD,EAAM4V,EAAM0I,WAER1I,EAAM4I,kCACV7a,EAAO8a,iBAAkB,GAE3BnD,IACAC,GAAgBhiB,EAAGU,QACnB0J,EAAOH,QAAU+X,GAAczgB,QAC/BsE,EAAMjE,IAAI6E,EAAK2D,GACZ7G,QAAQkhB,EAAuB/a,IAC/BrI,MAAMujB,GAGX,QAAS3D,GAAkCvX,GACzCqY,IAEAC,GAAgBhiB,EAAGU,QAEnB2b,EAAM2E,iBAAiBtX,EAAKsY,GAAczgB,SACvCU,KAAKwiB,EAAuB/a,IAD/B2S,SAESuI,GASX,QAAS7D,GAAgBrX,GACvB,GAAIjC,GAAG2Y,EAAOzO,EAAG0M,EACb8G,EAAe9I,EAAM8I,aAAaxG,MAAM,KACxCqB,IAIJ,KAHkC,mBAAvB3D,GAAM+I,eACf1b,EAAM2S,EAAM+I,aAAa1b,IAEtBjC,EAAI,EAAGA,EAAI4U,EAAMyE,UAAU3P,OAAQ1J,IAAK,CAG3C,IAFA2Y,GAAQ,EAEHzO,EAAI,EAAGA,EAAIwT,EAAahU,OAAQQ,IACnC0M,EAAQE,EAAalC,EAAMyE,UAAUrZ,GAAI0d,EAAaxT,KAAO,GAC7DyO,EAAQA,GAAU/B,EAAMgC,WAAWlc,cAAckhB,QAAQ3b,EAAI2W,WAAWlc,gBAAkB,CAGxFic,KACFJ,EAAQA,EAAQ7O,QAAUkL,EAAMyE,UAAUrZ,IAI9C4U,EAAMoF,WAAY,EAClBmC,EAAe5D,EAAStW,GAG1B,QAAS4a,GAAgBrjB,EAAQud,EAAK9U,GACpC,IAAKA,EAAO,OAAO,CACnB,KAAI,GAAI+U,KAAOD,GACb,GAAGA,EAAIC,GAAKta,gBAAkBuF,EAAIvF,cAEhC,MADAkY,GAAMkH,aAAatiB,IACZ,CAGX,QAAO,EAGT,QAASqkB,KACHjJ,EAAMyE,UACR8C,EAAevH,EAAMyE,UAAW,IAEzBzE,EAAM2E,iBACbC,EAAkC,IAGlCC,EAAiB,IArjBrB,GAGIqE,GAEAb,GAMAc,GACA/E,GACA+D,GAbA7C,GAAavE,EAAK7O,KAAK,SACvBsS,GAAY4E,EACZ5D,GAAc,KAEd1D,GAAoBuH,EAEpB5H,GAAa,KACbkE,GAAgB,KAChB1C,GAAKlC,EAAK,GAAGuI,cAAc,0BAC3BnC,IAAa,EACbjG,GAAc,IAYlBH,GAAKwI,GAAG,YAAa,SAASlgB,GACxBA,EAAMqa,OAAOld,IACf0a,GAAc7X,EAAMqa,OAAOld,GACvB0a,KAAgBlB,EAAMxZ,GAAK,aAC7B4L,SAASgP,KAAKoI,iBAAiB,QAASvI,IAI1CC,GAAc7X,EAAMqa,OAAO+F,YAI/BzJ,EAAMqE,aAAerE,EAAMsE,WAAa,EAAI,KAC5CtE,EAAMoF,WAAY,EAmElB+D,GAAqBnJ,EAAM0J,OAAO,eAAgB,SAAS/G,GACrDA,IAEFwG,KAEAzG,EAAkBC,GAAQ,MAI9B3C,EAAM0J,OAAO,gBAAiB,SAAS/G,EAAQgH,GACzChH,IAAWgH,IACRhH,EAOHrB,EAJQG,IAAqC,KAAvBzB,EAAMqE,cAIb,GAHA,GAHfrD,EAAKhB,EAAM4B,WAAWC,aAAaC,IAAmB,MAmB5D9B,EAAM/F,IAAI,8BAA+B,SAAU5Q,EAAOugB,GACnDA,GAAaA,IAAc5J,EAAMxZ,KACpCwZ,EAAM0B,UAAY,KAClBK,IACAT,GAAe,GACfwB,OAIJ9C,EAAM/F,IAAI,+BAAgC,SAAU5Q,EAAOugB,EAAWjH,GAC9DiH,GAAaA,IAAc5J,EAAMxZ,IACrCkc,EAAkBC,KAyatB3C,EAAM6J,eAAiB,WACjB7J,EAAM8J,SACR9J,EAAM8J,UAEU,IAAdtF,IAAqBxE,EAAM0B,WAAwC,IAA3B1B,EAAM0B,UAAU5M,SAC1DkL,EAAMqE,aAAerE,EAAMsE,WAAa,EAAItE,EAAMqE,aAClDrE,EAAM+C,cAAe,EACrBkG,MAIJjJ,EAAMmB,YAAc,WACdD,KACCA,KAAgBlB,EAAMxZ,GAAK,aAC3B0a,GAAY8H,QAAQ,iBAAmB,GAC1C9H,GAAc,MAGdgI,EAAYzf,EAAS,WACnBqZ,IACA9C,EAAMvH,OAAO,WACPuH,EAAM0B,WAAa1B,EAAM0B,UAAU5M,OAAS,GAC9CwQ,GAAWC,IAAIvF,EAAM0B,cAGxBqI,GACHrE,IAEI1F,EAAMgK,UACRhK,EAAMgK,WAGJhK,EAAM6F,qBACJ7F,EAAM0B,WAAa1B,EAAM0B,UAAU5M,OAAS,GAA4B,KAAvBkL,EAAMqE,cACzDuB,MAMR5F,EAAMiK,iBAAmB,WACnBf,GACFzf,EAAStB,OAAO+gB,IAIpBlJ,EAAMkK,SAAW,SAASlY,GACxBgO,EAAMqE,aAAerS,GAGvBgO,EAAMkH,aAAe,SAAStiB,GAExBob,EAAMiE,aACRrf,EAAOmiB,MAAQxE,EAAa3d,EAAOie,gBACnCje,EAAO6iB,YAAcvF,EAAatd,EAAOie,eAAgB7C,EAAM8H,mBAG7D9H,EAAMwD,cACRxD,EAAM0B,UAAY,KAGlB1B,EAAM0B,UAAY9c,EAAOmiB,MAE3BhF,EAAand,GACbke,KAGF9C,EAAMmK,mBAAqB,SAAS9c,GAalC,MAZIA,GAAIyH,OAAS0P,IACfkB,IACA5C,KAEsB,IAAfzV,EAAIyH,QAA8B,IAAd0P,KAC3BxE,EAAMoF,WAAY,EAClB6D,KAGEjJ,EAAMoK,eACR/c,EAAM2S,EAAMoK,aAAa/c,IAEpBA,GAIL2S,EAAMqK,oBAAmD,KAA7BrK,EAAMqK,qBACpCvI,GAAoB9B,EAAMqK,oBAIxBrK,EAAMwE,WAAiC,KAApBxE,EAAMwE,YAC3BA,GAAY2B,SAASnG,EAAMwE,UAAW,KAInCxE,EAAMyF,QACTzF,EAAMyF,MAAQ6E,GAIXtK,EAAMwD,gBACTxD,EAAMwD,eAAgB,GAInBxD,EAAM6F,sBACT7F,EAAM6F,qBAAsB,GAI1B7F,EAAM2B,eAAiBX,GAGvBM,EADEtB,EAAMuK,cACO,GAGA,GAInBvK,EAAMwK,UAAYtK,EAAMpB,KAAOoB,EAAMpB,KAAO,OAG5CkB,EAAMyK,cAAgBvK,EAAMuK,cAAgBvK,EAAMuK,cAAgBC,EAClE1K,EAAM2K,cAAgBzK,EAAMyK,cAAgBzK,EAAMyK,cAAgBC,EAClExG,GAA2C,UAAxBpE,EAAMyK,eAA4B,GAAQ,EAC7DtC,GAA2C,UAAxBnI,EAAM2K,eAA4B,GAAQ,EAG7D3K,EAAM6K,UAAY3K,EAAM2K,UAAY3K,EAAM2K,UAAYC,EAGtDxF,GAAWiE,GAAG,UAAWvC,GACzB1B,GAAWiE,GAAG,QAASzE,GAGvBuD,GAAoBhF,EAAuB,8BAG3C5Z,EAAS,WACP,GAAIuc,GAAMC,iBAAiBhD,GAC3BkE,IAAanB,EAAI3J,WAA+B,SAAlB2J,EAAI+E,YA9uBtC,GAAI5F,GAAU,GACVH,EAAU,GACVC,EAAU,GACVF,EAAU,GACVM,EAAU,GACVH,EAAU,GACVmC,EAAW,EAEX+B,EAAa,EACb0B,EAAa,OACbR,EAAQ,IACRP,EAAe,IAGfV,EAAiB,wBACjBqB,EAAiB,eACjBE,EAAiB,mBACjBI,EAAe,8BAiuBnB,OA9tBAnK,GAAeoK,IAAID,EACf,w1DA8tBFthB,SAAU,KACVwhB,QAAS,SACTlL,OACEiC,eAAgB,IAChBkJ,aAAc,IACdZ,aAAc,IACd9F,UAAW,IACXkE,0BAA2B,IAC3BC,gCAAiC,IACjCwC,2BAA4B,IAC5B3C,uBAAwB,IACxB9D,iBAAkB,IAClBne,GAAI,IACJsY,KAAM,IACNuM,YAAa,IACb3C,UAAW,IACXJ,mBAAoB,IACpB9F,WAAY,IACZsF,iBAAkB,IAClBC,WAAY,IACZuD,WAAY,IACZ7F,MAAO,IACPqD,aAAc,IACdtE,UAAW,IACXP,WAAY,IACZT,cAAe,IACfqC,oBAAqB,IACrBlE,cAAe,IACf0I,mBAAoB,IACpBD,aAAc,IACdpC,UAAW,IACXgC,SAAU,IACVF,QAAS,IACTlI,UAAW,IACX0C,WAAY,IACZyE,WAAY,IACZlB,cAAe,KAEjBle,YAAa,SAASsW,EAASC,GAC7B,MAAOA,GAAMvW,aAAeqhB,GAE9BO,QAAS,SAASC,GAChB,GAAIC,GAAW3K,EAAa4K,cACxBC,EAAS7K,EAAa8K,WAC1B,IAAmB,OAAbH,GAAgC,OAAXE,EAAkB,CAC3C,GAAIE,GAAmBL,EAASM,OAC7BhI,QAAQ,QAAS2H,GACjB3H,QAAQ,QAAS6H,EACpBH,GAASM,KAAKD,GAEhB,MAAOjiB,QAKfxG,QAAQC,OAAO,kBAAkBoJ,QAAA,iBAAA,uBAAA,8BAAO,SAAUmP,EAAgBmQ,EAAsBC,GAEpFpQ,EAAeC,KAAK,aAERlS,YAAa,+CACbrG,WAAY,yBACZwY,aAAc,qDAK9B1Y,QAAQC,OAAO,cAAcoJ,QAAA,iBAAO,SAAUmP,GAC1CA,EAAeC,KAAK,SAChBlS,YAAa,mCACbrG,WAAY,iBACZwY,aAAc,sCAEjBD,KAAK,iBACFlS,YAAa,2CACbrG,WAAY,yBACZwY,aAAc,iDAItB1Y,QAAQC,OAAO,oBAAoBoJ,QAAA,iBAAA,uBAAA,8BAAO,SAAUmP,EAAgBmQ,EAAsBC,GAEtFpQ,EAAeC,KAAK,SAERlS,YAAa,yCACbrG,WAAY,iBACZwY,aAAc,+CAK9B1Y,QAAQC,OAAO,aACZ4oB,SAAS,SAAU,oDACnBA,SAAS,YAAa,uDACtBA,SAAS,eAAgB7hB,IAAM,wCAAwC8hB,WAAa,SAASC,SAAW,WACxGF,SAAS,cAAc,GAQ1B7oB,QAAQC,OAAO,OACV+oB,QAAQ,mBAAoB,WACzB,GAAIC,GAAc,IAElB,QACIC,UAAW,SAASnK,GAChBkK,EAAclK,GAElBoK,UAAW,WACP,MAAOF,OAIvBjpB,QAAQC,OAAO,OACV+oB,QAAQ,aAAA,WAAa,SAASnmB,GAM3B,QAASumB,GAAUrV,EAAKsV,GACpBxmB,EAASymB,KACLzmB,EAAS0mB,SACJC,YAAYzV,GACZ0V,SAASA,GACTC,WAAWL,GACXM,UAAUC,IAIvB,QAAShoB,GAAMmS,GACXqV,EAAUrV,EAAK8V,GAGnB,QAAS/lB,GAAQiQ,GACbqV,EAAUrV,EAAK+V,GApBnB,GAAIL,GAAkB,YAClBG,EAAkB,IAClBC,EAAkB,kBAClBC,EAAkB,kBAoBtB,QACIloB,MAAOA,EACPkC,QAASA,MAKrB9D,QACKC,OAAO,OACP8pB,KAAA,OAAI,SAAUtpB,GACfA,EAAKupB,MAAM,0BAKfhqB,QAAQC,OAAO,OAAOoJ,QAAA,iBAAO,SAAUmP,GAEnCA,EAAeC,KAAK,KAChBlS,YAAa,mCACbrG,WAAY,iBACZwY,aAAc,yCAUtB1Y,QAAQC,OAAO,OACdmP,OAAO,gBAAiB,UAAW,SAASzO,GACzC,MAAO,UAASspB,GACZ,GAAIjjB,GAAM,EAMV,OAJIijB,KACAjjB,EAAMrG,EAAQkE,OAAOolB,IAGlBjjB,MAIfhH,QAAQC,OAAO,OACdoJ,QAAA,eAAA,qBAAA,kBAAA,qBAAA,eAAA,aAAA,6BAAO,SAAU6gB,EAAcC,EAAoBC,EAAiBC,EAC7DC,EAAcC,EAAWC,GAE7BN,EAAaO,aAAaF,GAEtBD,EAAaI,WAAY,EAC3BJ,EAAaK,QAAU,IACvBL,EAAaM,cAAgB,kBAC7BN,EAAaO,mBAAoB,EACjCP,EAAaQ,aAAc,EAC3BR,EAAaS,aAAc,EAE7BV,EAAmBW,sBACfC,OAAO,0BACPC,OAAQ,UAEZb,EAAmBc,kBAAkB,MACrCd,EAAmBe,iBAAiB,MACpCZ,EAA2Ba,0BAA0B,kBAGzDrrB,QAAQC,OAAO,OAAO8pB,KAAK,iBAAkB,SAAStM,GAAiBA,EAAeoK,IAAI,6CAA6C,i5BACvIpK,EAAeoK,IAAI,mDAAmD,grBACtEpK,EAAeoK,IAAI,iDAAiD,s9IACpEpK,EAAeoK,IAAI,kDAAkD,2wGACrEpK,EAAeoK,IAAI,yCAAyC;AAC5DpK,EAAeoK,IAAI,mCAAmC,u6CACtDpK,EAAeoK,IAAI,2CAA2C,khBAC9DpK,EAAeoK,IAAI,+CAA+C,s3SAClEpK,EAAeoK,IAAI,6DAA6D,urBAChFpK,EAAeoK,IAAI,mDAAmD,83CACtEpK,EAAeoK,IAAI,oDAAoD,iZACvEpK,EAAeoK,IAAI,kDAAkD","file":"scripts/app-cc2e923a99.js","sourcesContent":["'use strict';\r\nangular.module('mainModule', ['api', 'toastr', 'config', 'underscore', 'LocalStorageModule',\r\n    'pascalprecht.translate','base64'\r\n]);\n/**\r\n * @author thanhvk\r\n * created on 29.09.2016\r\n */\r\n 'use strict';\r\n\r\nangular.module('mainModule')\r\n.controller('AdminRoomsListCtrl', function ($meeting, $member, $rootScope, $scope, $q, $location, $log, $mdSidenav, $base64, sharedProperties, localStorageService) {\r\n    $scope.token = localStorageService.get('tokenConference');\r\n    $scope.room = null;\r\n\r\n    function getMembersOfRoom(room) {\r\n        var deffered    = $q.defer(),\r\n            membersList = null,\r\n            info        = {\r\n                token: $scope.token,\r\n                meetingId: room._id\r\n            };\r\n\r\n        $member.listMember(info, function(result) {\r\n            if (result.status) {\r\n                membersList = result.data.memberList;\r\n            } else {\r\n                $log.error('Error get list member:', result);\r\n            }\r\n\r\n            deffered.resolve(membersList);\r\n        });\r\n\r\n        return deffered.promise;\r\n    }\r\n\r\n    $scope.toggleSidenav = function(eleId) {\r\n        $mdSidenav(eleId).toggle();\r\n    };\r\n\r\n    $scope.showRoomDetail = function(room) {\r\n        $scope.room = room;\r\n\r\n        getMembersOfRoom(room)\r\n        .then(function(membersList) {\r\n            $scope.room.membersList = membersList ? membersList : [];\r\n        });\r\n    };\r\n\r\n    $scope.gotoEditRoom = function() {\r\n        localStorageService.set('roomAdmin', $scope.room);\r\n        $location.path('/admin/rooms/edit');\r\n    };\r\n\r\n    function getRoomsList() {\r\n        var deffered    = $q.defer(),\r\n            roomsList   = null,\r\n            info        = {\r\n                token: $scope.token\r\n            };\r\n\r\n        $meeting.listMeeting(info, function(result) {\r\n            if (result.status) {\r\n                roomsList = result.data.meetingList;\r\n            } else {\r\n                $log.error('Error get rooms list:', result);\r\n            }   \r\n\r\n            deffered.resolve(roomsList);                   \r\n        });\r\n        \r\n        return deffered.promise;\r\n    }\r\n\r\n    getRoomsList()\r\n    .then(function(roomsList) {\r\n        $scope.roomsList = roomsList ? roomsList.reverse() : [];\r\n    });\r\n});\n/**\r\n * @author thanhvk\r\n * created on 30.09.2016\r\n */\r\n 'use strict';\r\n\r\nangular.module('mainModule')\r\n.controller('AdminEditRoomCtrl', function ($meeting, $member, $rootScope, $scope, $q, $location, $log, $mdToast, $mdSidenav, $base64, viMdToast, sharedProperties, localStorageService, _) {\r\n    $scope.token = localStorageService.get('tokenConference');\r\n    $scope.room = localStorageService.get('roomAdmin');\r\n    if ($scope.room.logoutUrl) {\r\n        var base64EncodedString = decodeURIComponent($scope.room.logoutUrl);\r\n        $scope.room.logoutUrl = $base64.decode(base64EncodedString);\r\n    }    \r\n    $scope.member = null;\r\n    $scope.showMemberForm = false;\r\n\r\n    // Functions init\r\n    function getRoomsList() {\r\n        var deffered    = $q.defer(),\r\n            roomsList   = null,\r\n            info        = {\r\n                token: $scope.token\r\n            };\r\n\r\n        $meeting.listMeeting(info, function(result) {\r\n            if (result.status) {\r\n                roomsList = result.data.meetingList;\r\n            } else {\r\n                $log.error('Error get rooms list');\r\n            }   \r\n\r\n            deffered.resolve(roomsList);                   \r\n        });\r\n        \r\n        return deffered.promise;\r\n    }\r\n\r\n    function getMembersOfRoom() {\r\n        var deffered    = $q.defer(),\r\n            membersList = null,\r\n            info        = {\r\n                token: $scope.token,\r\n                meetingId: $scope.room._id\r\n            };\r\n\r\n        $member.listMember(info, function(result) {\r\n            if (result.status) {\r\n                membersList = result.data.memberList;\r\n            } else {\r\n                $log.error('Error get list member');\r\n            }\r\n\r\n            deffered.resolve(membersList);\r\n        });\r\n\r\n        return deffered.promise;\r\n    }\r\n\r\n    getRoomsList()\r\n    .then(function(roomsList) {\r\n        $scope.roomsList = roomsList ? roomsList.reverse() : [];\r\n    })\r\n    .then(function() {\r\n        return getMembersOfRoom();\r\n    })\r\n    .then(function(membersList) {\r\n        $scope.membersList = membersList ? membersList.reverse() : [];\r\n    });\r\n\r\n    // Functions of room\r\n    function updateRoomsList() {\r\n        $scope.roomsList = $scope.roomsList.map(function(room) {\r\n            return (room = (room._id === $scope.room._id) ? $scope.room : room);\r\n        });\r\n    }\r\n\r\n    function updateRoom() {\r\n        var info = {\r\n            token: $scope.token,\r\n            meeting: {\r\n                id: $scope.room._id,\r\n                name: $scope.room.name,\r\n                meetingRef: $scope.room.meetingRef,\r\n                welcome: $scope.room.welcome,\r\n                duration: $scope.room.duration,\r\n                logoutUrl: $scope.room.logoutUrl,\r\n            }\r\n        };\r\n\r\n        if (info.meeting.logoutUrl) {\r\n            var base64EncodedString = $base64.encode(info.meeting.logoutUrl);\r\n            info.meeting.logoutUrl = encodeURIComponent(base64EncodedString);\r\n        }  \r\n\r\n        $meeting.updateMeeting(info, function(result) {\r\n            if (result.status) {\r\n                viMdToast.success('Update room success!');\r\n                updateRoomsList();\r\n                localStorageService.set('roomAdmin', $scope.roomsList[0]);                \r\n            } else {\r\n                viMdToast.error('Update room error!');\r\n            }\r\n        });\r\n    } \r\n\r\n    $scope.cancel = function() {\r\n        $location.path('/admin/rooms');\r\n    };\r\n\r\n    $scope.save = function() {\r\n        updateRoom();\r\n    };   \r\n\r\n    $scope.showRoomDetail = function(room) {\r\n        $scope.showMemberForm = false;\r\n        $scope.room = room;\r\n\r\n        getMembersOfRoom()\r\n        .then(function(membersList) {\r\n            $scope.membersList = membersList ? membersList.reverse() : [];\r\n        });\r\n    };\r\n\r\n    // Functions of member\r\n    function updateMembersList(action, memberId) {\r\n        var memberIdx;\r\n        if (action === 'create' && memberId) {\r\n            $scope.member._id = memberId;\r\n            $scope.membersList.unshift($scope.member);\r\n        } else if (action === 'remove' && memberId) {\r\n            memberIdx = _.findIndex($scope.membersList, {_id: memberId});\r\n            if (memberIdx !== -1) {\r\n                $scope.membersList.splice(memberIdx, 1);\r\n            }\r\n        } else {\r\n            memberIdx = _.findIndex($scope.membersList, {_id: memberId});\r\n            if (memberIdx !== -1) {\r\n                $scope.membersList[memberId] = $scope.member;\r\n            }\r\n        }\r\n    }\r\n\r\n    function addMember() {\r\n        var deffered = $q.defer(),\r\n            info = {\r\n                token: $scope.token,\r\n                meetingId: $scope.room._id,\r\n                member: $scope.member\r\n            };\r\n\r\n        $member.addMember(info, function(result) {\r\n            var member = null;\r\n\r\n            if (result.status && result.data.status) {\r\n                viMdToast.success('Add member success!');\r\n                member = result.data;\r\n            } else {\r\n                viMdToast.error('Add member error!');\r\n            }\r\n\r\n            deffered.resolve(member);\r\n        });\r\n\r\n        return deffered.promise;\r\n    }\r\n\r\n    function updateMember() {\r\n        $scope.member.role = $scope.member.role.toLowerCase();\r\n        var deffered    = $q.defer(),\r\n            member      = null,\r\n            info        = {\r\n                token: $scope.token,\r\n                meetingId: $scope.room._id,\r\n                member: $scope.member\r\n            };\r\n\r\n        $member.updateMember(info, function(result) {\r\n            if (result.status && result.data.status) {\r\n                viMdToast.success('Update member success!');\r\n                member = result.data;\r\n            } else {\r\n                viMdToast.error('Update member error!');\r\n            }\r\n\r\n            deffered.resolve(member);\r\n        });\r\n\r\n        return deffered.promise;\r\n    }\r\n\r\n    $scope.saveMember = function() {\r\n        if ($scope.member && $scope.member._id) {\r\n            updateMember()\r\n            .then(function(result) {\r\n                if (result) {\r\n                    updateMembersList('update', null);\r\n                }\r\n            });\r\n        } else {\r\n            addMember()\r\n            .then(function(result) {\r\n                if (result) {\r\n                    updateMembersList('create', result.id);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    function removeMember() {\r\n        var deffered    = $q.defer(),\r\n            info        = {\r\n                token: $scope.token,\r\n                id: $scope.member._id\r\n            };\r\n\r\n        $member.removeMember(info, function(result) {\r\n            if (result.status) {\r\n                viMdToast.success('Delete member success!');\r\n            } else {\r\n                viMdToast.error('Delete member error!');\r\n            }\r\n            deffered.resolve($scope.member._id);\r\n        });\r\n\r\n        return deffered.promise;\r\n    }\r\n\r\n    $scope.removeMember = function() {\r\n        removeMember()\r\n        .then(function(memberId) {\r\n            $scope.member = null;\r\n            updateMembersList('remove', memberId);\r\n        });\r\n    };\r\n\r\n    $scope.showEditMemberForm = function() {\r\n        $scope.showMemberForm = true;\r\n    };\r\n\r\n    $scope.showAddMemberForm = function() {\r\n        $scope.showMemberForm = true;\r\n        $scope.member = {};\r\n    };\r\n\r\n    $scope.cancelMember = function() {\r\n        $scope.showMemberForm = false;\r\n    };\r\n\r\n    $scope.showMemberDetail = function(member) {\r\n        $scope.showMemberForm = false;\r\n        $scope.member = member;\r\n    };\r\n\r\n    $scope.toggleSidenav = function(eleId) {\r\n        $mdSidenav(eleId).toggle();\r\n    };\r\n});\n/**\r\n * @author thanhvk\r\n * created on 30.09.2016\r\n */\r\n 'use strict';\r\n\r\nangular.module('mainModule')\r\n.controller('AdminCreateRoomCtrl', function ($meeting, $rootScope, $scope, $q, $location, $log, $mdSidenav, $base64, viMdToast, Fullscreen, localStorageService) {\r\n    $scope.token = localStorageService.get('tokenConference');\r\n    $scope.room = {};\r\n\r\n    if (!$scope.token) {\r\n        $location.path('/admin');\r\n    }\r\n\r\n    function createRoom() {\r\n        var info     = {\r\n            token: $scope.token,\r\n            meeting: $scope.room            \r\n        };  \r\n\r\n        if ($scope.room.logoutUrl) {\r\n            var base64EncodedString = $base64.encode($scope.room.logoutUrl);\r\n            info.meeting.logoutUrl = encodeURIComponent(base64EncodedString);\r\n        }              \r\n\r\n        $meeting.createMeeting(info, function(result) {\r\n            if (result.status && result.data.status) {\r\n                viMdToast.success('Create room success!');\r\n                $scope.room._id = result.data.id;\r\n                localStorageService.set('roomAdmin', $scope.room);\r\n                $location.path('/admin/rooms/edit');\r\n            } else {\r\n                viMdToast.error('Create room error!');\r\n            }\r\n        });  \r\n    }\r\n\r\n    $scope.save = function() {\r\n        createRoom();\r\n    };\r\n\r\n    $scope.cancel = function() {\r\n        $location.path('/admin/rooms');\r\n    };\r\n\r\n    function getRoomsList() {\r\n        var deffered    = $q.defer(),\r\n            roomsList   = null,\r\n            info        = {\r\n                token: $scope.token\r\n            };\r\n\r\n        $meeting.listMeeting(info, function(result) {\r\n            if (result.status) {\r\n                roomsList = result.data.meetingList;\r\n            } else {\r\n                $log.error('Error get rooms list:', result);\r\n            }   \r\n\r\n            deffered.resolve(roomsList);                   \r\n        });\r\n        \r\n        return deffered.promise;\r\n    }\r\n\r\n    getRoomsList()\r\n    .then(function(roomsList) {\r\n        $scope.roomsList = roomsList ? roomsList.reverse() : [];\r\n    });\r\n\r\n    $scope.toggleSidenav = function(eleId) {\r\n        $mdSidenav(eleId).toggle();\r\n    };\r\n});\n/**\r\n * @author thanhvk\r\n * created on 28.09.2016\r\n */\r\n 'use strict';\r\n\r\nangular.module('mainModule')\r\n.controller('AdminAuthCtrl', function ($auth, $rootScope, $scope, $q, $location, $mdToast, viMdToast, Fullscreen, localStorageService) {\r\n  $scope.auth = {\r\n    emailLogin: '',\r\n    passwordLogin: ''\r\n  };\r\n\r\n  $scope.loginAccount = function() {\r\n    var info = {};\r\n    info.email = $scope.auth.emailLogin;\r\n    info.password = $scope.auth.passwordLogin;\r\n\r\n    $auth.loginAccount(info, function(result) {\r\n      if (result.status) {\r\n        localStorageService.set('tokenConference', result.data.token);\r\n        $location.path('/admin/rooms');\r\n      } else {\r\n        viMdToast.error('Email or password incorrect!');\r\n      }\r\n    });\r\n  };\r\n\r\n  $scope.loginAccountKeyPress = function(event) {\r\n    if (event.code === 'Enter') {\r\n      $scope.loginAccount();\r\n    }\r\n  };\r\n});\r\n\n'use strict';\r\nangular.module('app', [\r\n    // third-party module\r\n    'ngAnimate', 'ngCookies', 'ngSanitize', 'ngMessages', 'ngAria', 'ngRoute', 'ngLocale',\r\n    'toastr', 'pascalprecht.translate', 'ui.bootstrap', 'ui.router', 'underscore','FBAngular',\r\n    'ui.bootstrap.datetimepicker','pageslide-directive',   'angular-simple-chat','ngAudio',\r\n    'LocalStorageModule', 'ngFileUpload', 'ui.select','ngFileSaver','base64','textAngular','ng.deviceDetector', \r\n    'timer', 'ngMaterial', 'ngMessages', 'pascalprecht.translate','ngActivityIndicator', 'pdf', \r\n    \r\n    // application module\r\n    'config', 'api',  'mainModule', 'adminModule', 'conferenceModule', 'trainingModule'\r\n]);\r\n\r\n\n/**\r\n * @author thanhvk\r\n * created on 08.10.2016\r\n */\r\n 'use strict';\r\n\r\nangular.module('app')\r\n    .directive('showBandwidth', ['$http', '$q', '$location', '$timeout', function($http, $q, $location, $timeout) {\r\n        return {\r\n            restrict: 'E',\r\n            templateUrl: 'app/shared/directives/showBandwidth/showBandwidthView.html',\r\n            link: function($scope) {\r\n                // var imageUrl = \"https://localhost:3000/assets/images/hybrid.jpg\"; \r\n                var imageUrl = $location.protocol() + '://' + $location.host() + ':' + $location.port() + '/assets/images/hybrid.jpg';\r\n                var downloadSize = 23670; //bytes\r\n                var speedDownMbpsArr = [];\r\n                var measureDownloadSpeedArr = [];\r\n\r\n                function measureDownloadSpeed() {\r\n                    var deferred = $q.defer(),\r\n                        startTime, \r\n                        endTime;\r\n                    startTime = (new Date()).getTime();\r\n\r\n                    $http({\r\n                        method: 'GET',\r\n                        url: imageUrl\r\n                    }).then(function successCallback(response) {\r\n                        endTime = (new Date()).getTime();\r\n                        var duration = (endTime - startTime) / 1000;\r\n                        var bitsLoaded = downloadSize * 8;\r\n                        var speedDownBps = (bitsLoaded / duration).toFixed(2);\r\n                        var speedDownKbps = (speedDownBps / 1024).toFixed(2);\r\n                        var speedDownMbps = (speedDownKbps / 1024).toFixed(2);\r\n\r\n                        $timeout(function() {\r\n                            if ($scope.speedDownMbps === 0) {\r\n                                $scope.speedDownMbpsOri = Number(speedDownMbps);\r\n                                $scope.speedDownMbps = $scope.speedDownMbpsOri * 3;\r\n                            } else {\r\n                                speedDownMbps = ($scope.speedDownMbpsOri + Number(speedDownMbps)) / 2;\r\n                                $scope.speedDownMbpsOri = Number(speedDownMbps.toFixed(2));\r\n                                $scope.speedDownMbps = $scope.speedDownMbpsOri * 3;\r\n                            }\r\n\r\n                            deferred.resolve();\r\n                        }, 60);                        \r\n                    }, function errorCallback(response) {\r\n                        deferred.resolve(null);\r\n                    });\r\n\r\n                    return deferred.promise;\r\n                };\r\n\r\n                $scope.measureDownloadSpeedAverage = function() {\r\n                    $scope.speedDownMbpsOri = 0;\r\n                    $scope.speedDownMbps = 0;\r\n\r\n                    for (var i = 0; i < 100; i++) {\r\n                        measureDownloadSpeedArr.push(measureDownloadSpeed);\r\n                    }\r\n\r\n                    measureDownloadSpeedArr.reduce(function(previousValue, currentValue) {\r\n                        return previousValue.then(function() {\r\n                            return currentValue();\r\n                        });\r\n                    }, $q.resolve());\r\n                    // .then(function() {\r\n                    //     var totalSpeed = 0;\r\n                    //     speedDownMbpsArr.map(function(speed) {\r\n                    //         totalSpeed += Number(speed);\r\n                    //     });\r\n\r\n                    //     $scope.speedDownMbps = (totalSpeed / speedDownMbpsArr.length).toFixed(2);\r\n                    //     speedDownMbpsArr = [];\r\n                    //     measureDownloadSpeedArr = [];\r\n                    // });\r\n                };\r\n\r\n                $scope.measureDownloadSpeedAverage();\r\n            }\r\n        };\r\n    }]); \n'use strict';\r\nangular.module('api',['config','blockUI']);\r\n\n\"use strict\";\r\nangular.module('api').factory('$member', function(http)\r\n{\r\n    return {\r\n       \r\n        addMember: function(info, callback)\r\n        {\r\n            var path = \"/member\";\r\n            var param = {\r\n                token: info.token,\r\n                meetingId: info.meetingId,\r\n                member: angular.toJson(info.member)\r\n            };\r\n            http.postRequest(path, param, callback);\r\n        },\r\n        updateMember: function(info, callback)\r\n        {\r\n            var path = \"/member\";\r\n            var param = {\r\n                token: info.token,\r\n                meetingId: info.meetingId,\r\n                member: angular.toJson(info.member)\r\n            };\r\n            http.putRequest(path, param, callback);\r\n        },\r\n        removeMember: function(info, callback)\r\n        {\r\n            var path = \"/member\";\r\n            var param = {\r\n                token: info.token,\r\n                id: info.id\r\n            };\r\n            http.deleteRequest(path, param, callback);\r\n        },\r\n        listMember: function(info, callback)\r\n        {\r\n            var path = \"/member\";\r\n            var param = {\r\n                token: info.token,\r\n                meetingId: info.meetingId\r\n            };\r\n            http.getRequest(path, param, callback);\r\n        },\r\n        login: function(info, callback)\r\n        {\r\n            var path = \"/member/login\";\r\n            var param = {\r\n                meetingId: info.meetingId,\r\n                email: info.email,\r\n                password: info.password\r\n            };\r\n            http.postRequest(path, param, callback);\r\n        },\r\n        trustedLogin: function(info, callback)\r\n        {\r\n            var path = \"/trusted/login\";\r\n            var param = {\r\n                payload: info.payload,\r\n                checksum: info.checksum\r\n            };\r\n            http.postRequest(path, param, callback);\r\n        }\r\n    };\r\n});\n\"use strict\";\r\nangular.module('api').factory('$meeting', function(http)\r\n{\r\n    return {\r\n        createMeeting: function(info, callback)\r\n        {\r\n            var path = \"/meeting\";\r\n            var param = {\r\n                token: info.token,\r\n                meeting: angular.toJson(info.meeting)\r\n            };\r\n            http.postRequest(path, param, callback);\r\n        },\r\n        updateMeeting: function(info, callback)\r\n        {\r\n            var path = \"/meeting\";\r\n            var param = {\r\n                token: info.token,\r\n                meeting: angular.toJson(info.meeting)\r\n            };\r\n            http.putRequest(path, param, callback);\r\n        },\r\n        endMeeting: function(info, callback)\r\n        {\r\n            var path = \"/meeting/end\";\r\n            var param = {\r\n                token: info.token,\r\n                id: info.meetingId\r\n            };\r\n            http.postRequest(path, param, callback);\r\n        },\r\n        listMeeting: function(info, callback)\r\n        {\r\n            var path = \"/meeting/\";\r\n            var param = {\r\n                token: info.token\r\n            };\r\n            http.getRequest(path, param, callback);\r\n        },\r\n        getMeeting: function(info, callback)\r\n        {\r\n            var path = \"/meeting/\";\r\n            var param = {\r\n                token: info.token,\r\n                id: info.meetingId\r\n            };\r\n            http.getRequest(path, param, callback);\r\n        },\r\n        setMeetingConfig: function(info, callback)\r\n        {\r\n            var path = \"/meeting/config\";\r\n            var param = {\r\n                token: info.token,\r\n                config: info.config\r\n            };\r\n            http.putRequest(path, param, callback);\r\n        },\r\n        getMeetingConfig: function(info, callback)\r\n        {\r\n            var path = \"/meeting/config\";\r\n            var param = {\r\n                token: info.token\r\n            };\r\n            http.getRequest(path, param, callback);\r\n        },\r\n        uploadFile: function(info, callback)\r\n        {\r\n            var path = \"/meeting/upload\";\r\n            var file = info.file;\r\n            http.uploadRequest(path, file, callback);\r\n        },\r\n    };\r\n});\n\"use strict\";\r\nangular.module('api').factory('$auth', function(http)\r\n{\r\n    return {\r\n        loginAccount: function(info, callback)\r\n        {\r\n            var path = \"/auth/local\";\r\n            var param = {\r\n                email: info.email,\r\n                password: info.password\r\n            };\r\n            http.postRequest(path, param, callback);\r\n        }          \r\n    };\r\n});\n'use strict';\r\nangular.module('api').factory('$socket', function($log, socketUrl)\r\n{\r\n    try {\r\n        var ws = new WebSocket(socketUrl);\r\n        return ws;\r\n    } catch (exc) {\r\n        $log.error('Cannot connect to server');\r\n        return null;\r\n    }\r\n});\n'use strict';\r\nangular.module('api').factory('http', function($http, apiUrl, blockUI, $log)\r\n{\r\n    var transform = function(data){\r\n        var str = [];\r\n        \r\n        for(var p in data) {\r\n            str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(data[p]));\r\n        }\r\n        \r\n        return str.join(\"&\");        \r\n    };\r\n\r\n    return {\r\n        postRequest: function(path, param, callback)\r\n        {\r\n            var url = apiUrl + path;\r\n            var req = {\r\n                method: 'POST',\r\n                url: url,\r\n                headers:\r\n                {\r\n                    'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8'\r\n                },\r\n                transformRequest: transform,\r\n                timeout: 300000,\r\n                data: param\r\n            };\r\n            blockUI.start();\r\n            $log.info('POST request: ' + req.data);\r\n            $http(req).then(function(data)\r\n            {\r\n                if (data.status === 200)\r\n                {\r\n                    blockUI.stop();\r\n                    if (typeof(data.data.result) ===\r\n                        \"boolean\" && !data.data.result)\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: false\r\n                        });\r\n                    }\r\n                    else\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: true,\r\n                            data: data.data\r\n                        });\r\n                    }\r\n                }\r\n            }, function(error)\r\n            {\r\n                blockUI.stop();\r\n                $log.error(error);\r\n                callback(\r\n                {\r\n                    status: false\r\n                });\r\n            });\r\n        },\r\n        getRequest: function(path, param, callback)\r\n        {\r\n            var url = apiUrl + path;\r\n            var req = {\r\n                method: 'GET',\r\n                url: url,\r\n                headers:\r\n                {\r\n                    'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8'\r\n                },\r\n                transformRequest: transform,\r\n                params: param\r\n            };\r\n            blockUI.start();\r\n            $log.info('GET request: ' + req.params);\r\n            $http(req).then(function(data)\r\n            {\r\n                blockUI.stop();\r\n                if (data.status === 200)\r\n                {\r\n                    if (typeof(data.data.result) ===\r\n                        \"boolean\" && !data.data.result)\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: false\r\n                        });\r\n                    }\r\n                    else\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: true,\r\n                            data: data.data\r\n                        });\r\n                    }\r\n                }\r\n            }, function(error)\r\n            {\r\n                blockUI.stop();\r\n                $log.error(error);\r\n                callback(\r\n                {\r\n                    status: false\r\n                });\r\n            });\r\n        },\r\n        putRequest: function(path, param, callback)\r\n        {\r\n            var url = apiUrl + path;\r\n            var req = {\r\n                method: 'PUT',\r\n                url: url,\r\n                headers:\r\n                {\r\n                    'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8'\r\n                },\r\n                transformRequest: transform,\r\n                data: param\r\n            };\r\n            $log.info('PUT request: ' + req.params);\r\n            blockUI.start();\r\n            $http(req).then(function(data)\r\n            {\r\n                blockUI.stop();\r\n                if (data.status === 200)\r\n                {\r\n                    if (typeof(data.data.result) ===\r\n                        \"boolean\" && !data.data.result)\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: false\r\n                        });\r\n                    }\r\n                    else\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: true,\r\n                            data: data.data\r\n                        });\r\n                    }\r\n                }\r\n            }, function(error)\r\n            {\r\n                blockUI.stop();\r\n                $log.error(error);\r\n                callback(\r\n                {\r\n                    status: false\r\n                });\r\n            });\r\n        },\r\n        deleteRequest: function(path, param, callback)\r\n        {\r\n            var url = apiUrl + path;\r\n            var req = {\r\n                method: 'DELETE',\r\n                url: url,\r\n                headers:\r\n                {\r\n                    'Content-Type': 'application/x-www-form-urlencoded; charset=utf-8'\r\n                },\r\n                transformRequest: transform,\r\n                data: param\r\n            };\r\n            $log.info('DELETE request: ' + req.data);\r\n            blockUI.start();\r\n            $http(req).then(function(data)\r\n            {\r\n                if (data.status === 200)\r\n                {\r\n                    blockUI.stop();\r\n                    if (typeof(data.data.result) ===\r\n                        \"boolean\" && !data.data.result)\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: false\r\n                        });\r\n                    }\r\n                    else\r\n                    {\r\n                        callback(\r\n                        {\r\n                            status: true,\r\n                            data: data.data\r\n                        });\r\n                    }\r\n                }\r\n            }, function(error)\r\n            {\r\n                blockUI.stop();\r\n                $log.error(error);\r\n                callback(\r\n                {\r\n                    status: false\r\n                });\r\n            });\r\n        },\r\n        uploadRequest: function(path, file, callback)\r\n        {\r\n            var url = apiUrl + path;\r\n            var xhr = new XMLHttpRequest();\r\n            var fd = new FormData();\r\n            xhr.open(\"POST\", url, true);\r\n            blockUI.start();\r\n            $log.info('UPLOAD request: ' + path);\r\n            xhr.onreadystatechange = function()\r\n            {\r\n                if (xhr.readyState === 4 && xhr.status === 200)\r\n                {\r\n                    blockUI.stop();\r\n                    callback(\r\n                    {\r\n                        status: true,\r\n                        data: angular.fromJson(xhr.responseText)\r\n                    });\r\n                    \r\n                }\r\n            };\r\n            fd.append('file', file);\r\n            xhr.send(fd);\r\n        }\r\n    };\r\n});\n'use strict';\r\n\r\nangular.module('trainingModule',['api','toastr','config','underscore','LocalStorageModule','pageslide-directive','base64',\r\n                                   'angular-simple-chat','ngAudio','ngActivityIndicator']);\n'use strict';\r\nangular.module('trainingModule').controller('TrainingRoomController', function($scope, $rootScope, $location, $routeParams, _,\r\n    localStorageService, $log, $interval, $sce, $socket, $window, deviceDetector, iceServers, $recorder,\r\n    $mdSidenav, $base64, $timeout, ngAudio, $activityIndicator, toastr, $route, pdfDelegate,$meeting) {\r\n    // publication\r\n    var PUB_INITIAL = 0;\r\n    var PUB_INPROGRESS = 1;\r\n    var PUB_CONNECTING = 2;\r\n    var PUB_CONNECTED = 3;\r\n    \r\n    // subscription\r\n    var SUB_INITIAL = 0;\r\n    var SUB_INPROGRESS = 1;\r\n    var SUB_CONNECTING = 2;\r\n    var SUB_CONNECTED = 3;\r\n    \r\n    var GATHER_TIMEOUT = 20*1000;\r\n    var CALLING_TIMEOUT = 20*1000;\r\n    \r\n    function RoomMember(id,profile)\r\n    {\r\n        this.id = id;\r\n        this.avail = false;\r\n        this.profile = profile;\r\n        this.invited = false;\r\n        this.pubWebRtcEndpoint = null;\r\n        this.pubOfferSdp = null;\r\n        this.pubState = PUB_INITIAL;\r\n        this.pubGatherToken = null;\r\n        this.pubTimeoutToken = null;\r\n        this.pubCandidateSendQueue =  [];\r\n        this.subWebRtcEndpoint = null;\r\n        this.subOfferSdp = null;\r\n        this.subState = SUB_INITIAL;\r\n        this.subGatherToken = null;\r\n        this.subCandidateSendQueue =  [];\r\n        this.pubCamera = null;        \r\n        this.subVideoSlot = null;\r\n        this.markedForSubscription = false;\r\n    }\r\n\r\n    function init() {\r\n        $scope.audio = true;\r\n        $scope.video = true;\r\n        $scope.handUp = true;\r\n        $scope.notiHandUp = true;\r\n        $scope.toggleVideoFlag = false;\r\n        $scope.sound = ngAudio.load(\"assets/sounds/ring.mp3\")\r\n        // $scope.pdfUrl = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/149125/material-design-2.pdf';\r\n        $scope.pdfUrl = 'assets/images/Intro.pdf';\r\n        $scope.zoom = 90;\r\n        $scope.countAllocated = 0;\r\n        \r\n        $scope.meeting = localStorageService.get(\"meeting\");\r\n        $scope.myProfile = localStorageService.get(\"member\");\r\n        $scope.memberProfiles = localStorageService.get(\"memberList\");\r\n        $scope.memberList = [];\r\n        $scope.videoSlots = [];\r\n        $scope.chatMessage = [];\r\n        var count = 0;\r\n        _.each($scope.memberProfiles,function(profile) {\r\n            $scope.memberList.push(new RoomMember(profile._id,profile));\r\n            $scope.videoSlots.push({\r\n                allocated: false,\r\n                videoId: 'remoteCamera' + count,\r\n                index: count,\r\n                member:null\r\n            });\r\n            count++;\r\n        });        \r\n        $scope.me = _.find($scope.memberList, function(m) {\r\n            return m.id == $scope.myProfile._id;\r\n        });\r\n        $scope.me.pubCamera = document.getElementById('localCamera');\r\n        $scope.presenter = _.find($scope.memberList, function(m) {\r\n            return m.profile.role == 'presenter';\r\n        });\r\n        $scope.presenter.subVideoSlot = $scope.videoSlots[0]; \r\n        $scope.viewerList = _.filter($scope.memberList, function(m) {\r\n            return m.profile.role != 'presenter';\r\n        });   \r\n    };\r\n    \r\n    $scope.connect = function() {\r\n        if ($socket.readyState == 1)  {\r\n            // $scope.connect = true;\r\n            sendMessage({ id: 'join'});\r\n            $scope.sound.loop = true;\r\n            $scope.sound.play();\r\n            $scope.me.pubState = PUB_INPROGRESS;\r\n        } else {\r\n            $window.location.reload();\r\n        }\r\n    }\r\n    \r\n    $scope.disconnect = function() {\r\n        // $scope.disconnect = false;\r\n        $scope.me.pubState = PUB_INITIAL;\r\n        $scope.sound.stop();\r\n        try {\r\n            if ($scope.me.pubWebRtcEndpoint)\r\n                $scope.me.pubWebRtcEndpoint['peerConnection'].close();\r\n            _.each($scope.memberList ,function(member) {\r\n                if (member.subState != SUB_INITIAL)\r\n                    unsubscribe(member);\r\n            });\r\n            sendMessage({\r\n                id: 'leave'\r\n            });\r\n        } catch (e) {\r\n            $log.error(e);\r\n        }\r\n    }\r\n    \r\n    $socket.onmessage = function(message) {\r\n        var parsedMessage = JSON.parse(message.data);\r\n        console.info('Received message: ' + message.data);\r\n        switch (parsedMessage.id) {\r\n            case 'joinResponse':                \r\n                joinResponse(parsedMessage);\r\n                break;\r\n            case 'end':             \r\n                endConference();\r\n                break;\r\n            case 'memberStatus':\r\n                memberStatus(parsedMessage);\r\n                break;\r\n            case 'handUp':\r\n                handUp(parsedMessage);\r\n                break;\r\n            case 'handDown':\r\n                handDown(parsedMessage);\r\n                break;\r\n            case 'publishResponse':\r\n                publishResponse(parsedMessage);\r\n                break;\r\n            case 'subscribeResponse':\r\n                subscribeResponse(parsedMessage);\r\n                break;\r\n            case 'chat':\r\n                receiveChat(parsedMessage);\r\n                break;\r\n            case 'whiteboard':\r\n                receiveWhiteboardEvent(parsedMessage.event,parsedMessage.object);\r\n                break;\r\n            default:\r\n                console.error('Unrecognized message', parsedMessage);\r\n            }\r\n        $scope.$apply();\r\n    };\r\n        \r\n    function sendMessage(message) {\r\n        message.memberId = $scope.me.id;\r\n        message.meetingId = $scope.meeting._id;\r\n        var jsonMessage = JSON.stringify(message);\r\n        $log.info('Senging message: ' + jsonMessage);\r\n        try {\r\n            $socket.send(jsonMessage);\r\n        } catch (exc) {\r\n            $log.info('Error sending message: ' );\r\n            $window.location.reload();\r\n        }\r\n    };\r\n     \r\n    function joinResponse(message) {\r\n        if (message.response == 'accepted') {\r\n            publish();\r\n            receiveWhiteboard(message.whiteboard);\r\n        } else {\r\n            $location.path('/');\r\n        }\r\n    };\r\n\r\n    function publish() {  \r\n        var options = {\r\n            localVideo: localCamera,\r\n            onicecandidate: onPublishIceCandidate,\r\n            iceServers:iceServers,\r\n            oncandidategatheringdone: onPublishComplete\r\n        };\r\n        $scope.me.pubWebRtcEndpoint = kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(options, function(error) {\r\n            if (error) {\r\n                $activityIndicator.stopAnimating();\r\n                $log.error(error);\r\n                return;\r\n            }\r\n            this.generateOffer(onPublish);\r\n        });\r\n        $activityIndicator.startAnimating();\r\n        $scope.me.pubGatherToken = $timeout(function() {\r\n            if ($scope.me.pubState != PUB_CONNECTING) {\r\n                $scope.me.pubState = PUB_CONNECTING;\r\n                sendPublishData();\r\n            }\r\n        },GATHER_TIMEOUT);\r\n    }\r\n\r\n    function onPublishIceCandidate(candidate) {\r\n        $scope.me.pubCandidateSendQueue.push(candidate);\r\n    }\r\n\r\n    function onPublish(error, offerSdp) {\r\n        if (error) {\r\n            $activityIndicator.stopAnimating();\r\n            $log.info(error);\r\n            return;\r\n        }\r\n        $scope.me.pubOfferSdp = offerSdp;\r\n    }\r\n\r\n    function publishResponse(message) {\r\n        $activityIndicator.stopAnimating();\r\n        if (message.response != 'accepted') {\r\n            $log.info('Disconnect due to reject from server');\r\n            $scope.disconnect();\r\n        } else {\r\n            $scope.me.pubWebRtcEndpoint.processAnswer(message.sdpAnswer);\r\n            _.each(message.candidateList,function(candidate) {\r\n                $scope.me.pubWebRtcEndpoint.addIceCandidate(candidate);\r\n            })\r\n            sendMessage({\r\n                id: 'publishAvail'\r\n            });\r\n            $scope.me.pubState = PUB_CONNECTED;\r\n            $scope.sound.stop();\r\n        }\r\n    }\r\n    \r\n    function onPublishComplete() {\r\n        $timeout.cancel($scope.me.pubGatherToken);\r\n        if ($scope.me.pubState != PUB_CONNECTING) {\r\n            $scope.me.pubState = PUB_CONNECTING;\r\n            sendPublishData();\r\n        }\r\n    }\r\n    \r\n    function sendPublishData() {\r\n        if (!$scope.me.pubOfferSdp || !$scope.me.pubCandidateSendQueue.length) {\r\n            $log.info('Disconnect due to device error');\r\n            $scope.disconnect();\r\n            return;\r\n        }\r\n        var message = {\r\n                id: 'publish',\r\n                sdpOffer: $scope.me.pubOfferSdp,\r\n                candidateList: $scope.me.pubCandidateSendQueue\r\n         };\r\n        sendMessage(message);\r\n        $scope.me.pubOfferSdp = null;\r\n        $scope.me.pubCandidateSendQueue = [];\r\n        $scope.me.pubTimeoutToken = $timeout(function() {\r\n            if ($scope.me.pubState != PUB_CONNECTED) {\r\n                $log.info('Disconnect due to calling timeout');\r\n                $scope.disconnect();\r\n            }\r\n        },CALLING_TIMEOUT);\r\n    }\r\n    \r\n    $scope.resubscribe = function(pubId) {\r\n        var publisher = _.find($scope.memberList, function(m) {\r\n            return m.id == pubId;\r\n        });\r\n        if (publisher.invited && publisher.avail) {\r\n            unsubscribe(publisher);\r\n            subscribe(publisher);\r\n        }\r\n    }\r\n\r\n    function unsubscribe(member) {\r\n        member.markedForSubscription =  false;\r\n        if (member.subVideoSlot) {            \r\n            member.subState = SUB_INITIAL;\r\n            if (member.id!= $scope.presenter.id) {\r\n                if (member.subVideoSlot.allocated) {\r\n                    $scope.countAllocated--;\r\n                }                \r\n                member.subVideoSlot.allocated = false;\r\n                member.subVideoSlot.member = null;\r\n                member.subVideoSlot = null;    \r\n            }            \r\n            if (member.subGatherToken)\r\n                $timeout.cancel(member.subGatherToken);\r\n            try {\r\n                if (member.subWebRtcEndpoint)\r\n                    member.subWebRtcEndpoint['peerConnection'].close();\r\n            } catch (e) {\r\n                $log.error(e);\r\n            }\r\n        }\r\n    }\r\n\r\n    function subscribe(member) {        \r\n        if (!$scope.me.avail) {\r\n            return;\r\n        }\r\n        var slot = null;\r\n        if (member.subVideoSlot) {\r\n            slot = member.subVideoSlot;\r\n        } else {\r\n            slot = _.find($scope.videoSlots, function(s) {\r\n                return !s.allocated  && s.index > 0;\r\n            });\r\n        }\r\n        if (!slot) return;\r\n        if (member.id !== $scope.presenter.id) {\r\n            $scope.countAllocated++;\r\n        }\r\n        member.subVideoSlot = slot;\r\n        slot.member = member;\r\n        slot.allocated = true;\r\n        member.subState = SUB_INPROGRESS;\r\n        var remoteCamera = document.getElementById(slot.videoId);\r\n        var options = {\r\n            remoteVideo: remoteCamera,\r\n            onicecandidate: onSubscribeIceCandidate.bind({member:member }),\r\n            iceServers: iceServers,\r\n            oncandidategatheringdone: onSubscribeComplete.bind({member:member})\r\n        }\r\n        member.subGatherToken = $timeout(function(m) {\r\n            if (m.subState != SUB_CONNECTING) {\r\n                sendSubscribeData(m);\r\n                m.subState = SUB_CONNECTING;\r\n            }\r\n        },GATHER_TIMEOUT,true,member);\r\n        \r\n        member.subWebRtcEndpoint = kurentoUtils.WebRtcPeer.WebRtcPeerRecvonly(options, function(error) {\r\n            if (error) {\r\n                $log.error(error);\r\n                return;\r\n            }\r\n            this.generateOffer(onSubscribe.bind({\r\n                member: member\r\n            }));\r\n        });\r\n    }\r\n\r\n    function onSubscribeIceCandidate(candidate) {\r\n        this.member.subCandidateSendQueue.push(candidate);\r\n    }\r\n\r\n    function onSubscribe(error, offerSdp) {\r\n        if (error) {\r\n            $log.error(error);\r\n            return;\r\n        }\r\n        this.member.subSdpOffer = offerSdp;\r\n    }\r\n\r\n    function subscribeResponse(message) {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == message.pubId;\r\n        });\r\n        if (message.response != 'accepted') {\r\n            member.subState = SUB_INITIAL;\r\n            toastr.error('Server error, please try again later');\r\n        } \r\n        else {            \r\n            member.subWebRtcEndpoint.processAnswer(message.sdpAnswer);\r\n            if (member.id == $scope.me.id) {\r\n                member.subWebRtcEndpoint.remoteVideo.muted = true;\r\n            }\r\n            if (member.subVideoSlot) {\r\n                member.subState = SUB_CONNECTED;\r\n                _.each(message.candidateList,function(candidate) {\r\n                    member.subWebRtcEndpoint.addIceCandidate(candidate);\r\n                });\r\n                sendMessage({\r\n                    id: 'subscribeAvail',\r\n                    pubId:message.pubId\r\n                });\r\n            }\r\n            nextSubscriber();\r\n        }\r\n    }\r\n    \r\n    function onSubscribeComplete() {\r\n        $timeout.cancel(this.member.subGatherToken);\r\n        if (this.member.subState != SUB_CONNECTING) {\r\n            sendSubscribeData(this.member);\r\n            this.member.subState = SUB_CONNECTING;\r\n        }\r\n        \r\n    }\r\n    \r\n    function sendSubscribeData(member) {\r\n        if (!member.subSdpOffer || !member.subCandidateSendQueue.length) {\r\n            toastr.error(\"Device error\");\r\n            return;\r\n        }\r\n        var message = {\r\n                id: 'subscribe',\r\n                pubId: member.id,\r\n                sdpOffer: member.subSdpOffer,\r\n                candidateList:member.subCandidateSendQueue\r\n            }\r\n        sendMessage(message);\r\n        member.subSdpOffer = null;\r\n        member.subCandidateSendQueue = [];\r\n    }\r\n\r\n    function endConference(message) {\r\n        var url = '/';\r\n        \r\n        if ($scope.meeting.logoutUrl) {\r\n            var base64EncodedString = decodeURIComponent($scope.meeting.logoutUrl);\r\n            url = $base64.decode(base64EncodedString);\r\n        }\r\n        \r\n        $window.location.href = url;\r\n    };\r\n\r\n    function memberStatus(message) {\r\n        updateMemberList(message.onlineList);\r\n    };\r\n    \r\n    function nextSubscriber() {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.markedForSubscription;\r\n        });\r\n        if (member) {\r\n            member.markedForSubscription =  false;\r\n            subscribe(member);\r\n        }\r\n    }\r\n\r\n    function updateMemberList(onlineList) {\r\n        var unSubList = [];\r\n        _.each($scope.memberList, function(curVal) {\r\n            var newVal = _.find(onlineList, function(m) {\r\n                return curVal.id == m._id;\r\n            });\r\n            if (newVal) {\r\n                curVal.avail = newVal.avail;\r\n                curVal.invited = newVal.invited;\r\n                curVal.online = true;\r\n                if (curVal.invited) {\r\n                    if (curVal.avail) {\r\n                        if (!curVal.subVideoSlot)\r\n                            curVal.markedForSubscription =  true;\r\n                        if (curVal.subVideoSlot && curVal.subState==SUB_INITIAL)\r\n                            curVal.markedForSubscription =  true;\r\n                    } else {\r\n                        if (curVal.subVideoSlot )\r\n                            unSubList.push(curVal);\r\n                    }\r\n                } else {\r\n                    unSubList.push(curVal);\r\n                }\r\n            } else {\r\n                if (curVal.invited) \r\n                    unSubList.push(curVal);\r\n                curVal.invited = false;\r\n                curVal.avail = false;\r\n                curVal.online = false;\r\n            }\r\n        });        \r\n        _.each(unSubList, function(member) {\r\n            unsubscribe(member);\r\n        });\r\n        nextSubscriber();\r\n    }\r\n    $scope.leave = function() {\r\n        var url = '/';\r\n        \r\n        if ($scope.meeting.logoutUrl) {\r\n            var base64EncodedString = decodeURIComponent($scope.meeting.logoutUrl);\r\n            url = $base64.decode(base64EncodedString);\r\n        }\r\n\r\n        sendMessage({\r\n            id: 'leave'\r\n        });\r\n\r\n        $window.location.href = url;        \r\n    }\r\n    $scope.endLesson = function() {\r\n        sendMessage({\r\n            id: 'end'\r\n        });\r\n    }\r\n    $scope.toggleAudio = function() {\r\n        var localStream = $scope.me.pubWebRtcEndpoint.getLocalStream();\r\n        if (localStream) {\r\n            var audioTrack = localStream.getAudioTracks()[0];\r\n            $scope.audio = !$scope.audio;\r\n            audioTrack.enabled = $scope.audio;\r\n        }\r\n    };\r\n    $scope.toggleVideo = function() {\r\n        var localStream = $scope.me.pubWebRtcEndpoint.getLocalStream();\r\n        if (localStream) {\r\n            var videoTrack = localStream.getVideoTracks()[0];\r\n            $scope.video = !$scope.video;\r\n            videoTrack.enabled = $scope.video;\r\n        }\r\n    };\r\n    $scope.toggleHand = function() {\r\n        $scope.handUp = !$scope.handUp;\r\n        $scope.notiHandUp = false;\r\n        if (!$scope.handUp) {\r\n            sendMessage({id: 'handUp'});\r\n        } else {\r\n            sendMessage({id: 'handDown'});\r\n        }\r\n    };\r\n    $scope.toggleSidenav = function(eleId) {\r\n        $mdSidenav(eleId).toggle();\r\n    };\r\n    $scope.toggleMainVideo = function() {\r\n        $scope.toggleVideoFlag = !$scope.toggleVideoFlag;\r\n    }\r\n    $scope.memberInvite = function(memberId) {\r\n        if ($scope.countAllocated > 3) {\r\n            return;\r\n        }\r\n        $scope.notiHandUp = true;\r\n\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == memberId;\r\n        });\r\n        member.handUp = false;\r\n\r\n        if (!member.invited && member.online) {\r\n            sendMessage({\r\n                id: 'invite',\r\n                'inviteeId': member.id\r\n            });\r\n        }\r\n    }\r\n    $scope.memberDiscard = function(slot) {\r\n        var member = slot.member;\r\n        if (member) {\r\n            $scope.countAllocated--;\r\n            member.handUp = false;\r\n            sendMessage({\r\n                id: 'discard',\r\n                'inviteeId': member.id\r\n            });\r\n        }\r\n    }\r\n    var handUp = function(message) {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == message.memberId;\r\n        });\r\n        member.handUp = true;\r\n    }\r\n    var handDown = function(message) {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == message.memberId;\r\n        });\r\n        member.handUp = false;\r\n    }\r\n    $scope.chat = function() {\r\n        var message = {\r\n            id: 'chat',\r\n            text: $scope.chatInput\r\n        }\r\n        sendMessage(message);\r\n        $scope.chatInput = \"\";\r\n    }\r\n\r\n    $scope.sendChatMessage = function($event) {\r\n        if (event.code === 'Enter') {\r\n            $scope.chat();\r\n        }\r\n    };\r\n\r\n    function receiveChat(message) {\r\n        $scope.chatMessage.push({\r\n            'user': message.user,\r\n            'text': message.text\r\n        });\r\n    }\r\n    $scope.byIndex = function(slot) {\r\n        return slot.index > 0;\r\n    };\r\n\r\n    $rootScope.$on('$routeChangeStart', function(event, next, current) {\r\n        if (!current) {\r\n            $socket.close();\r\n        }\r\n    });\r\n    $window.onbeforeunload = function() {\r\n        $socket.close();\r\n        $interval.cancel(recordToken);\r\n    };\r\n\r\n    init();\r\n    \r\n    function receiveWhiteboard(whiteboard) {\r\n        _.each(whiteboard,function(msg){\r\n            onWhiteboardEvent(msg.event,msg.object);\r\n            getPageInfo();\r\n        }) ;\r\n        \r\n    }\r\n    function receiveWhiteboardEvent(event,object) {\r\n        onWhiteboardEvent(event,object);\r\n        getPageInfo();\r\n    }\r\n    \r\n    function onWhiteboardEvent(event,object) {\r\n        if (event=='insertSlide') {\r\n            // $scope.pdfUrl = object;\r\n            pdfDelegate\r\n                    .$getByHandle('my-pdf-container')\r\n                    .load(object);\r\n        }\r\n        if (event=='nextSlidePage') {\r\n            pdfDelegate.$getByHandle('my-pdf-container').next();\r\n        }\r\n        if (event=='prevSlidePage') {\r\n            pdfDelegate.$getByHandle('my-pdf-container').next();\r\n        }\r\n        if (event=='zoomOutSlide') {\r\n            pdfDelegate.$getByHandle('my-pdf-container').zoomOut();\r\n        }\r\n        if (event=='zoomInSlide') {\r\n            pdfDelegate.$getByHandle('my-pdf-container').zoomIn();\r\n        }\r\n    }\r\n\r\n    // Pdf viewer\r\n    function getPageInfo() {\r\n        $scope.currPage = pdfDelegate.$getByHandle('my-pdf-container').getCurrentPage();\r\n        $scope.totalPages = pdfDelegate.$getByHandle('my-pdf-container').getPageCount();\r\n    }\r\n\r\n    $scope.pdfNext = function() {\r\n        pdfDelegate.$getByHandle('my-pdf-container').next();\r\n        getPageInfo();\r\n        sendMessage({id:'whiteboard',event:'nextSlidePage',object:null});\r\n    }\r\n\r\n    $scope.pdfPrev = function() {\r\n        pdfDelegate.$getByHandle('my-pdf-container').prev();\r\n        getPageInfo();\r\n        sendMessage({id:'whiteboard',event:'prevSlidePage',object:null});\r\n    }\r\n\r\n    $scope.zoomOut = function() {\r\n        pdfDelegate.$getByHandle('my-pdf-container').zoomOut();\r\n        sendMessage({id:'whiteboard',event:'zoomOutSlide',object:null});\r\n        $scope.zoom = ($scope.zoom === 50) ? 50 : ($scope.zoom - 10);\r\n    }\r\n\r\n    $scope.zoomIn = function() {\r\n        pdfDelegate.$getByHandle('my-pdf-container').zoomIn();\r\n        sendMessage({id:'whiteboard',event:'zoomInSlide',object:null});\r\n        $scope.zoom += 10;\r\n    }\r\n\r\n    // Upload file\r\n    // upload on file select or drop\r\n    $scope.uploadDoc = function (file) {\r\n        console.log('file', file);\r\n        if (!file) {\r\n            return;\r\n        }\r\n        $meeting.uploadFile({file:file},function(result) {\r\n            if (result.status && result.data.status) {\r\n                console.log('url', result.data.url);\r\n                 $scope.pdfUrl = result.data.url;\r\n                 $scope.$apply();\r\n                 pdfDelegate\r\n                    .$getByHandle('my-pdf-container')\r\n                    .load(result.data.url);\r\n                sendMessage({id:'whiteboard',event:'insertSlide',object:result.data.url});\r\n            }\r\n        })\r\n\r\n    };\r\n});\n'use strict';\r\n\r\n/**\r\n * @ngdoc function\r\n * @name conferenceApp.controller:MainCtrl\r\n * @description\r\n * # MainCtrl\r\n * Controller of the conferenceApp\r\n */\r\nangular.module('mainModule')\r\n    .controller('TrustedLoginController', function ($rootScope, $scope, $member, $location, $log, $routeParams,viMdToast, \r\n            Fullscreen, localStorageService,$base64) {\r\n        $scope.trustedLoginKind = 'training';\r\n        \r\n        // Login to room\r\n        $scope.loginMeeting = function () {\r\n            Fullscreen.all();\r\n            var info = {\r\n                payload: $base64.decode($routeParams.payload),\r\n                checksum: $routeParams.checksum\r\n            };\r\n\r\n            $member.trustedLogin(info, function(result) {\r\n                if (result.status && result.data.status) {\r\n                    localStorageService.set(\"meeting\",result.data.meeting);\r\n                    localStorageService.set(\"member\",result.data.member);\r\n                    localStorageService.set(\"memberList\",result.data.memberList);\r\n                    \r\n                    if ($routeParams.kind === 'conference') {\r\n                        $location.path('/room');\r\n                    } else {                        \r\n                        $location.path('/training');\r\n                    } \r\n                } else {\r\n                    $log.error(result);\r\n                    viMdToast.error('Đã có lỗi xảy ra!');\r\n                }\r\n            });  \r\n        };\r\n\r\n        $scope.loginMeetingKeyPress = function(event) {\r\n            if (event.code === 'Enter') {\r\n                $scope.loginMeeting();\r\n            }\r\n        };\r\n    });\r\n\n'use strict';\r\n\r\n/**\r\n * @ngdoc function\r\n * @name conferenceApp.controller:MainCtrl\r\n * @description\r\n * # MainCtrl\r\n * Controller of the conferenceApp\r\n */\r\nangular.module('mainModule')\r\n    .controller('HomeController', function ($rootScope, $scope, $member, $location, $log, viMdToast, Fullscreen, localStorageService) {\r\n        $scope.meetingAuth = {kind: 'training'};\r\n\r\n        // Login to room\r\n\t    $scope.loginMeeting = function () {\r\n\t\t    Fullscreen.all();\r\n            var info = {\r\n                meetingId: $scope.meetingAuth.meetingId,\r\n                email: $scope.meetingAuth.email,\r\n                password: $scope.meetingAuth.password\r\n            };\r\n\r\n            $member.login(info, function(result) {\r\n                if (result.status && result.data.status) {\r\n                    localStorageService.set(\"meeting\",result.data.meeting);\r\n                    localStorageService.set(\"member\",result.data.member);\r\n                    localStorageService.set(\"memberList\",result.data.memberList);\r\n                    \r\n                    if ($scope.meetingAuth.kind === 'training') {\r\n                        $location.path('/training');\r\n                    } else {\r\n                        $location.path('/room');\r\n                    }                    \r\n                } else {\r\n                    $log.error(result);\r\n                    viMdToast.error('Input incorrect!');\r\n                }\r\n            });  \r\n\t    };\r\n\r\n        $scope.loginMeetingKeyPress = function(event) {\r\n            if (event.code === 'Enter') {\r\n                $scope.loginMeeting();\r\n            }\r\n        };\r\n    });\r\n\n'use strict';\r\n\r\nangular.module('conferenceModule',['api','toastr','config','underscore','LocalStorageModule','pageslide-directive','base64',\r\n                                   'angular-simple-chat','ngAudio','ngActivityIndicator']);\n'use strict';\r\nangular.module('conferenceModule').controller('RoomController', function($scope, $rootScope, $location, $routeParams, _,\r\n    localStorageService, $log, $interval, $sce, $socket, $window, deviceDetector, iceServers, $recorder,\r\n    $mdSidenav,$base64,$timeout,ngAudio,$activityIndicator,toastr,$route) {\r\n    // publication\r\n    var PUB_INITIAL = 0;\r\n    var PUB_INPROGRESS = 1;\r\n    var PUB_CONNECTING = 2;\r\n    var PUB_CONNECTED = 3;\r\n    \r\n    // subscription\r\n    var SUB_INITIAL = 0;\r\n    var SUB_INPROGRESS = 1;\r\n    var SUB_CONNECTING = 2;\r\n    var SUB_CONNECTED = 3;\r\n    \r\n    var GATHER_TIMEOUT = 20*1000;\r\n    var CALLING_TIMEOUT = 20*1000;\r\n    \r\n    function RoomMember(id,profile)\r\n    {\r\n        this.id = id;\r\n        this.avail = false;\r\n        this.profile = profile;\r\n        this.invited = false;\r\n        this.pubWebRtcEndpoint = null;\r\n        this.pubOfferSdp = null;\r\n        this.pubState = PUB_INITIAL;\r\n        this.pubGatherToken = null;\r\n        this.pubTimeoutToken = null;\r\n        this.pubCandidateSendQueue =  [];\r\n        this.subWebRtcEndpoint = null;\r\n        this.subOfferSdp = null;\r\n        this.subState = SUB_INITIAL;\r\n        this.subGatherToken = null;\r\n        this.subCandidateSendQueue =  [];\r\n        this.pubCamera = null;        \r\n        this.subVideoSlot = null;\r\n        this.markedForSubscription = false;\r\n    }\r\n\r\n    function init() {\r\n        $scope.audio = true;\r\n        $scope.video = true;\r\n        $scope.handUp = true;\r\n        $scope.notiHandUp = true;\r\n        $scope.sound = ngAudio.load(\"assets/sounds/ring.mp3\")\r\n        \r\n        $scope.meeting = localStorageService.get(\"meeting\");\r\n        $scope.myProfile = localStorageService.get(\"member\");\r\n        $scope.memberProfiles = localStorageService.get(\"memberList\");\r\n        $scope.memberList = [];\r\n        $scope.videoSlots = [];\r\n        $scope.chatMessage = [];\r\n        var count = 0;\r\n        _.each($scope.memberProfiles,function(profile) {\r\n            $scope.memberList.push(new RoomMember(profile._id,profile));\r\n            $scope.videoSlots.push({\r\n                allocated: false,\r\n                videoId: 'remoteCamera' + count,\r\n                index: count,\r\n                member:null,\r\n                width: 0\r\n            });\r\n            count++;\r\n        });        \r\n        $scope.me = _.find($scope.memberList, function(m) {\r\n            return m.id == $scope.myProfile._id;\r\n        });\r\n        $scope.me.pubCamera = document.getElementById('localCamera');\r\n        $scope.presenter = _.find($scope.memberList, function(m) {\r\n            return m.profile.role == 'presenter';\r\n        });\r\n        $scope.presenter.subVideoSlot = $scope.videoSlots[0]; \r\n        $scope.viewerList = _.filter($scope.memberList, function(m) {\r\n            return m.profile.role != 'presenter';\r\n        });      \r\n    };\r\n    \r\n    $scope.connect = function() {\r\n        if ($socket.readyState == 1)  {\r\n            sendMessage({ id: 'join'});\r\n            $scope.sound.loop = true;\r\n            $scope.sound.play();\r\n            $scope.me.pubState = PUB_INPROGRESS;\r\n        } else\r\n            $window.location.reload();\r\n    }\r\n    \r\n    $scope.disconnect = function() {\r\n        $scope.me.pubState = PUB_INITIAL;\r\n        $scope.sound.stop();\r\n        try {\r\n            if ($scope.me.pubWebRtcEndpoint)\r\n                $scope.me.pubWebRtcEndpoint['peerConnection'].close();\r\n            _.each($scope.memberList ,function(member) {\r\n                if (member.subState != SUB_INITIAL)\r\n                    unsubscribe(member);\r\n            });\r\n            sendMessage({\r\n                id: 'leave'\r\n            });\r\n        } catch (e) {\r\n            $log.error(e);\r\n        }\r\n    }\r\n    \r\n    $socket.onmessage = function(message) {\r\n        var parsedMessage = JSON.parse(message.data);\r\n        console.info('Received message: ' + message.data);\r\n        switch (parsedMessage.id) {\r\n            case 'joinResponse':                \r\n                joinResponse(parsedMessage);\r\n                break;\r\n            case 'end':             \r\n                endConference();\r\n                break;\r\n            case 'memberStatus':\r\n                memberStatus(parsedMessage);\r\n                break;\r\n            case 'handUp':\r\n                handUp(parsedMessage);\r\n                break;\r\n            case 'handDown':\r\n                handDown(parsedMessage);\r\n                break;\r\n            case 'publishResponse':\r\n                publishResponse(parsedMessage);\r\n                break;\r\n            case 'subscribeResponse':\r\n                subscribeResponse(parsedMessage);\r\n                break;\r\n            case 'chat':\r\n                receiveChat(parsedMessage);\r\n                break;\r\n            default:\r\n                console.error('Unrecognized message', parsedMessage);\r\n            }\r\n        $scope.$apply();\r\n    };\r\n        \r\n    function sendMessage(message) {\r\n        message.memberId = $scope.me.id;\r\n        message.meetingId = $scope.meeting._id;\r\n        var jsonMessage = JSON.stringify(message);\r\n        $log.info('Senging message: ' + jsonMessage);\r\n        try {\r\n            $socket.send(jsonMessage);\r\n        } catch (exc) {\r\n            $log.info('Error sending message: ' );\r\n            $window.location.reload();\r\n        }\r\n    };\r\n     \r\n    function joinResponse(message) {\r\n        if (message.response == 'accepted') {\r\n            publish();\r\n        } else {\r\n            $location.path('/');\r\n        }\r\n    };\r\n\r\n    function publish() {  \r\n        var options = {\r\n            localVideo: localCamera,\r\n            onicecandidate: onPublishIceCandidate,\r\n            iceServers:iceServers,\r\n            oncandidategatheringdone: onPublishComplete\r\n        };\r\n        $scope.me.pubWebRtcEndpoint = kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(options, function(error) {\r\n            if (error) {\r\n                $activityIndicator.stopAnimating();\r\n                $log.error(error);\r\n                return;\r\n            }\r\n            this.generateOffer(onPublish);\r\n        });\r\n        $activityIndicator.startAnimating();\r\n        $scope.me.pubGatherToken = $timeout(function() {\r\n            if ($scope.me.pubState != PUB_CONNECTING) {\r\n                $scope.me.pubState = PUB_CONNECTING;\r\n                sendPublishData();\r\n            }\r\n        },GATHER_TIMEOUT);\r\n    }\r\n\r\n    function onPublishIceCandidate(candidate) {\r\n        $scope.me.pubCandidateSendQueue.push(candidate);\r\n    }\r\n\r\n    function onPublish(error, offerSdp) {\r\n        if (error) {\r\n            $activityIndicator.stopAnimating();\r\n            $log.info(error);\r\n            return;\r\n        }\r\n        $scope.me.pubOfferSdp = offerSdp;\r\n    }\r\n\r\n    function publishResponse(message) {\r\n        $activityIndicator.stopAnimating();\r\n        if (message.response != 'accepted') {\r\n            $log.info('Disconnect due to reject from server');\r\n            $scope.disconnect();\r\n        } else {\r\n            $scope.me.pubWebRtcEndpoint.processAnswer(message.sdpAnswer);\r\n            _.each(message.candidateList,function(candidate) {\r\n                $scope.me.pubWebRtcEndpoint.addIceCandidate(candidate);\r\n            })\r\n            sendMessage({\r\n                id: 'publishAvail'\r\n            });\r\n            $scope.me.pubState = PUB_CONNECTED;\r\n            $scope.sound.stop();\r\n        }\r\n    }\r\n    \r\n    function onPublishComplete() {\r\n        $timeout.cancel($scope.me.pubGatherToken);\r\n        if ($scope.me.pubState != PUB_CONNECTING) {\r\n            $scope.me.pubState = PUB_CONNECTING;\r\n            sendPublishData();\r\n        }\r\n    }\r\n    \r\n    function sendPublishData() {\r\n        if (!$scope.me.pubOfferSdp || !$scope.me.pubCandidateSendQueue.length) {\r\n            $log.info('Disconnect due to device error');\r\n            $scope.disconnect();\r\n            return;\r\n        }\r\n        var message = {\r\n                id: 'publish',\r\n                sdpOffer: $scope.me.pubOfferSdp,\r\n                candidateList: $scope.me.pubCandidateSendQueue\r\n         };\r\n        sendMessage(message);\r\n        $scope.me.pubOfferSdp = null;\r\n        $scope.me.pubCandidateSendQueue = [];\r\n        $scope.me.pubTimeoutToken = $timeout(function() {\r\n            if ($scope.me.pubState != PUB_CONNECTED) {\r\n                $log.info('Disconnect due to calling timeout');\r\n                $scope.disconnect();\r\n            }\r\n        },CALLING_TIMEOUT);\r\n    }\r\n\r\n    function unsubscribe(member) {\r\n        member.markedForSubscription =  false;\r\n        if (member.subVideoSlot) {\r\n            member.subState = SUB_INITIAL;\r\n            if (member.id!= $scope.presenter.id) {\r\n                member.subVideoSlot.allocated = false;\r\n                member.subVideoSlot.member = null;\r\n                member.subVideoSlot = null;    \r\n            }            \r\n            if (member.subGatherToken)\r\n                $timeout.cancel(member.subGatherToken);\r\n            try {\r\n                if (member.subWebRtcEndpoint)\r\n                    member.subWebRtcEndpoint['peerConnection'].close();\r\n            } catch (e) {\r\n                $log.error(e);\r\n            }\r\n        }\r\n    }\r\n    \r\n    $scope.resubscribe = function(pubId) {\r\n        $scope.disableState = true;\r\n        var publisher = _.find($scope.memberList, function(m) {\r\n            return m.id == pubId;\r\n        });\r\n\r\n        if (publisher.invited && publisher.avail) {\r\n            unsubscribe(publisher);\r\n            subscribe(publisher);\r\n        }\r\n\r\n        $timeout(function() {\r\n            $scope.disableState = false;\r\n        }, 30000)\r\n    }\r\n\r\n    function subscribe(member) {\r\n        if (!$scope.me.avail) {\r\n            return;\r\n        }\r\n        var slot = null;\r\n        if (member.subVideoSlot) {\r\n            slot = member.subVideoSlot;\r\n        } else {\r\n            slot = _.find($scope.videoSlots, function(s) {\r\n                return !s.allocated  && s.index > 0;\r\n            });\r\n        }\r\n        if (!slot) return;\r\n        member.subVideoSlot = slot;\r\n        slot.member = member;\r\n        slot.allocated = true;\r\n        member.subState = SUB_INPROGRESS;\r\n        $scope.numOfAllocated = getAllocatedSlots($scope.videoSlots).length;\r\n        calcGridSlots(3, $scope.numOfAllocated, $scope.videoSlots);\r\n        var remoteCamera = document.getElementById(slot.videoId);\r\n        var options = {\r\n            remoteVideo: remoteCamera,\r\n            onicecandidate: onSubscribeIceCandidate.bind({member:member }),\r\n            iceServers: iceServers,\r\n            oncandidategatheringdone: onSubscribeComplete.bind({member:member})\r\n        }\r\n        member.subGatherToken = $timeout(function(m) {\r\n            if (m.subState != SUB_CONNECTING) {\r\n                sendSubscribeData(m);\r\n                m.subState = SUB_CONNECTING;\r\n            }\r\n        },GATHER_TIMEOUT,true,member);\r\n        \r\n        member.subWebRtcEndpoint = kurentoUtils.WebRtcPeer.WebRtcPeerRecvonly(options, function(error) {\r\n            if (error) {\r\n                $log.error(error);\r\n                return;\r\n            }\r\n            this.generateOffer(onSubscribe.bind({\r\n                member: member\r\n            }));\r\n        });\r\n    }\r\n\r\n    function calcGridSlots(slotsPerRow, numOfAllocated, slotsList) {\r\n        var rows = Math.floor(numOfAllocated / slotsPerRow);\r\n        var itemsModulus = numOfAllocated % slotsPerRow;\r\n        if (rows === 0) {\r\n            if (numOfAllocated === 1) {\r\n                $scope.firstSlot = 100;\r\n            } else if (numOfAllocated === 2) {\r\n                $scope.firstSlot = Math.floor(100 / 2);\r\n                slotsList.map(function(slot) {\r\n                    if (slot.allocated) {\r\n                        slot.width = Math.floor(100 / 2);\r\n                    }\r\n                })\r\n            }\r\n        } else {\r\n            slotsList.map(function(slot) {\r\n                if (slot.allocated) {\r\n                    slot.width = Math.floor(100 / slotsPerRow);\r\n                    $scope.firstSlot = slot.width;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    function getAllocatedSlots(memberList) {\r\n        var allocatedSlotArr = _.filter(memberList, function(member) {\r\n            return member.allocated;\r\n        })\r\n\r\n        return allocatedSlotArr;\r\n    }\r\n\r\n    function onSubscribeIceCandidate(candidate) {\r\n        this.member.subCandidateSendQueue.push(candidate);\r\n    }\r\n\r\n    function onSubscribe(error, offerSdp) {\r\n        if (error) {\r\n            $log.error(error);\r\n            return;\r\n        }\r\n        this.member.subSdpOffer = offerSdp;\r\n    }\r\n\r\n    function subscribeResponse(message) {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == message.pubId;\r\n        });\r\n        if (message.response != 'accepted') {\r\n            member.subState = SUB_INITIAL;\r\n            toastr.error('Server error, please try again later');\r\n        } \r\n        else {            \r\n            member.subWebRtcEndpoint.processAnswer(message.sdpAnswer);\r\n            if (member.id == $scope.me.id) {\r\n                member.subWebRtcEndpoint.remoteVideo.muted = true;\r\n            }\r\n            if (member.subVideoSlot) {\r\n                member.subState = SUB_CONNECTED;\r\n                _.each(message.candidateList,function(candidate) {\r\n                    member.subWebRtcEndpoint.addIceCandidate(candidate);\r\n                });\r\n                sendMessage({\r\n                    id: 'subscribeAvail',\r\n                    pubId:message.pubId\r\n                });\r\n            }\r\n            nextSubscriber();\r\n        }\r\n    }\r\n    \r\n    function onSubscribeComplete() {\r\n        $timeout.cancel(this.member.subGatherToken);\r\n        if (this.member.subState != SUB_CONNECTING) {\r\n            sendSubscribeData(this.member);\r\n            this.member.subState = SUB_CONNECTING;\r\n        }\r\n        \r\n    }\r\n    \r\n    function sendSubscribeData(member) {\r\n        if (!member.subSdpOffer || !member.subCandidateSendQueue.length) {\r\n            toastr.error(\"Device error\");\r\n            return;\r\n        }\r\n        var message = {\r\n                id: 'subscribe',\r\n                pubId: member.id,\r\n                sdpOffer: member.subSdpOffer,\r\n                candidateList:member.subCandidateSendQueue\r\n            }\r\n        sendMessage(message);\r\n        member.subSdpOffer = null;\r\n        member.subCandidateSendQueue = [];\r\n    }\r\n\r\n    function endConference(message) {\r\n        var url = $scope.meeting.logoutUrl ? $base64.decode($scope.meeting.logoutUrl) : '/';\r\n        $window.location.href = url;\r\n    };\r\n\r\n    function memberStatus(message) {\r\n        updateMemberList(message.onlineList);\r\n    };\r\n    \r\n    function nextSubscriber() {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.markedForSubscription;\r\n        });\r\n        if (member) {\r\n            member.markedForSubscription =  false;\r\n            subscribe(member);\r\n        }\r\n    }\r\n\r\n    function updateMemberList(onlineList) {\r\n        var unSubList = [];\r\n        _.each($scope.memberList, function(curVal) {\r\n            var newVal = _.find(onlineList, function(m) {\r\n                return curVal.id == m._id;\r\n            });\r\n            if (newVal) {\r\n                curVal.avail = newVal.avail;\r\n                curVal.invited = newVal.invited;\r\n                curVal.online = true;\r\n                if (curVal.invited) {\r\n                    if (curVal.avail) {\r\n                        if (!curVal.subVideoSlot)\r\n                            curVal.markedForSubscription =  true;\r\n                        if (curVal.subVideoSlot && curVal.subState==SUB_INITIAL)\r\n                            curVal.markedForSubscription =  true;\r\n                    } else {\r\n                        if (curVal.subVideoSlot )\r\n                            unSubList.push(curVal);\r\n                    }\r\n                } else {\r\n                    unSubList.push(curVal);\r\n                }\r\n            } else {\r\n                if (curVal.invited) \r\n                    unSubList.push(curVal);\r\n                curVal.invited = false;\r\n                curVal.avail = false;\r\n                curVal.online = false;\r\n            }\r\n        });        \r\n        _.each(unSubList, function(member) {\r\n            unsubscribe(member);\r\n        });\r\n        nextSubscriber();\r\n    }\r\n    $scope.leave = function() {\r\n        var url = $scope.meeting.logoutUrl ? $scope.meeting.logoutUrl : '/';\r\n        sendMessage({\r\n            id: 'leave'\r\n        });\r\n        $window.location.href = url;        \r\n    }\r\n    $scope.endLesson = function() {\r\n        sendMessage({\r\n            id: 'end'\r\n        });\r\n    }\r\n    $scope.toggleAudio = function() {\r\n        var localStream = $scope.me.pubWebRtcEndpoint.getLocalStream();\r\n        if (localStream) {\r\n            var audioTrack = localStream.getAudioTracks()[0];\r\n            $scope.audio = !$scope.audio;\r\n            audioTrack.enabled = $scope.audio;\r\n        }\r\n    };\r\n    $scope.toggleVideo = function() {\r\n        var localStream = $scope.me.pubWebRtcEndpoint.getLocalStream();\r\n        if (localStream) {\r\n            var videoTrack = localStream.getVideoTracks()[0];\r\n            $scope.video = !$scope.video;\r\n            videoTrack.enabled = $scope.video;\r\n        }\r\n    };\r\n    $scope.toggleHand = function() {\r\n        $scope.handUp = !$scope.handUp;\r\n        if ($scope.handUp) {\r\n            sendMessage({id: 'handUp'});\r\n        } else {\r\n            sendMessage({id: 'handDown'});\r\n        }\r\n    };\r\n    $scope.toggleSidenav = function(eleId) {\r\n        $mdSidenav(eleId).toggle();\r\n    };\r\n    $scope.memberInvite = function(memberId) {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == memberId;\r\n        });\r\n        member.handUp = false;\r\n        if (!member.invited && member.online) {\r\n            sendMessage({\r\n                id: 'invite',\r\n                'inviteeId': member.id\r\n            });\r\n        }\r\n    }\r\n    $scope.memberDiscard = function(slot) {\r\n        var member = slot.member;\r\n        if (member) {\r\n            member.handUp = false;\r\n            sendMessage({\r\n                id: 'discard',\r\n                'inviteeId': member.id\r\n            });\r\n        }\r\n    }\r\n    var handUp = function(message) {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == message.memberId;\r\n        });\r\n        member.handUp = true;\r\n    }\r\n    var handDown = function(message) {\r\n        var member = _.find($scope.memberList, function(m) {\r\n            return m.id == message.memberId;\r\n        });\r\n        member.handUp = false;\r\n    }\r\n    $scope.chat = function() {\r\n        var message = {\r\n            id: 'chat',\r\n            text: $scope.chatInput\r\n        }\r\n        sendMessage(message);\r\n        $scope.chatInput = \"\";\r\n    }\r\n\r\n    $scope.sendChatMessage = function($event) {\r\n        if (event.code === 'Enter') {\r\n            $scope.chat();\r\n        }\r\n    };\r\n\r\n    function receiveChat(message) {\r\n        $scope.chatMessage.push({\r\n            'user': message.user,\r\n            'text': message.text\r\n        });\r\n    }\r\n    $scope.byIndex = function(slot) {\r\n        return slot.index > 0;\r\n    };\r\n\r\n    $rootScope.$on('$routeChangeStart', function(event, next, current) {\r\n        if (!current) {\r\n            $socket.close();\r\n        }\r\n    });\r\n    $window.onbeforeunload = function() {\r\n        $socket.close();\r\n        $interval.cancel(recordToken);\r\n    };\r\n\r\n    init();\r\n});\n'use strict';\r\n\r\nangular.module('adminModule',['api','toastr','config','underscore','LocalStorageModule']);\n'use strict';\r\nangular.module('adminModule').config(function ($routeProvider) {\r\n    $routeProvider\r\n        .when('/admin', {\r\n            templateUrl: 'app/modules/admin/views/adminAuthView.html',\r\n            controller: 'AdminAuthCtrl',\r\n            controllerAs: 'app/modules/admin/controllers/adminAuthController'\r\n        })\r\n        .when('/admin/rooms', {\r\n            templateUrl: 'app/modules/admin/views/adminRoomsListView.html',\r\n            controller: 'AdminRoomsListCtrl',\r\n            controllerAs: 'app/modules/admin/controllers/adminRoomsListController'\r\n        })\r\n        .when('/admin/rooms/create', {\r\n            templateUrl: 'app/modules/admin/views/adminCreateRoomView.html',\r\n            controller: 'AdminCreateRoomCtrl',\r\n            controllerAs: 'app/modules/admin/controllers/adminCreateRoomController'\r\n        })\r\n        .when('/admin/rooms/edit', {\r\n            templateUrl: 'app/modules/admin/views/adminEditRoomView.html',\r\n            controller: 'AdminEditRoomCtrl',\r\n            controllerAs: 'app/modules/admin/controllers/adminEditRoomCtrl'\r\n        })\r\n        .otherwise({\r\n            redirectTo: '/'\r\n        });        \r\n});\n'use strict';\r\n\r\n\r\nangular.module('app')\r\n  .factory('$utilities', function () {\r\n    var utilities = {\r\n     resizeImg: function(img, maxWidth, maxHeight, degrees) {\r\n      var imgWidth = img.width,\r\n        imgHeight = img.height;\r\n\r\n      var ratio = 1,\r\n        ratio1 = 1,\r\n        ratio2 = 1;\r\n      ratio1 = maxWidth / imgWidth;\r\n      ratio2 = maxHeight / imgHeight;\r\n\r\n      // Use the smallest ratio that the image best fit into the maxWidth x maxHeight box.\r\n      if (ratio1 < ratio2) {\r\n        ratio = ratio1;\r\n      } else {\r\n        ratio = ratio2;\r\n      }\r\n      var canvas = document.createElement(\"canvas\");\r\n      var canvasContext = canvas.getContext(\"2d\");\r\n      var canvasCopy = document.createElement(\"canvas\");\r\n      var copyContext = canvasCopy.getContext(\"2d\");\r\n      var canvasCopy2 = document.createElement(\"canvas\");\r\n      var copyContext2 = canvasCopy2.getContext(\"2d\");\r\n      canvasCopy.width = imgWidth;\r\n      canvasCopy.height = imgHeight;\r\n      copyContext.drawImage(img, 0, 0);\r\n\r\n      // init\r\n      canvasCopy2.width = imgWidth;\r\n      canvasCopy2.height = imgHeight;\r\n      copyContext2.drawImage(canvasCopy, 0, 0, canvasCopy.width, canvasCopy.height, 0, 0, canvasCopy2.width, canvasCopy2.height);\r\n\r\n\r\n      var rounds = 1;\r\n      var roundRatio = ratio * rounds;\r\n      for (var i = 1; i <= rounds; i++) {\r\n\r\n        // tmp\r\n        canvasCopy.width = imgWidth * roundRatio / i;\r\n        canvasCopy.height = imgHeight * roundRatio / i;\r\n\r\n        copyContext.drawImage(canvasCopy2, 0, 0, canvasCopy2.width, canvasCopy2.height, 0, 0, canvasCopy.width, canvasCopy.height);\r\n\r\n        // copy back\r\n        canvasCopy2.width = imgWidth * roundRatio / i;\r\n        canvasCopy2.height = imgHeight * roundRatio / i;\r\n        copyContext2.drawImage(canvasCopy, 0, 0, canvasCopy.width, canvasCopy.height, 0, 0, canvasCopy2.width, canvasCopy2.height);\r\n\r\n      } // end for\r\n\r\n      canvas.width = imgWidth * roundRatio / rounds;\r\n      canvas.height = imgHeight * roundRatio / rounds;\r\n      canvasContext.drawImage(canvasCopy2, 0, 0, canvasCopy2.width, canvasCopy2.height, 0, 0, canvas.width, canvas.height);\r\n\r\n\r\n      if (degrees == 90 || degrees == 270) {\r\n        canvas.width = canvasCopy2.height;\r\n        canvas.height = canvasCopy2.width;\r\n      } else {\r\n        canvas.width = canvasCopy2.width;\r\n        canvas.height = canvasCopy2.height;\r\n      }\r\n\r\n      canvasContext.clearRect(0, 0, canvas.width, canvas.height);\r\n      if (degrees == 90 || degrees == 270) {\r\n        canvasContext.translate(canvasCopy2.height / 2, canvasCopy2.width / 2);\r\n      } else {\r\n        canvasContext.translate(canvasCopy2.width / 2, canvasCopy2.height / 2);\r\n      }\r\n      canvasContext.rotate(degrees * Math.PI / 180);\r\n      canvasContext.drawImage(canvasCopy2, -canvasCopy2.width / 2, -canvasCopy2.height / 2);\r\n\r\n\r\n      var dataURL = canvas.toDataURL();\r\n      return dataURL;\r\n    },\r\n    b64toBlob: function(b64Data, contentType, sliceSize) {\r\n      contentType = contentType || '';\r\n      sliceSize = sliceSize || 512;\r\n\r\n      var byteCharacters = atob(b64Data);\r\n      var byteArrays = [];\r\n\r\n      for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n          byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n      }\r\n\r\n      var blob = new Blob(byteArrays, { type: contentType });\r\n      return blob;\r\n    },\r\n    };\r\n    return utilities;\r\n  });\r\n'use strict';\r\n\r\n\r\nangular.module('app')\r\n  .factory('$utilities', function () {\r\n    var utilities = {\r\n     resizeImg: function(img, maxWidth, maxHeight, degrees) {\r\n      var imgWidth = img.width,\r\n        imgHeight = img.height;\r\n\r\n      var ratio = 1,\r\n        ratio1 = 1,\r\n        ratio2 = 1;\r\n      ratio1 = maxWidth / imgWidth;\r\n      ratio2 = maxHeight / imgHeight;\r\n\r\n      // Use the smallest ratio that the image best fit into the maxWidth x maxHeight box.\r\n      if (ratio1 < ratio2) {\r\n        ratio = ratio1;\r\n      } else {\r\n        ratio = ratio2;\r\n      }\r\n      var canvas = document.createElement(\"canvas\");\r\n      var canvasContext = canvas.getContext(\"2d\");\r\n      var canvasCopy = document.createElement(\"canvas\");\r\n      var copyContext = canvasCopy.getContext(\"2d\");\r\n      var canvasCopy2 = document.createElement(\"canvas\");\r\n      var copyContext2 = canvasCopy2.getContext(\"2d\");\r\n      canvasCopy.width = imgWidth;\r\n      canvasCopy.height = imgHeight;\r\n      copyContext.drawImage(img, 0, 0);\r\n\r\n      // init\r\n      canvasCopy2.width = imgWidth;\r\n      canvasCopy2.height = imgHeight;\r\n      copyContext2.drawImage(canvasCopy, 0, 0, canvasCopy.width, canvasCopy.height, 0, 0, canvasCopy2.width, canvasCopy2.height);\r\n\r\n\r\n      var rounds = 1;\r\n      var roundRatio = ratio * rounds;\r\n      for (var i = 1; i <= rounds; i++) {\r\n\r\n        // tmp\r\n        canvasCopy.width = imgWidth * roundRatio / i;\r\n        canvasCopy.height = imgHeight * roundRatio / i;\r\n\r\n        copyContext.drawImage(canvasCopy2, 0, 0, canvasCopy2.width, canvasCopy2.height, 0, 0, canvasCopy.width, canvasCopy.height);\r\n\r\n        // copy back\r\n        canvasCopy2.width = imgWidth * roundRatio / i;\r\n        canvasCopy2.height = imgHeight * roundRatio / i;\r\n        copyContext2.drawImage(canvasCopy, 0, 0, canvasCopy.width, canvasCopy.height, 0, 0, canvasCopy2.width, canvasCopy2.height);\r\n\r\n      } // end for\r\n\r\n      canvas.width = imgWidth * roundRatio / rounds;\r\n      canvas.height = imgHeight * roundRatio / rounds;\r\n      canvasContext.drawImage(canvasCopy2, 0, 0, canvasCopy2.width, canvasCopy2.height, 0, 0, canvas.width, canvas.height);\r\n\r\n\r\n      if (degrees == 90 || degrees == 270) {\r\n        canvas.width = canvasCopy2.height;\r\n        canvas.height = canvasCopy2.width;\r\n      } else {\r\n        canvas.width = canvasCopy2.width;\r\n        canvas.height = canvasCopy2.height;\r\n      }\r\n\r\n      canvasContext.clearRect(0, 0, canvas.width, canvas.height);\r\n      if (degrees == 90 || degrees == 270) {\r\n        canvasContext.translate(canvasCopy2.height / 2, canvasCopy2.width / 2);\r\n      } else {\r\n        canvasContext.translate(canvasCopy2.width / 2, canvasCopy2.height / 2);\r\n      }\r\n      canvasContext.rotate(degrees * Math.PI / 180);\r\n      canvasContext.drawImage(canvasCopy2, -canvasCopy2.width / 2, -canvasCopy2.height / 2);\r\n\r\n\r\n      var dataURL = canvas.toDataURL();\r\n      return dataURL;\r\n    },\r\n    b64toBlob: function(b64Data, contentType, sliceSize) {\r\n      contentType = contentType || '';\r\n      sliceSize = sliceSize || 512;\r\n\r\n      var byteCharacters = atob(b64Data);\r\n      var byteArrays = [];\r\n\r\n      for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n          byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n      }\r\n\r\n      var blob = new Blob(byteArrays, { type: contentType });\r\n      return blob;\r\n    },\r\n    };\r\n    return utilities;\r\n  });\n'use strict';\r\nangular.module('api').factory('$recorder', function( $log)\r\n{\r\n    var mediaRecorder;\r\n    var recordedBlobs;\r\n    var sourceBuffer;\r\n    var onFileReady;\r\n    \r\n    function handleDataAvailable(event) {\r\n        if (event.data && event.data.size > 0) {\r\n            recordedBlobs.push(event.data);\r\n        }\r\n        if (deviceDetector.browser == 'firefox' && !$scope.recording) {\r\n            var superBuffer = new Blob(recordedBlobs, {\r\n                type: 'video/webm'\r\n            });\r\n            var file = new File([superBuffer], \"upload.webm\");\r\n            $log.info(\"Broadcast firefox\");\r\n            onFileReady(file);\r\n        }\r\n    };\r\n\r\n    function handleStop(event) {\r\n        $log.info('Recorder stopped: ', event);\r\n    };\r\n    \r\n    return {\r\n        start: function(stream)\r\n        {\r\n            recordedBlobs = [];\r\n            var options = {\r\n                mimeType: 'video/webm;codecs=vp8'\r\n            };\r\n            if (!MediaRecorder.isTypeSupported(options.mimeType)) {\r\n                $log.info(options.mimeType + ' is not Supported');\r\n                options = {\r\n                    mimeType: 'video/webm;codecs=vp8'\r\n                };\r\n                if (!MediaRecorder.isTypeSupported(options.mimeType)) {\r\n                    $log.info(options.mimeType + ' is not Supported');\r\n                    options = {\r\n                        mimeType: 'video/webm'\r\n                    };\r\n                    if (!MediaRecorder.isTypeSupported(options.mimeType)) {\r\n                        $log.info(options.mimeType + ' is not Supported');\r\n                        options = {\r\n                            mimeType: ''\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n            try {\r\n                mediaRecorder = new MediaRecorder(stream, options);\r\n            } catch (e) {\r\n                console.error('Exception while creating MediaRecorder: ' + e);\r\n                alert('Exception while creating MediaRecorder: ' + e + '. mimeType: ' + options.mimeType);\r\n                return;\r\n            }\r\n            $log.info('Created MediaRecorder', mediaRecorder, 'with options', options);\r\n            mediaRecorder.onstop = handleStop;\r\n            mediaRecorder.ondataavailable = handleDataAvailable;\r\n            mediaRecorder.start();\r\n        },\r\n        stop: function(callback)\r\n        {\r\n            onFileReady =  callback;\r\n            mediaRecorder.stop();\r\n            $log.info(\"Stop recording\", recordedBlobs);\r\n            // For Firefox, the browser buffere media data and release upon stop recording\r\n            // For Chrome, the browser release data whenver it is available\r\n            if (deviceDetector.browser == 'chrome') {\r\n                var superBuffer = new Blob(recordedBlobs, {\r\n                    type: 'video/webm'\r\n                });\r\n                var file = new File([superBuffer], \"upload.webm\");\r\n                $log.info(\"Broadcast chrome\");\r\n                onFileReady(file);\r\n            }\r\n            \r\n        }\r\n    };\r\n});\nangular.module('app').directive('keyEnter', function () {\r\n    return function (scope, element, attrs) {\r\n        element.bind(\"keydown keypress\", function (event) {\r\n            if(event.which === 13) {\r\n                scope.$apply(function (){\r\n                    scope.$eval(attrs.keyEnter);\r\n                });\r\n\r\n                event.preventDefault();\r\n            }\r\n        });\r\n    };\r\n});\nangular.module('app').directive('fileModel', ['$parse', function ($parse) {\r\n   return {\r\n      restrict: 'A',\r\n      link: function(scope, element, attrs) {\r\n         var model = $parse(attrs.fileModel);\r\n         var modelSetter = model.assign;\r\n         \r\n         element.bind('change', function(){\r\n            scope.$apply(function(){\r\n               modelSetter(scope, element[0].files[0]);\r\n            });\r\n         });\r\n      }\r\n   };\r\n}]);\n'use strict';\r\n\r\nangular.module('app').directive('angucompleteAlt', ['$q', '$parse', '$http', '$sce', '$timeout', '$templateCache', '$interpolate', function ($q, $parse, $http, $sce, $timeout, $templateCache, $interpolate) {\r\n    // keyboard events\r\n    var KEY_DW  = 40;\r\n    var KEY_RT  = 39;\r\n    var KEY_UP  = 38;\r\n    var KEY_LF  = 37;\r\n    var KEY_ES  = 27;\r\n    var KEY_EN  = 13;\r\n    var KEY_TAB =  9;\r\n\r\n    var MIN_LENGTH = 3;\r\n    var MAX_LENGTH = 524288;  // the default max length per the html maxlength attribute\r\n    var PAUSE = 500;\r\n    var BLUR_TIMEOUT = 200;\r\n\r\n    // string constants\r\n    var REQUIRED_CLASS = 'autocomplete-required';\r\n    var TEXT_SEARCHING = 'Searching...';\r\n    var TEXT_NORESULTS = 'No results found';\r\n    var TEMPLATE_URL = '/angucomplete-alt/index.html';\r\n\r\n    // Set the default template for this directive\r\n    $templateCache.put(TEMPLATE_URL,\r\n        '<div class=\"angucomplete-holder\" ng-class=\"{\\'angucomplete-dropdown-visible\\': showDropdown}\">' +\r\n        '  <input style=\"margin: 0px; border: none; height: 34px; width: 90%;\" id=\"{{id}}_value\" name=\"{{inputName}}\" ng-class=\"{\\'angucomplete-input-not-empty\\': notEmpty}\" ng-model=\"searchStr\" ng-disabled=\"disableInput\" type=\"{{inputType}}\" placeholder=\"{{placeholder}}\" maxlength=\"{{maxlength}}\" ng-focus=\"onFocusHandler()\" class=\"{{inputClass}}\" ng-focus=\"resetHideResults()\" ng-blur=\"hideResults($event)\" autocapitalize=\"off\" autocorrect=\"off\" autocomplete=\"off\" ng-change=\"inputChangeHandler(searchStr)\"/>' +\r\n        '  <div id=\"{{id}}_dropdown\" class=\"angucomplete-dropdown\" ng-show=\"showDropdown\">' +\r\n        '    <div class=\"angucomplete-searching\" ng-show=\"searching\" ng-bind=\"textSearching\"></div>' +\r\n        '    <div class=\"angucomplete-searching\" ng-show=\"!searching && (!results || results.length == 0)\" ng-bind=\"textNoResults\"></div>' +\r\n        '    <div class=\"angucomplete-row\" ng-repeat=\"result in results\" ng-click=\"selectResult(result)\" ng-mouseenter=\"hoverRow($index)\" ng-class=\"{\\'angucomplete-selected-row\\': $index == currentIndex}\">' +\r\n        '      <div ng-if=\"imageField\" class=\"angucomplete-image-holder\">' +\r\n        '        <img ng-if=\"result.image && result.image != \\'\\'\" ng-src=\"{{result.image}}\" class=\"angucomplete-image\"/>' +\r\n        '        <div ng-if=\"!result.image && result.image != \\'\\'\" class=\"angucomplete-image-default\"></div>' +\r\n        '      </div>' +\r\n        '      <div class=\"angucomplete-title\" ng-if=\"matchClass\" ng-bind-html=\"result.title\"></div>' +\r\n        '      <div class=\"angucomplete-title\" ng-if=\"!matchClass\">{{ result.title }}</div>' +\r\n        '      <div ng-if=\"matchClass && result.description && result.description != \\'\\'\" class=\"angucomplete-description\" ng-bind-html=\"result.description\"></div>' +\r\n        '      <div ng-if=\"!matchClass && result.description && result.description != \\'\\'\" class=\"angucomplete-description\">{{result.description}}</div>' +\r\n        '    </div>' +\r\n        '  </div>' +\r\n        '</div>'\r\n    );\r\n\r\n    function link(scope, elem, attrs, ctrl) {\r\n      var inputField = elem.find('input');\r\n      var minlength = MIN_LENGTH;\r\n      var searchTimer = null;\r\n      var hideTimer;\r\n      var requiredClassName = REQUIRED_CLASS;\r\n      var responseFormatter;\r\n      var validState = null;\r\n      var httpCanceller = null;\r\n      var dd = elem[0].querySelector('.angucomplete-dropdown');\r\n      var isScrollOn = false;\r\n      var mousedownOn = null;\r\n      var unbindInitialValue;\r\n      var displaySearching;\r\n      var displayNoResults;\r\n\r\n      // #194 dropdown list not consistent in collapsing (bug).\r\n      function clickoutHandlerForDropdown(event) {\r\n        mousedownOn = null;\r\n        scope.hideResults(event);\r\n        document.body.removeEventListener('click', clickoutHandlerForDropdown);\r\n      }\r\n\r\n      elem.on('mousedown', function(event) {\r\n        if (event.target.id) {\r\n          mousedownOn = event.target.id;\r\n          if (mousedownOn === scope.id + '_dropdown') {\r\n            document.body.addEventListener('click', clickoutHandlerForDropdown);\r\n          }\r\n        }\r\n        else {\r\n          mousedownOn = event.target.className;\r\n        }\r\n      });\r\n\r\n      scope.currentIndex = scope.focusFirst ? 0 : null;\r\n      scope.searching = false;\r\n\r\n      function handleRequired(valid) {\r\n        scope.notEmpty = valid;\r\n        validState = scope.searchStr;\r\n        if (scope.fieldRequired && ctrl && scope.inputName) {\r\n          ctrl[scope.inputName].$setValidity(requiredClassName, valid);\r\n        }\r\n      }\r\n\r\n      function callOrAssign(value) {\r\n        if (typeof scope.selectedObject === 'function') {\r\n          scope.selectedObject(value);\r\n        }\r\n        else {\r\n          scope.selectedObject = value;\r\n        }\r\n\r\n        if (value) {\r\n          handleRequired(true);\r\n        }\r\n        else {\r\n          handleRequired(false);\r\n        }\r\n      }\r\n\r\n      function extractValue(obj, key) {\r\n        var keys, result;\r\n        if (key) {\r\n          keys= key.split('.');\r\n          result = obj;\r\n          for (var i = 0; i < keys.length; i++) {\r\n            result = result[keys[i]];\r\n          }\r\n        }\r\n        else {\r\n          result = obj;\r\n        }\r\n        return result;\r\n      }\r\n\r\n      function extractTitle(data) {\r\n        // split title fields and run extractValue for each and join with ' '\r\n        return scope.titleField.split(',')\r\n          .map(function(field) {\r\n            return extractValue(data, field);\r\n          })\r\n          .join(' ');\r\n      }\r\n\r\n      function handleInputChange(newval, initial) {\r\n        if (newval) {\r\n          if (typeof newval === 'object') {\r\n            scope.searchStr = extractTitle(newval);\r\n            callOrAssign({originalObject: newval});\r\n          } else if (typeof newval === 'string' && newval.length > 0) {\r\n            scope.searchStr = newval;\r\n          } else {\r\n            if (console && console.error) {\r\n              console.error('Tried to set ' + (!!initial ? 'initial' : '') + ' value of angucomplete to', newval, 'which is an invalid value');\r\n            }\r\n          }\r\n\r\n          handleRequired(true);\r\n        }\r\n      }\r\n\r\n      unbindInitialValue = scope.$watch('initialValue', function(newval) {\r\n        if (newval) {\r\n          // remove scope listener\r\n          unbindInitialValue();\r\n          // change input\r\n          handleInputChange(newval, true);\r\n        }\r\n      });\r\n\r\n      scope.$watch('fieldRequired', function(newval, oldval) {\r\n        if (newval !== oldval) {\r\n          if (!newval) {\r\n            ctrl[scope.inputName].$setValidity(requiredClassName, true);\r\n          }\r\n          else if (!validState || scope.currentIndex === -1) {\r\n            handleRequired(false);\r\n          }\r\n          else {\r\n            handleRequired(true);\r\n          }\r\n        }\r\n      });\r\n\r\n      function clearResults() {\r\n        scope.showDropdown = false;\r\n        scope.results = [];\r\n        if (dd) {\r\n          dd.scrollTop = 0;\r\n        }\r\n      }\r\n\r\n      scope.$on('angucomplete-alt:clearInput', function (event, elementId) {\r\n        if (!elementId || elementId === scope.id) {\r\n          scope.searchStr = null;\r\n          callOrAssign();\r\n          handleRequired(false);\r\n          clearResults();\r\n        }\r\n      });\r\n\r\n      scope.$on('angucomplete-alt:changeInput', function (event, elementId, newval) {\r\n        if (!!elementId && elementId === scope.id) {\r\n          handleInputChange(newval);\r\n        }\r\n      });\r\n\r\n      // for IE8 quirkiness about event.which\r\n      function ie8EventNormalizer(event) {\r\n        return event.which ? event.which : event.keyCode;\r\n      }\r\n\r\n      function callFunctionOrIdentity(fn) {\r\n        return function(data) {\r\n          return scope[fn] ? scope[fn](data) : data;\r\n        };\r\n      }\r\n\r\n      function setInputString(str) {\r\n        callOrAssign({originalObject: str});\r\n\r\n        if (scope.clearSelected) {\r\n          scope.searchStr = null;\r\n        }\r\n        clearResults();\r\n      }\r\n\r\n      function findMatchString(target, str) {\r\n        var result, matches, re;\r\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions\r\n        // Escape user input to be treated as a literal string within a regular expression\r\n        re = new RegExp(str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'i');\r\n        if (!target) { return; }\r\n        if (!target.match || !target.replace) { target = target.toString(); }\r\n        matches = target.match(re);\r\n        if (matches) {\r\n          result = target.replace(re,\r\n              '<span class=\"'+ scope.matchClass +'\">'+ matches[0] +'</span>');\r\n        }\r\n        else {\r\n          result = target;\r\n        }\r\n        return $sce.trustAsHtml(result);\r\n      }\r\n\r\n      function initResults() {\r\n        scope.showDropdown = displaySearching;\r\n        scope.currentIndex = scope.focusFirst ? 0 : -1;\r\n        scope.results = [];\r\n      }\r\n\r\n      function searchTimerComplete(str) {\r\n        // Begin the search\r\n        if (!str || str.length < minlength) {\r\n          return;\r\n        }\r\n        if (scope.localData) {\r\n          scope.$apply(function() {\r\n            getLocalResults(str);\r\n          });\r\n        }\r\n        else if (scope.remoteApiHandler) {\r\n          getRemoteResultsWithCustomHandler(str);\r\n        } else {\r\n          getRemoteResults(str);\r\n        }\r\n      }\r\n\r\n      function keyupHandler(event) {\r\n        var which = ie8EventNormalizer(event);\r\n        if (which === KEY_LF || which === KEY_RT) {\r\n          // do nothing\r\n          return;\r\n        }\r\n\r\n        if (which === KEY_UP || which === KEY_EN) {\r\n          event.preventDefault();\r\n        }\r\n        else if (which === KEY_DW) {\r\n          event.preventDefault();\r\n          if (!scope.showDropdown && scope.searchStr && scope.searchStr.length >= minlength) {\r\n            initResults();\r\n            scope.searching = true;\r\n            searchTimerComplete(scope.searchStr);\r\n          }\r\n        }\r\n        else if (which === KEY_ES) {\r\n          clearResults();\r\n          scope.$apply(function() {\r\n            inputField.val(scope.searchStr);\r\n          });\r\n        }\r\n        else {\r\n          if (minlength === 0 && !scope.searchStr) {\r\n            return;\r\n          }\r\n\r\n          if (!scope.searchStr || scope.searchStr === '') {\r\n            scope.showDropdown = false;\r\n          } else if (scope.searchStr.length >= minlength) {\r\n            initResults();\r\n\r\n            if (searchTimer) {\r\n              $timeout.cancel(searchTimer);\r\n            }\r\n\r\n            scope.searching = true;\r\n\r\n            searchTimer = $timeout(function() {\r\n              searchTimerComplete(scope.searchStr);\r\n            }, scope.pause);\r\n          }\r\n\r\n          if (validState && validState !== scope.searchStr && !scope.clearSelected) {\r\n            scope.$apply(function() {\r\n              callOrAssign();\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n      function cancelHttpRequest() {\r\n        if (httpCanceller) {\r\n          httpCanceller.resolve();\r\n        }\r\n      }\r\n\r\n      function handleOverrideSuggestions(event) {\r\n        if (scope.overrideSuggestions &&\r\n            !(scope.selectedObject && scope.selectedObject.originalObject === scope.searchStr)) {\r\n          if (event) {\r\n            event.preventDefault();\r\n          }\r\n\r\n          // cancel search timer\r\n          $timeout.cancel(searchTimer);\r\n          // cancel http request\r\n          cancelHttpRequest();\r\n\r\n          setInputString(scope.searchStr);\r\n        }\r\n      }\r\n\r\n      function dropdownRowOffsetHeight(row) {\r\n        var css = getComputedStyle(row);\r\n        return row.offsetHeight +\r\n          parseInt(css.marginTop, 10) + parseInt(css.marginBottom, 10);\r\n      }\r\n\r\n      function dropdownHeight() {\r\n        return dd.getBoundingClientRect().top +\r\n          parseInt(getComputedStyle(dd).maxHeight, 10);\r\n      }\r\n\r\n      function dropdownRow() {\r\n        return elem[0].querySelectorAll('.angucomplete-row')[scope.currentIndex];\r\n      }\r\n\r\n      function dropdownRowTop() {\r\n        return dropdownRow().getBoundingClientRect().top -\r\n          (dd.getBoundingClientRect().top +\r\n           parseInt(getComputedStyle(dd).paddingTop, 10));\r\n      }\r\n\r\n      function dropdownScrollTopTo(offset) {\r\n        dd.scrollTop = dd.scrollTop + offset;\r\n      }\r\n\r\n      function updateInputField(){\r\n        var current = scope.results[scope.currentIndex];\r\n        if (scope.matchClass) {\r\n          inputField.val(extractTitle(current.originalObject));\r\n        }\r\n        else {\r\n          inputField.val(current.title);\r\n        }\r\n      }\r\n\r\n      function keydownHandler(event) {\r\n        var which = ie8EventNormalizer(event);\r\n        var row = null;\r\n        var rowTop = null;\r\n\r\n        if (which === KEY_EN && scope.results) {\r\n          if (scope.currentIndex >= 0 && scope.currentIndex < scope.results.length) {\r\n            event.preventDefault();\r\n            scope.selectResult(scope.results[scope.currentIndex]);\r\n          } else {\r\n            handleOverrideSuggestions(event);\r\n            clearResults();\r\n          }\r\n          scope.$apply();\r\n        } else if (which === KEY_DW && scope.results) {\r\n          event.preventDefault();\r\n          if ((scope.currentIndex + 1) < scope.results.length && scope.showDropdown) {\r\n            scope.$apply(function() {\r\n              scope.currentIndex ++;\r\n              updateInputField();\r\n            });\r\n\r\n            if (isScrollOn) {\r\n              row = dropdownRow();\r\n              if (dropdownHeight() < row.getBoundingClientRect().bottom) {\r\n                dropdownScrollTopTo(dropdownRowOffsetHeight(row));\r\n              }\r\n            }\r\n          }\r\n        } else if (which === KEY_UP && scope.results) {\r\n          event.preventDefault();\r\n          if (scope.currentIndex >= 1) {\r\n            scope.$apply(function() {\r\n              scope.currentIndex --;\r\n              updateInputField();\r\n            });\r\n\r\n            if (isScrollOn) {\r\n              rowTop = dropdownRowTop();\r\n              if (rowTop < 0) {\r\n                dropdownScrollTopTo(rowTop - 1);\r\n              }\r\n            }\r\n          }\r\n          else if (scope.currentIndex === 0) {\r\n            scope.$apply(function() {\r\n              scope.currentIndex = -1;\r\n              inputField.val(scope.searchStr);\r\n            });\r\n          }\r\n        } else if (which === KEY_TAB) {\r\n          if (scope.results && scope.results.length > 0 && scope.showDropdown) {\r\n            if (scope.currentIndex === -1 && scope.overrideSuggestions) {\r\n              // intentionally not sending event so that it does not\r\n              // prevent default tab behavior\r\n              handleOverrideSuggestions();\r\n            }\r\n            else {\r\n              if (scope.currentIndex === -1) {\r\n                scope.currentIndex = 0;\r\n              }\r\n              scope.selectResult(scope.results[scope.currentIndex]);\r\n              scope.$digest();\r\n            }\r\n          }\r\n          else {\r\n            // no results\r\n            // intentionally not sending event so that it does not\r\n            // prevent default tab behavior\r\n            if (scope.searchStr && scope.searchStr.length > 0) {\r\n              handleOverrideSuggestions();\r\n            }\r\n          }\r\n        } else if (which === KEY_ES) {\r\n          // This is very specific to IE10/11 #272\r\n          // without this, IE clears the input text\r\n          event.preventDefault();\r\n        }\r\n      }\r\n \r\n      function processResults(responseData, str) {\r\n        var i, description, image, text, formattedText, formattedDesc;\r\n\r\n        if (responseData && responseData.length > 0) {\r\n          scope.results = [];\r\n\r\n          for (i = 0; i < responseData.length; i++) {\r\n            if (scope.titleField && scope.titleField !== '') {\r\n              text = formattedText = extractTitle(responseData[i]);\r\n            }\r\n\r\n            if(scope.subTitleField && scope.subTitleField !== ''){\r\n              var subTitleField = extractValue(responseData[i], scope.subTitleField);\r\n              if(subTitleField){\r\n                text += \"- \" + subTitleField;\r\n              }\r\n            }\r\n\r\n            description = '';\r\n            if (scope.descriptionField) {\r\n              description = formattedDesc = extractValue(responseData[i], scope.descriptionField);\r\n            }\r\n\r\n            image = '';\r\n            if (scope.imageField) {\r\n              image = extractValue(responseData[i], scope.imageField);\r\n            }\r\n\r\n            if (scope.matchClass) {\r\n              formattedText = findMatchString(text, str);\r\n              formattedDesc = findMatchString(description, str);\r\n            }\r\n\r\n            scope.results[scope.results.length] = {\r\n              title: formattedText,\r\n              description: formattedDesc,\r\n              image: image,\r\n              originalObject: responseData[i]\r\n            };\r\n          }\r\n\r\n        } else {\r\n          scope.results = [];\r\n        }\r\n\r\n        if (scope.autoMatch && scope.results.length === 1 &&\r\n            checkExactMatch(scope.results[0],\r\n              {title: text, desc: description || ''}, scope.searchStr)) {\r\n          scope.showDropdown = false;\r\n        } else if (scope.results.length === 0 && !displayNoResults) {\r\n          scope.showDropdown = false;\r\n        } else {\r\n          scope.showDropdown = true;\r\n        }\r\n        // return results limit lenght = 15\r\n        scope.results = scope.results.slice(0,15)\r\n      }\r\n\r\n      function httpSuccessCallbackGen(str) {\r\n        return function(responseData, status, headers, config) {\r\n          // normalize return obejct from promise\r\n          if (!status && !headers && !config && responseData.data) {\r\n            responseData = responseData.data;\r\n          }\r\n          scope.searching = false;\r\n          processResults(\r\n            extractValue(responseFormatter(responseData), scope.remoteUrlDataField),\r\n            str);\r\n        };\r\n      }\r\n\r\n      function httpErrorCallback(errorRes, status, headers, config) {\r\n        // cancelled/aborted\r\n        if (status === 0 || status === -1) { return; }\r\n\r\n        // normalize return obejct from promise\r\n        if (!status && !headers && !config) {\r\n          status = errorRes.status;\r\n        }\r\n        if (scope.remoteUrlErrorCallback) {\r\n          scope.remoteUrlErrorCallback(errorRes, status, headers, config);\r\n        }\r\n        else {\r\n          if (console && console.error) {\r\n            console.error('http error');\r\n          }\r\n        }\r\n      }\r\n\r\n      function getRemoteResults(str) {\r\n        var params = {},\r\n            url = scope.remoteUrl + encodeURIComponent(str);\r\n        if (scope.remoteUrlRequestFormatter) {\r\n          params = {params: scope.remoteUrlRequestFormatter(str)};\r\n          url = scope.remoteUrl;\r\n        }\r\n        if (!!scope.remoteUrlRequestWithCredentials) {\r\n          params.withCredentials = true;\r\n        }\r\n        cancelHttpRequest();\r\n        httpCanceller = $q.defer();\r\n        params.timeout = httpCanceller.promise;\r\n        $http.get(url, params)\r\n          .success(httpSuccessCallbackGen(str))\r\n          .error(httpErrorCallback);\r\n      }\r\n\r\n      function getRemoteResultsWithCustomHandler(str) {\r\n        cancelHttpRequest();\r\n\r\n        httpCanceller = $q.defer();\r\n\r\n        scope.remoteApiHandler(str, httpCanceller.promise)\r\n          .then(httpSuccessCallbackGen(str))\r\n          .catch(httpErrorCallback);\r\n\r\n        /* IE8 compatible\r\n        scope.remoteApiHandler(str, httpCanceller.promise)\r\n          ['then'](httpSuccessCallbackGen(str))\r\n          ['catch'](httpErrorCallback);\r\n        */\r\n      }\r\n\r\n      function getLocalResults(str) {\r\n        var i, match, s, value,\r\n            searchFields = scope.searchFields.split(','),\r\n            matches = [];\r\n        if (typeof scope.parseInput() !== 'undefined') {\r\n          str = scope.parseInput()(str);\r\n        }\r\n        for (i = 0; i < scope.localData.length; i++) {\r\n          match = false;\r\n\r\n          for (s = 0; s < searchFields.length; s++) {\r\n            value = extractValue(scope.localData[i], searchFields[s]) || '';\r\n            match = match || (value.toString().toLowerCase().indexOf(str.toString().toLowerCase()) >= 0);\r\n          }\r\n\r\n          if (match) {\r\n            matches[matches.length] = scope.localData[i];\r\n          }\r\n        }\r\n\r\n        scope.searching = false;\r\n        processResults(matches, str);\r\n      }\r\n\r\n      function checkExactMatch(result, obj, str){\r\n        if (!str) { return false; }\r\n        for(var key in obj){\r\n          if(obj[key].toLowerCase() === str.toLowerCase()){\r\n            scope.selectResult(result);\r\n            return true;\r\n          }\r\n        }\r\n        return false;\r\n      }\r\n\r\n      function showAll() {\r\n        if (scope.localData) {\r\n          processResults(scope.localData, '');\r\n        }\r\n        else if (scope.remoteApiHandler) {\r\n          getRemoteResultsWithCustomHandler('');\r\n        }\r\n        else {\r\n          getRemoteResults('');\r\n        }\r\n      }\r\n\r\n      scope.onFocusHandler = function() {\r\n        if (scope.focusIn) {\r\n          scope.focusIn();\r\n        }\r\n        if (minlength === 0 && (!scope.searchStr || scope.searchStr.length === 0)) {\r\n          scope.currentIndex = scope.focusFirst ? 0 : scope.currentIndex;\r\n          scope.showDropdown = true;\r\n          showAll();\r\n        }\r\n      };\r\n\r\n      scope.hideResults = function() {\r\n        if (mousedownOn &&\r\n            (mousedownOn === scope.id + '_dropdown' ||\r\n             mousedownOn.indexOf('angucomplete') >= 0)) {\r\n          mousedownOn = null;\r\n        }\r\n        else {\r\n          hideTimer = $timeout(function() {\r\n            clearResults();\r\n            scope.$apply(function() {\r\n              if (scope.searchStr && scope.searchStr.length > 0) {\r\n                inputField.val(scope.searchStr);\r\n              }\r\n            });\r\n          }, BLUR_TIMEOUT);\r\n          cancelHttpRequest();\r\n\r\n          if (scope.focusOut) {\r\n            scope.focusOut();\r\n          }\r\n\r\n          if (scope.overrideSuggestions) {\r\n            if (scope.searchStr && scope.searchStr.length > 0 && scope.currentIndex === -1) {\r\n              handleOverrideSuggestions();\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n      scope.resetHideResults = function() {\r\n        if (hideTimer) {\r\n          $timeout.cancel(hideTimer);\r\n        }\r\n      };\r\n\r\n      scope.hoverRow = function(index) {\r\n        scope.currentIndex = index;\r\n      };\r\n\r\n      scope.selectResult = function(result) {\r\n        // Restore original values\r\n        if (scope.matchClass) {\r\n          result.title = extractTitle(result.originalObject);\r\n          result.description = extractValue(result.originalObject, scope.descriptionField);\r\n        }\r\n\r\n        if (scope.clearSelected) {\r\n          scope.searchStr = null;\r\n        }\r\n        else {\r\n          scope.searchStr = result.title;\r\n        }\r\n        callOrAssign(result);\r\n        clearResults();\r\n      };\r\n\r\n      scope.inputChangeHandler = function(str) {\r\n        if (str.length < minlength) {\r\n          cancelHttpRequest();\r\n          clearResults();\r\n        }\r\n        else if (str.length === 0 && minlength === 0) {\r\n          scope.searching = false;\r\n          showAll();\r\n        }\r\n\r\n        if (scope.inputChanged) {\r\n          str = scope.inputChanged(str);\r\n        }\r\n        return str;\r\n      };\r\n\r\n      // check required\r\n      if (scope.fieldRequiredClass && scope.fieldRequiredClass !== '') {\r\n        requiredClassName = scope.fieldRequiredClass;\r\n      }\r\n\r\n      // check min length\r\n      if (scope.minlength && scope.minlength !== '') {\r\n        minlength = parseInt(scope.minlength, 10);\r\n      }\r\n\r\n      // check pause time\r\n      if (!scope.pause) {\r\n        scope.pause = PAUSE;\r\n      }\r\n\r\n      // check clearSelected\r\n      if (!scope.clearSelected) {\r\n        scope.clearSelected = false;\r\n      }\r\n\r\n      // check override suggestions\r\n      if (!scope.overrideSuggestions) {\r\n        scope.overrideSuggestions = false;\r\n      }\r\n\r\n      // check required field\r\n      if (scope.fieldRequired && ctrl) {\r\n        // check initial value, if given, set validitity to true\r\n        if (scope.initialValue) {\r\n          handleRequired(true);\r\n        }\r\n        else {\r\n          handleRequired(false);\r\n        }\r\n      }\r\n\r\n      scope.inputType = attrs.type ? attrs.type : 'text';\r\n\r\n      // set strings for \"Searching...\" and \"No results\"\r\n      scope.textSearching = attrs.textSearching ? attrs.textSearching : TEXT_SEARCHING;\r\n      scope.textNoResults = attrs.textNoResults ? attrs.textNoResults : TEXT_NORESULTS;\r\n      displaySearching = scope.textSearching === 'false' ? false : true;\r\n      displayNoResults = scope.textNoResults === 'false' ? false : true;\r\n\r\n      // set max length (default to maxlength deault from html\r\n      scope.maxlength = attrs.maxlength ? attrs.maxlength : MAX_LENGTH;\r\n\r\n      // register events\r\n      inputField.on('keydown', keydownHandler);\r\n      inputField.on('keyup', keyupHandler);\r\n\r\n      // set response formatter\r\n      responseFormatter = callFunctionOrIdentity('remoteUrlResponseFormatter');\r\n\r\n      // set isScrollOn\r\n      $timeout(function() {\r\n        var css = getComputedStyle(dd);\r\n        isScrollOn = css.maxHeight && css.overflowY === 'auto';\r\n      });\r\n    }\r\n\r\n    return {\r\n      restrict: 'EA',\r\n      require: '^?form',\r\n      scope: {\r\n        selectedObject: '=',\r\n        disableInput: '=',\r\n        initialValue: '=',\r\n        localData: '=',\r\n        remoteUrlRequestFormatter: '=',\r\n        remoteUrlRequestWithCredentials: '@',\r\n        remoteUrlResponseFormatter: '=',\r\n        remoteUrlErrorCallback: '=',\r\n        remoteApiHandler: '=',\r\n        id: '@',\r\n        type: '@',\r\n        placeholder: '@',\r\n        remoteUrl: '@',\r\n        remoteUrlDataField: '@',\r\n        titleField: '@',\r\n        descriptionField: '@',\r\n        imageField: '@',\r\n        inputClass: '@',\r\n        pause: '@',\r\n        searchFields: '@',\r\n        minlength: '@',\r\n        matchClass: '@',\r\n        clearSelected: '@',\r\n        overrideSuggestions: '@',\r\n        fieldRequired: '=',\r\n        fieldRequiredClass: '@',\r\n        inputChanged: '=',\r\n        autoMatch: '@',\r\n        focusOut: '&',\r\n        focusIn: '&',\r\n        inputName: '@',\r\n        focusFirst: '@',\r\n        parseInput: '&',\r\n        subTitleField: '@'\r\n      },\r\n      templateUrl: function(element, attrs) {\r\n        return attrs.templateUrl || TEMPLATE_URL;\r\n      },\r\n      compile: function(tElement) {\r\n        var startSym = $interpolate.startSymbol();\r\n        var endSym = $interpolate.endSymbol();\r\n        if (!(startSym === '{{' && endSym === '}}')) {\r\n          var interpolatedHtml = tElement.html()\r\n            .replace(/\\{\\{/g, startSym)\r\n            .replace(/\\}\\}/g, endSym);\r\n          tElement.html(interpolatedHtml);\r\n        }\r\n        return link;\r\n      }\r\n    };\r\n  }]);\n'use strict';\r\nangular.module('trainingModule').config(function ($routeProvider, $sceDelegateProvider, localStorageServiceProvider)\r\n{\r\n    $routeProvider.when('/training',\r\n            {\r\n                templateUrl: 'app/modules/training/views/trainingRoom.html',\r\n                controller: 'TrainingRoomController',\r\n                controllerAs: 'app/modules/training/controllers/trainingRoom'\r\n            });\r\n\r\n});\n'use strict';\r\nangular.module('mainModule').config(function ($routeProvider) {\r\n    $routeProvider.when('/home', {\r\n        templateUrl: 'app/modules/main/views/main.html',\r\n        controller: 'HomeController',\r\n        controllerAs: 'app/modules/main/controllers/main'\r\n    })\r\n    .when('/trustedlogin', {\r\n        templateUrl: 'app/modules/main/views/trustedlogin.html',\r\n        controller: 'TrustedLoginController',\r\n        controllerAs: 'app/modules/main/controllers/trustedlogin'\r\n    });  \r\n});\n'use strict';\r\nangular.module('conferenceModule').config(function ($routeProvider, $sceDelegateProvider, localStorageServiceProvider)\r\n{\r\n    $routeProvider.when('/room',\r\n            {\r\n                templateUrl: 'app/modules/conference/views/room.html',\r\n                controller: 'RoomController',\r\n                controllerAs: 'app/modules/conference/controllers/room'\r\n            });\r\n\r\n});\n'use strict';\nangular.module('config', [])\n  .constant('apiUrl', \"https://training.demo.vietinterview.com:9444/api\")\n  .constant('socketUrl', \"wss://training.demo.vietinterview.com:9444/one2many\")\n  .constant('iceServers', [{\"url\":\"turn:125.212.233.5:3478?transport=udp\",\"credential\":\"123456\",\"username\":\"quang\"}])\n  .constant('enabledLog', true);\n\n/**\r\n * @author thanhvk\r\n * created on 30.09.2016\r\n */\r\n'use strict';\r\n\r\nangular.module('app')\r\n    .service('sharedProperties', function () {\r\n        var objectValue = null;\r\n\r\n        return {\r\n            setObject: function(obj) {\r\n                objectValue = obj;\r\n            },\r\n            getObject: function () {\r\n                return objectValue;\r\n            }            \r\n        };\r\n    });\r\nangular.module('app')    \r\n    .service('viMdToast', function($mdToast) {\r\n        var position        = 'top right',\r\n            timeDelay       = 2000,\r\n            errorClass      = 'vi-toast-danger',\r\n            successClass    = 'vi-toast-success';\r\n\r\n        function showToast(msg, msgClass) {\r\n            $mdToast.show(\r\n                $mdToast.simple()\r\n                    .textContent(msg)\r\n                    .position(position)\r\n                    .toastClass(msgClass)\r\n                    .hideDelay(timeDelay)\r\n            );\r\n        }\r\n        \r\n        function error(msg) {\r\n            showToast(msg, errorClass);\r\n        }\r\n\r\n        function success(msg) {\r\n            showToast(msg, successClass);\r\n        }\r\n\r\n        return {\r\n            error: error,\r\n            success: success\r\n        };\r\n    });\n'use strict';\r\n\r\nangular\r\n    .module('app')\r\n    .run(function ($log) {\r\n    $log.debug('Application started');\r\n});\r\n\r\n\n'use strict';\r\nangular.module('app').config(function ($routeProvider)\r\n{\r\n    $routeProvider.when('/', {\r\n        templateUrl: 'app/modules/main/views/main.html',\r\n        controller: 'HomeController',\r\n        controllerAs: 'app/modules/main/controllers/main'\r\n    });\r\n});\r\n\n/**\r\n * @author thanhvk\r\n * created on 10.10.2016\r\n */\r\n 'use strict';\r\n\r\nangular.module('app')\r\n.filter('decodeBase64', ['$base64', function($base64) {\r\n    return function(base64Str) {\r\n        var url = '';\r\n\r\n        if (base64Str) {\r\n            url = $base64.decode(base64Str);\r\n        }\r\n\r\n        return url;\r\n    }   \r\n}]);\n'use strict';\r\nangular.module('app')\r\n.config(function ($logProvider, $mdThemingProvider, $mdIconProvider, $translateProvider, \r\n        toastrConfig, enabledLog,$activityIndicatorProvider) {\r\n    // Enable log\r\n    $logProvider.debugEnabled(enabledLog);\r\n    // Set options third-party lib\r\n        toastrConfig.allowHtml = true;\r\n      toastrConfig.timeOut = 3000;\r\n      toastrConfig.positionClass = 'toast-top-right';\r\n      toastrConfig.preventDuplicates = true;\r\n      toastrConfig.closeButton = true;\r\n      toastrConfig.progressBar = true;\r\n    // Enable multi-language\r\n    $translateProvider.useStaticFilesLoader({\r\n        prefix:'./assets/locale/locale-',\r\n        suffix: '.json'\r\n    });\r\n    $translateProvider.preferredLanguage('vi');\r\n    $translateProvider.fallbackLanguage('vi');\r\n    $activityIndicatorProvider.setActivityIndicatorStyle('SpinnerDark');\r\n\r\n});\nangular.module(\"app\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/modules/admin/views/adminAuthView.html\",\"<main class=auth-main layout=column layout-align=\\\"center center\\\" ng-keypress=loginAccountKeyPress($event)><div class=auth-block><div class=\\\"md-display-1 vi-center auth-admin-logo\\\"><img src=assets/images/logo_trananh.jpg alt=\\\"\\\"></div><form name=authForm><md-input-container class=md-block><label>Email</label><input name=email ng-model=auth.emailLogin required><div ng-messages=authForm.email.$error><div ng-message=required>{{\\\"auth.required\\\" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>{{\\\"auth.password\\\" | translate}}</label><input name=password type=password ng-model=auth.passwordLogin required><div ng-messages=authForm.password.$error><div ng-message=required>{{\\\"auth.required\\\" | translate}}</div></div></md-input-container><md-button ng-click=loginAccount() class=\\\"md-raised md-primary vi-btn-reset\\\">{{\\\"auth.login\\\" | translate}}</md-button></form></div></main>\");\n$templateCache.put(\"app/modules/admin/views/adminCreateRoomView.html\",\"<div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/toolbarView.html\\'\\\"></div><div layout=row flex><md-sidenav class=\\\"md-whiteframe-2dp md-sidenav-left vi-sidenav\\\" md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\" md-whiteframe=4><div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/roomsListView.html\\'\\\"></div></md-sidenav><md-content flex id=content><div layout=row><h3 class=\\\"md-display-1 vi-row vi-headline\\\">{{\\\"admin.roomsList.createTitle\\\" | translate}}</h3></div><div layout=row class=\\\"room-info vi-row vi-col\\\"><div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/roomFormView.html\\'\\\"></div></div></md-content></div>\");\n$templateCache.put(\"app/modules/admin/views/adminEditRoomView.html\",\"<div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/toolbarView.html\\'\\\"></div><div layout=row flex><md-sidenav class=\\\"md-whiteframe-2dp md-sidenav-left vi-sidenav\\\" md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\" md-whiteframe=4><div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/roomsListView.html\\'\\\"></div></md-sidenav><md-content flex id=content><div layout=row><h3 class=\\\"md-display-1 vi-row vi-headline\\\">{{\\\"admin.roomsList.editTitle\\\" | translate}} \\\"{{room.name}}\\\"</h3></div><div layout=row class=\\\"room-info vi-row vi-col\\\"><md-tabs flex md-dynamic-height md-border-bottom><md-tab label=\\\"{{\\'admin.roomsList.room\\' | translate}}\\\"><md-content class=md-padding><div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/roomFormView.html\\'\\\"></div></md-content></md-tab><md-tab label=\\\"{{\\'admin.roomsList.member\\' | translate}}\\\"><md-content class=md-padding><h3 class=md-title>{{\\\"admin.roomsList.totalMembers\\\" | translate}}: {{membersList.length | number}}</h3><div layout=row><div flex=30><div class=vi-panel><md-list class=vi-members-list><md-list-item class=md-2-line ng-repeat=\\\"member in membersList\\\" ng-click=showMemberDetail(member)><div class=\\\"md-list-item-text vi-member-item\\\"><h3 class=\\\"md-title vi-member-name\\\">{{member.name}}</h3><p class=vi-member-email>{{member.role}}</p></div></md-list-item></md-list><p style=text-align:center ng-show=\\\"membersList.length == 0\\\">{{\\\"admin.roomsList.addMemberMsg\\\" | translate}}</p></div></div><div flex=70 class=vi-row><!-- Begin btn group --><div layout=row class=vi-btn-group-member><div flex=70 layout=row layout-align=start><md-button class=\\\"md-raised vi-btn vi-warn\\\" ng-click=showEditMemberForm(); style=\\\"margin-left: 0\\\"><i class=\\\"fa fa-pencil\\\" aria-hidden=true></i> {{\\\"admin.roomsList.edit\\\" | translate}}</md-button><md-button class=\\\"md-raised vi-btn vi-success\\\" ng-click=showAddMemberForm();><i class=\\\"fa fa-plus\\\" aria-hidden=true></i> {{\\\"admin.roomsList.add\\\" | translate}}</md-button></div><div flex=30 layout=row layout-align=end><md-button class=\\\"md-raised vi-btn vi-danger\\\" style=\\\"margin-right: 0\\\" ng-click=removeMember();><i class=\\\"fa fa-times\\\" aria-hidden=true></i> {{\\\"admin.roomsList.add\\\" | translate}}</md-button></div></div><!-- End btn group --><!-- Begin user info panel --><div class=vi-panel><div ng-show=!showMemberForm><md-list ng-show=member><md-list-item layout=row class=md-1-line><div flex=20 class=vi-title>{{\\\"admin.roomsList.memberName\\\" | translate}}</div><div flex=80>{{member.name}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=20 class=vi-title>{{\\\"admin.roomsList.memberRole\\\" | translate}}</div><div flex=80>{{member.name}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=20 class=vi-title>Email</div><div flex=80>{{member.email}}</div></md-list-item></md-list><p style=text-align:center ng-show=!member>{{\\\"admin.roomsList.chooseMember\\\" | translate}}</p></div><!-- Begin form edit user --><form name=memberForm ng-show=showMemberForm class=vi-col><div layout=row><md-input-container flex=60 class=md-block><label>{{\\\"admin.roomsList.memberName\\\" | translate}}</label><input name=name ng-model=member.name required><div ng-messages=memberForm.name.$error><div ng-message=required>This is required!</div></div></md-input-container><md-input-container flex class=md-block><label>{{\\\"admin.roomsList.memberRole\\\" | translate}}</label><md-select ng-model=member.role><md-option value=presenter>Presenter</md-option><md-option value=member>Member</md-option></md-select></md-input-container></div><div layout=row><md-input-container flex=60 class=md-block><label>Email</label><input name=email ng-model=member.email required><div ng-messages=memberForm.email.$error><div ng-message=required>{{\\\"admin.roomsList.required\\\" | translate}}</div></div></md-input-container><md-input-container flex class=md-block><label>{{\\\"auth.password\\\" | translate}}</label><input name=password type=password ng-model=member.password required><div ng-messages=\\\"memberForm.password.$error && !member.password\\\"><div ng-message=required>{{\\\"admin.roomsList.required\\\" | translate}}</div></div></md-input-container></div><div layout=row><md-button ng-click=cancelMember() class=\\\"md-raised vi-btn vi-danger\\\">{{\\\"admin.roomsList.cancel\\\" | translate}}</md-button><md-button ng-click=saveMember() class=\\\"md-raised md-primary\\\">{{\\\"admin.roomsList.save\\\" | translate}}</md-button></div></form><!-- End form edit user --></div><!-- End user info panel --></div></div></md-content></md-tab></md-tabs></div></md-content></div>\");\n$templateCache.put(\"app/modules/admin/views/adminRoomsListView.html\",\"<div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/toolbarView.html\\'\\\"></div><div layout=row flex><md-sidenav class=\\\"md-whiteframe-2dp md-sidenav-left vi-sidenav\\\" md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\" md-whiteframe=4><div style=\\\"width: 100%\\\" ng-include=\\\"\\'app/modules/admin/views/shared/roomsListView.html\\'\\\"></div></md-sidenav><md-content flex id=content class=content-admin-rooms-list><div layout=row class=\\\"vi-btn-group vi-btn-group-room\\\"><div flex=70 layout=row layout-align=start><md-button class=\\\"md-raised vi-btn vi-warn\\\" ng-click=gotoEditRoom();><i class=\\\"fa fa-pencil\\\" aria-hidden=true></i> {{\\\"admin.roomsList.edit\\\" | translate}}</md-button><md-button ng-href=#/admin/rooms/create class=\\\"md-raised vi-btn vi-success\\\"><i class=\\\"fa fa-plus\\\" aria-hidden=true></i> {{\\\"admin.roomsList.create\\\" | translate}}</md-button></div><!-- <div flex=\\\"30\\\" layout=\\\"row\\\" layout-align=\\\"end\\\">\\r\\n        <md-button class=\\\"md-raised vi-btn vi-danger\\\">\\r\\n          <i class=\\\"fa fa-ban\\\" aria-hidden=\\\"true\\\"></i> Close\\r\\n        </md-button>\\r\\n      </div>  --></div><div layout=row><h3 flex=60 flex-xs=100 class=\\\"md-display-1 vi-row vi-headline\\\">{{\\\"admin.roomsList.totalRooms\\\" | translate}}: {{roomsList.length | number}}</h3><div flex=40 flex-xs=100 style=\\\"margin: 0 15px\\\"><!-- <show-bandwidth class=\\\"bandwidth vi-right\\\"></show-bandwidth> --></div></div><div layout=row layout-xs=column><div flex=50 flex-xs=100 class=\\\"vi-panel vi-row vi-col\\\"><h3 class=md-headline>{{room.name ? room.name : \\\"admin.roomsList.chooseRoom\\\" | translate}}</h3><div layout=column><md-list ng-show=room><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Room Id</div><div flex=70>{{room._id}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Room Reference</div><div flex=70>{{room.meetingRef}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>{{\\\"admin.roomsList.duration\\\" | translate}}</div><div flex=70>{{room.duration ? room.duration : \\\"\\\" | number}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>{{\\\"admin.roomsList.status\\\" | translate}}</div><div flex=70>{{room.active ? \\\"active\\\" : \\\"inactive\\\"}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Logout Url</div><div flex=70 style=\\\"word-wrap: break-word\\\">{{room.logoutUrl ? room.logoutUrl : \\\"\\\" | decodeBase64}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Welcome title</div><div flex=70>{{room.welcome ? room.welcome : \\\"\\\"}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>{{\\\"admin.roomsList.totalMembers\\\" | translate}}</div><div flex=70>{{room.membersList.length | number}}</div></md-list-item></md-list></div></div><div flex=50 flex-xs=100 class=\\\"vi-panel vi-row vi-col members-list\\\"><h3 class=md-headline>{{\\\"admin.roomsList.membersList\\\" | translate}}</h3><md-list class=vi-members-list><md-list-item class=\\\"md-3-line vi-md-list-user-item\\\" ng-repeat=\\\"member in room.membersList\\\"><div class=\\\"md-list-item-text vi-member-item\\\"><h3 class=\\\"md-title vi-member-name\\\">{{member.name}}</h3><p>{{member.email}}</p><p class=vi-member-email>{{member.role}}</p></div></md-list-item></md-list></div></div></md-content></div>\");\n$templateCache.put(\"app/modules/conference/views/room.html\",\"<!-- Start toolbar --><md-toolbar layout=row class=\\\"md-toolbar-tools vi-toolbar\\\"><div flex=30><!-- <button hide-gt-sm class=\\\"vi-center menuBtn\\\" ng-click=\\\"toggleSidenav(\\'left\\')\\\" aria-label=\\\"Toggle Menu\\\">\\r\\n            <i class=\\\"fa fa-bars\\\" aria-hidden=\\\"true\\\"></i>\\r\\n        </button> --> <img src=assets/images/logo_trananh_blue.png alt=Trananh style=\\\"width: 200px\\\"></div><div flex=40 flex-sm=40 flex-xs=40 class=vi-center><h2 class=\\\"md-display-1 vi-logo\\\">{{meeting.name}}</h2></div><div flex=30 class=vi-right><ul class=\\\"list-inline vi-nav-right\\\"><li class=vi-nav-right-item ng-show=\\\"me.profile.role==\\'presenter\\'\\\" ng-click=endLesson()><i class=\\\"fa fa-hourglass-end\\\" aria-hidden=true></i> <span>{{\\\"conference.endLesson\\\" | translate}}</span></li><li ng-click=leave() class=vi-nav-right-item><i class=\\\"fa fa-sign-out\\\" aria-hidden=true></i> <span>{{\\\"conference.logout\\\" | translate}}</span></li></ul></div></md-toolbar><!-- End toolbar --><div layout=row><!-- Start sidebar --><md-sidenav class=\\\"md-sidenav-left vi-sidenav\\\" md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\"><div class=\\\"panel panel-info\\\" style=\\\"height: 100%; padding: 0px; margin: 0px\\\"><div class=\\\"localCameraDiv box\\\" style=\\\"width: 100%; margin: auto\\\"><div align=center class=web-cam><video id=localCamera autoplay muted poster=assets/images/avatar-03.png></video></div><div class=\\\"btn-local-group-video vi-center\\\"><span ng-click=toggleAudio() class=vi-icon ng-class=\\\"audio?\\'icon-on\\':\\'icon-off\\'\\\" style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-microphone\\\"></i><md-tooltip>{{video ? \\'conference.offVolume\\' : \\'conference.offVolume\\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleVideo() class=vi-icon ng-class=\\\"video?\\'icon-on\\':\\'icon-off\\'\\\" style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-camera\\\"></i><md-tooltip>{{video ? \\'conference.offCamera\\' : \\'conference.onCamera\\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleHand() ng-show=\\\"me.profile.role!=\\'presenter\\'\\\" class=vi-icon ng-class=\\\"handUp?\\'icon-on\\':\\'icon-off\\'\\\" style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-hand-paper-o\\\"></i></span></div><div class=vi-center><md-button class=\\\"md-fab md-mini\\\" aria-label=Connect ng-click=connect() ng-disabled=me.pubState ng-class=\\\"\\'btn-icon-on\\'\\\"><i class=\\\"fa fa-volume-control-phone\\\"></i><md-tooltip>{{ \\'conference.connect\\' | translate}}</md-tooltip></md-button><md-button class=\\\"md-fab md-mini\\\" aria-label=Disconnect ng-click=disconnect() ng-disabled=!me.pubState ng-class=\\\"\\'btn-icon-off\\'\\\"><i class=\\\"glyphicon glyphicon-phone-alt\\\"></i><md-tooltip>{{ \\'conference.disconnect\\' | translate}}</md-tooltip></md-button></div></div><div class=panel-body style=\\\"height: 100%\\\"><ul class=\\\"list-unstyled members-list-room box\\\"><li class=title>{{\\\"conference.presenter\\\" | translate}}</li><li class=content><span ng-class=\\\"presenter.online ? \\'fa fa-circle vi-online\\' : \\'fa fa-circle vi-offline\\'\\\" aria-hidden=true></span> {{presenter.profile.name}}</li><li class=title>{{\\\"conference.learners\\\" | translate}} <span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" class=\\\"fa fa-hand-paper-o btn-handup\\\" ng-class=\\\"!notiHandUp ? \\'icon-on animated infinite bounce\\' : \\'icon-off\\'\\\" style=\\\"cursor: pointer; float: right; margin-left: 10px\\\" aria-hidden=true ng-click=\\\"\\\"></span></li><li class=content style=\\\"position: relative\\\" ng-repeat=\\\"viewer in viewerList\\\"><span ng-class=\\\"viewer.online ? \\'fa fa-circle vi-online\\' : \\'fa fa-circle vi-offline\\'\\\" aria-hidden=true></span> {{viewer.profile.name}} <span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" class=\\\"fa fa-video-camera\\\" ng-class=\\\"viewer.invited ? \\'icon-on\\' : \\'icon-off\\'\\\" style=\\\"cursor: pointer; float: right; margin-left: 10px\\\" aria-hidden=true ng-click=memberInvite(viewer.id)></span> <span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" class=\\\"fa fa-hand-paper-o btn-handup\\\" ng-class=\\\"viewer.handUp ? \\'icon-on animated infinite bounce\\' : \\'icon-off\\'\\\" style=\\\"cursor: pointer; float: right; margin-left: 10px\\\" aria-hidden=true ng-click=\\\"\\\"></span></li></ul></div></div></md-sidenav><!-- End sidebar --><section layout=row flex class=content-wrapper><!-- <div class=\\\"overlay\\\" ng-show=\\\"!me.pubState\\\"></div> --><!-- Start conference board --><md-content flex><div class=main-content><!-- <div class=\\\"presenter main box conference-board\\\" layout=\\\"row\\\" layout-wrap> --><div class=\\\"main box conference-board\\\" layout=row layout-wrap><div flex={{firstSlot}} class=video-wrapper><md-progress-circular ng-show=\\\"presenter.subState == 1 || presenter.subState == 2\\\" class=\\\"md-hue-2 md-warn progress\\\" md-diameter=30px></md-progress-circular><video id=remoteCamera0 controls poster=assets/images/avatar-03.png autoplay></video><div layout=row class=abs-bar><div flex=60><span class=label-name>{{presenter.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(presenter.id) class=btn-refresh style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-refresh\\\"></i><md-tooltip>Refresh video</md-tooltip></span></div></div></div><div flex={{slot.width}} class=video-wrapper ng-show=slot.allocated ng-repeat=\\\"slot in videoSlots | filter:byIndex\\\"><md-progress-circular ng-show=\\\"slot.member.subState == 1 || slot.member.subState == 2\\\" class=\\\"md-hue-2 md-warn progress\\\" md-diameter=30px></md-progress-circular><video ng-attr-id=\\\"{{ \\'remoteCamera\\' + ($index+1) }}\\\" controls autoplay poster=assets/images/avatar-03.png style=\\\"width: 100%\\\"></video><div layout=row class=abs-bar><div flex=60><span class=label-name>{{slot.member.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(slot.member.id) class=btn-refresh style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-refresh\\\"></i><md-tooltip md-direction=left>Refresh video</md-tooltip></span><span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" ng-click=memberDiscard(slot) class=\\\"btn-close vi-center\\\"><i class=\\\"fa fa-times fa-lg\\\"></i><md-tooltip md-direction=right>Close</md-tooltip></span></div></div></div></div></div></md-content><!-- End conference board --><!-- Start chat panel --><md-sidenav class=\\\"md-sidenav-right vi-chat-sidenav\\\" md-is-locked-open=\\\"$mdMedia(\\'min-width: 400px\\')\\\" md-component-id=right><div class=\\\"chat-content-wrapper box\\\"><div class=\\\"chat-content box\\\" style=\\\"overflow-y: auto\\\"><div class=chat-box-title>Chat box</div><ul class=\\\"messages-list list-unstyled\\\"><li class=\\\"md-1-line message-item\\\" ng-repeat=\\\"msg in chatMessage\\\"><div class=md-list-item-text><span class=user>{{msg.user}}: </span><span class=message>{{msg.text}}</span></div></li></ul></div><div layout=row class=\\\"input-message-group-training box\\\" ng-keypress=sendChatMessage($event)><md-input-container flex=80><label>{{\\\"conference.chatMsg\\\" | translate}}</label><input type=text ng-model=chatInput></md-input-container><div flex=20 class=btn-send-wrapper><md-button class=\\\"md-fab md-primary\\\" aria-label=\\\"Send message\\\" ng-click=chat()><i class=\\\"fa fa-paper-plane\\\" aria-hidden=true></i></md-button></div></div></div></md-sidenav><!-- End chat panel --></section></div>\");\n$templateCache.put(\"app/modules/main/views/main.html\",\"<main class=auth-main layout=column layout-align=\\\"center center\\\" ng-keypress=loginMeetingKeyPress($event)><div class=auth-block><div class=\\\"md-display-1 vi-center auth-room-logo\\\"><img src=assets/images/logo_trananh.jpg alt=\\\"\\\"></div><form name=authMeetingForm><md-input-container class=md-block><label>RoomId</label><input name=roomId ng-model=meetingAuth.meetingId required><div ng-messages=authMeetingForm.roomId.$error><div ng-message=required>{{\\\"auth.required\\\" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>Email</label><input name=email ng-model=meetingAuth.email required><div ng-messages=authMeetingForm.email.$error><div ng-message=required>{{\\\"auth.required\\\" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>{{\\\"auth.password\\\" | translate}}</label><input name=password type=password ng-model=meetingAuth.password required><div ng-messages=authMeetingForm.password.$error><div ng-message=required>{{\\\"auth.required\\\" | translate}}</div></div></md-input-container><md-radio-group ng-model=meetingAuth.kind layout=row class=md-block><md-radio-button flex value=training class=md-primary>Training</md-radio-button><md-radio-button flex value=conference class=md-primary>Conference</md-radio-button></md-radio-group><md-button ng-click=loginMeeting() class=\\\"md-raised md-primary vi-btn-reset btn-login\\\">{{\\\"auth.login\\\" | translate}}</md-button></form></div></main>\");\n$templateCache.put(\"app/modules/main/views/trustedlogin.html\",\"<main class=\\\"auth-main auth-main-trusted\\\" layout=column layout-align=\\\"center center\\\" ng-keypress=loginMeetingKeyPress($event)><div class=auth-block-trusted layout=row><div class=vi-col flex=60 flex-xs=100 flex-offset=40 flex-offset-xs=0><img class=logo-trusted src=assets/images/logo_trananh_white_color.png alt=VietInterview><h3 class=md-headline>{{\\\"training.title\\\" | translate}}</h3><md-button class=\\\"md-raised btn-trusted vi-btn-reset\\\" ng-click=loginMeeting()>{{\\\"training.enter\\\" | translate}}</md-button></div></div></main>\");\n$templateCache.put(\"app/modules/training/views/trainingRoom.html\",\"<!-- Start toolbar --><md-toolbar layout=row class=\\\"md-toolbar-tools vi-toolbar\\\"><div flex=30><!-- <button hide-gt-sm class=\\\"vi-center menuBtn\\\" ng-click=\\\"toggleSidenav(\\'left\\')\\\" aria-label=\\\"Toggle Menu\\\">\\r\\n            <i class=\\\"fa fa-bars\\\" aria-hidden=\\\"true\\\"></i>\\r\\n        </button> --> <img src=assets/images/logo_trananh_blue.png alt=Trananh style=\\\"width: 200px\\\"></div><div flex=40 flex-sm=40 flex-xs=40 class=vi-center><h2 class=\\\"md-display-1 vi-logo\\\">{{meeting.name}}</h2></div><div flex=30 class=vi-right><ul class=\\\"list-inline vi-nav-right\\\"><li class=vi-nav-right-item ng-show=\\\"me.profile.role==\\'presenter\\'\\\" ng-click=endLesson()><i class=\\\"fa fa-hourglass-end\\\" aria-hidden=true></i> <span>{{\\\"conference.endLesson\\\" | translate}}</span></li><li ng-click=leave() class=vi-nav-right-item><i class=\\\"fa fa-sign-out\\\" aria-hidden=true></i> <span>{{\\\"conference.logout\\\" | translate}}</span></li></ul></div></md-toolbar><!-- End toolbar --><div layout=row flex><!-- Start sidebar --><md-sidenav class=\\\"md-sidenav-left vi-sidenav\\\" md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\"><div class=\\\"panel panel-info\\\" style=\\\"height: 100%; padding: 0px; margin: 0px\\\"><div class=\\\"localCameraDiv box\\\" style=\\\"width: 100%; margin: auto\\\"><div align=center class=web-cam><video id=localCamera autoplay muted poster=assets/images/avatar-03.png></video></div><div class=\\\"btn-local-group-video vi-center\\\"><span ng-click=toggleAudio() class=vi-icon ng-class=\\\"audio?\\'icon-on\\':\\'icon-off\\'\\\" style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-microphone\\\"></i><md-tooltip>{{video ? \\'conference.offVolume\\' : \\'conference.offVolume\\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleVideo() class=vi-icon ng-class=\\\"video?\\'icon-on\\':\\'icon-off\\'\\\" style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-camera\\\"></i><md-tooltip>{{video ? \\'conference.offCamera\\' : \\'conference.onCamera\\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleHand() ng-show=\\\"me.profile.role!=\\'presenter\\'\\\" class=vi-icon ng-class=\\\"handUp?\\'icon-on\\':\\'icon-off\\'\\\" style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-hand-paper-o\\\"></i></span></div><div class=vi-center><md-button class=\\\"md-fab md-mini\\\" aria-label=Connect ng-click=connect() ng-disabled=me.pubState ng-class=\\\"\\'btn-icon-on\\'\\\"><i class=\\\"fa fa-volume-control-phone\\\"></i><md-tooltip>{{ \\'conference.connect\\' | translate}}</md-tooltip></md-button><md-button class=\\\"md-fab md-mini\\\" aria-label=Disconnect ng-click=disconnect() ng-disabled=!me.pubState ng-class=\\\"\\'btn-icon-off\\'\\\"><i class=\\\"glyphicon glyphicon-phone-alt\\\"></i><md-tooltip>{{ \\'conference.disconnect\\' | translate}}</md-tooltip></md-button></div></div><div class=panel-body style=\\\"height: 100%\\\"><ul class=\\\"list-unstyled members-list-room box\\\"><li class=title>{{\\\"conference.presenter\\\" | translate}}</li><li class=content><span ng-class=\\\"presenter.online ? \\'fa fa-circle vi-online\\' : \\'fa fa-circle vi-offline\\'\\\" aria-hidden=true></span> {{presenter.profile.name}}</li><li class=title>{{\\\"conference.learners\\\" | translate}} <span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" class=\\\"fa fa-hand-paper-o btn-handup\\\" ng-class=\\\"!notiHandUp ? \\'icon-on animated infinite bounce\\' : \\'icon-off\\'\\\" style=\\\"cursor: pointer; float: right; margin-left: 10px\\\" aria-hidden=true ng-click=\\\"\\\"></span></li><li class=content style=\\\"position: relative\\\" ng-repeat=\\\"viewer in viewerList\\\"><span ng-class=\\\"viewer.online ? \\'fa fa-circle vi-online\\' : \\'fa fa-circle vi-offline\\'\\\" aria-hidden=true></span> {{viewer.profile.name}} <span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" class=\\\"fa fa-video-camera\\\" ng-class=\\\"viewer.invited ? \\'icon-on\\' : \\'icon-off\\'\\\" style=\\\"cursor: pointer; float: right; margin-left: 10px\\\" aria-hidden=true ng-click=memberInvite(viewer.id)></span> <span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" class=\\\"fa fa-hand-paper-o btn-handup\\\" ng-class=\\\"viewer.handUp ? \\'icon-on animated infinite bounce\\' : \\'icon-off\\'\\\" style=\\\"cursor: pointer; float: right; margin-left: 10px\\\" aria-hidden=true ng-click=\\\"\\\"></span></li></ul></div></div></md-sidenav><!-- End sidebar --><section layout=row flex class=content-wrapper><div class=overlay ng-show=!me.pubState></div><!-- Start conference board --><md-content flex><div class=main-content><div class=my-pdf-container><div class=\\\"toolbar-pdf-viewer box\\\" layout=row ng-show=\\\"me.profile.role==\\'presenter\\'\\\"><div flex=30><md-button class=\\\"md-raised vi-success vi-btn\\\" ngf-select=uploadDoc($file) ngf-max-size=10MB><i class=\\\"fa fa-plus\\\" aria-hidden=true></i> Upload</md-button></div><div flex=40 class=vi-center><md-button class=\\\"md-raised vi-btn-default\\\" ng-click=pdfPrev()><i class=\\\"fa fa-chevron-left\\\" aria-hidden=true></i></md-button><input type=text class=\\\"vi-input vi-pdf-input\\\" ng-value=\\\"currPage + \\'/\\' + totalPages\\\"><md-button class=\\\"md-raised vi-btn-default\\\" ng-click=pdfNext()><i class=\\\"fa fa-chevron-right\\\" aria-hidden=true></i></md-button></div><div flex=30 class=vi-right><md-button class=\\\"md-raised vi-btn-default\\\" ng-click=zoomOut(0.1)><i class=\\\"fa fa-search-minus\\\" aria-hidden=true></i></md-button><input flex=60 class=\\\"vi-input vi-pdf-input\\\" type=text ng-value=\\\"zoom + \\'%\\'\\\" disabled><md-button class=\\\"md-raised vi-btn-default\\\" ng-click=zoomIn(0.1)><i class=\\\"fa fa-search-plus\\\" aria-hidden=true></i></md-button></div></div><div style=\\\"margin-top: 5px\\\" class=\\\"pdf-content box vi-center\\\"><pdf-viewer delegate-handle=my-pdf-container url=pdfUrl scale=.9 show-toolbar=false headers=\\\"{ \\'x-you-know-whats-awesome\\': \\'EVERYTHING\\' }\\\"></pdf-viewer></div></div></div></md-content><!-- End conference board --><!-- Start chat panel --><md-sidenav class=\\\"md-sidenav-right vi-chat-sidenav vi-chat-sidenav-training\\\" md-is-locked-open=\\\"$mdMedia(\\'min-width: 280px\\')\\\" md-component-id=right><div class=\\\"presenter main box video-wrapper\\\" layout=row layout-wrap ng-show=\\\"me.profile.role!=\\'presenter\\'\\\"><!-- <div ng-show=\\\"presenter.subState == 1 || presenter.subState == 2\\\" \\r\\n                    ng-activity-indicator skip-ng-show=\\\"yes\\\"\\r\\n                    ng-class=\\\"toggleVideoFlag ? \\'hide-panel\\' : \\'\\'\\\"></div> --><md-progress-circular ng-show=\\\"presenter.subState == 1 || presenter.subState == 2\\\" class=\\\"md-hue-2 md-warn progress\\\" ng-class=\\\"toggleVideoFlag ? \\'hide-panel\\' : \\'\\'\\\" md-diameter=30px></md-progress-circular><video id=remoteCamera0 controls poster=assets/images/conference-01.png autoplay style=\\\"min-height: 180px\\\" ng-class=\\\"toggleVideoFlag ? \\'hide-panel\\' : \\'\\'\\\"></video><div layout=row class=btn-group-video ng-class=\\\"!toggleVideoFlag ? \\'abs-bar\\' : \\'static-bar\\'\\\"><div flex=60><span class=label-name>{{\\\"conference.presenter\\\" | translate}}: {{presenter.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(presenter.id) class=btn-refresh style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-refresh\\\"></i><md-tooltip>{{\\'training.refresh\\' | translate}}</md-tooltip></span><span ng-click=toggleMainVideo() class=btn-collapse style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-minus\\\" aria-hidden=true></i><md-tooltip>{{\\'training.collapse\\' | translate}}</md-tooltip></span></div></div></div><md-tabs md-dynamic-height=\\\"\\\" md-border-bottom=\\\"\\\" class=box><md-tab label=Chat><md-content class=md-padding><div class=\\\"chat-content chat-content-training box\\\" style=\\\"overflow-y: auto\\\"><div class=chat-box-title>Chat box</div><ul class=\\\"messages-list list-unstyled\\\"><li class=\\\"md-1-line message-item\\\" ng-repeat=\\\"msg in chatMessage\\\"><div class=md-list-item-text><span class=user>{{msg.user}}: </span><span class=message>{{msg.text}}</span></div></li></ul></div><div layout=row class=\\\"input-message-group-training box\\\" ng-keypress=sendChatMessage($event)><md-input-container flex=80><label>{{\\\"conference.chatMsg\\\" | translate}}</label><input type=text ng-model=chatInput></md-input-container><div flex=20 class=btn-send-wrapper><md-button class=\\\"md-fab md-primary\\\" aria-label=\\\"Send message\\\" ng-click=chat()><i class=\\\"fa fa-paper-plane\\\" aria-hidden=true></i></md-button></div></div></md-content></md-tab><md-tab label=Videos><md-content class=md-padding><div layout=row layout-wrap class=\\\"participant main members-video-panel members-video-training-panel\\\"><div flex=50 class=\\\"video-member video-wrapper\\\" ng-show=slot.allocated ng-repeat=\\\"slot in videoSlots | filter:byIndex\\\"><!--  <div ng-show=\\\"slot.member.subState ==1 || slot.member.subState ==2 \\\" ng-activity-indicator skip-ng-show=\\\"yes\\\"></div> --><md-progress-circular ng-show=\\\"slot.member.subState == 1 || slot.member.subState == 2\\\" class=\\\"md-hue-2 md-warn progress\\\" md-diameter=30px></md-progress-circular><video ng-attr-id=\\\"{{ \\'remoteCamera\\' + ($index+1) }}\\\" controls autoplay poster=assets/images/avatar_1.png style=\\\"width: 100%\\\"></video><div layout=row class=abs-bar><div flex=60><span class=label-name>{{slot.member.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(slot.member.id) class=btn-refresh style=\\\"cursor: pointer\\\"><i class=\\\"fa fa-refresh\\\"></i> </span><span ng-show=\\\"me.profile.role==\\'presenter\\'\\\" ng-click=memberDiscard(slot) class=\\\"btn-close vi-center\\\"><i class=\\\"fa fa-times fa-lg\\\"></i></span></div></div></div><div flex=50 ng-hide=\\\"countAllocated == 1\\\"><img src=assets/images/video-placeholder.png style=\\\"width: 100%; display: block; margin-bottom: 5px\\\"></div><div flex=50 ng-hide=\\\"countAllocated == 2\\\"><img src=assets/images/video-placeholder.png style=\\\"width: 100%; display: block; margin-bottom: 5px\\\"></div><div flex=50 ng-hide=\\\"countAllocated == 3\\\"><img src=assets/images/video-placeholder.png style=\\\"width: 100%; display: block; margin-bottom: 5px\\\"></div></div></md-content></md-tab></md-tabs></md-sidenav><!-- End chat panel --></section></div>\");\n$templateCache.put(\"app/shared/directives/showBandwidth/showBandwidthView.html\",\"<div layout=row><!-- <span>{{\\\"directives.showBandwidth.speed\\\" | translate}}: {{speedDownMbps | number}}Mbps</span> --><div flex=50 class=progress-speed><span class=begin>0</span> <span class=end>30</span><md-progress-linear md-mode=determinate value={{speedDownMbps}}></md-progress-linear></div><div flex=50>{{speedDownMbpsOri}} Mbps <button class=\\\"vi-center menuBtn\\\" style=\\\"margin-left: 10px\\\" aria-label=\\\"Network speed\\\" ng-click=measureDownloadSpeedAverage();><i style=color:#2196F3 class=\\\"fa fa-clock-o fa-lg\\\" aria-hidden=true></i><!-- <md-tooltip md-direction=\\\"bottom\\\">\\r\\n              {{\\\"directives.showBandwidth.test\\\" | translate}}\\r\\n            </md-tooltip> --></button></div></div>\");\n$templateCache.put(\"app/modules/admin/views/shared/roomFormView.html\",\"<form name=creatRoomForm><md-input-container class=md-block><label>{{\\\"admin.roomsList.nameRoom\\\" | translate}}</label><input name=name type=text ng-model=room.name required><div ng-messages=creatRoomForm.name.$error><div ng-message=required>{{\\\"admin.roomsList.required\\\" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>Room Refercence</label><input name=meetingRef type=text ng-model=room.meetingRef required><div ng-messages=creatRoomForm.meetingRef.$error><div ng-message=required>{{\\\"admin.roomsList.required\\\" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>{{\\\"admin.roomsList.duration\\\" | translate}}</label><input name=duration type=number ng-model=room.duration required><div ng-messages=creatRoomForm.duration.$error><div ng-message=required>{{\\\"admin.roomsList.required\\\" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>Logout Url</label><input name=logoutUrl type=text ng-model=room.logoutUrl></md-input-container><md-input-container class=md-block><label>Webcome title</label><input name=welcome type=text ng-model=room.welcome></md-input-container><md-button ng-click=cancel() class=\\\"md-raised vi-btn vi-danger\\\">{{\\\"admin.roomsList.cancel\\\" | translate}}</md-button><md-button ng-click=save() class=\\\"md-raised md-primary\\\">{{\\\"admin.roomsList.save\\\" | translate}}</md-button></form>\");\n$templateCache.put(\"app/modules/admin/views/shared/roomsListView.html\",\"<md-list class=rooms-list><md-list-item ng-repeat=\\\"room in roomsList\\\"><span style=\\\"margin-top: -15px\\\" ng-class=\\\"room.active ? \\'fa fa-circle vi-online\\' : \\'fa fa-circle vi-offline\\'\\\" aria-hidden=true></span><md-button ng-click=showRoomDetail(room)><h3 class=md-title>{{room.name}}</h3><div class=room-status-group><span>RefId: {{room.meetingRef}}</span></div></md-button></md-list-item></md-list>\");\n$templateCache.put(\"app/modules/admin/views/shared/toolbarView.html\",\"<md-toolbar layout=row class=\\\"md-toolbar-tools vi-toolbar\\\"><div flex hide-gt-sm><button class=\\\"vi-center menuBtn\\\" ng-click=\\\"toggleSidenav(\\'left\\')\\\" aria-label=\\\"Toggle Menu\\\"><i class=\\\"fa fa-bars\\\" aria-hidden=true></i></button></div><h2 flex class=\\\"md-display-1 vi-logo\\\">Vietinterview <span hide-sm hide-xs>- Conference Room</span></h2><ul flex class=\\\"list-inline vi-right\\\"><li><a href=#/admin/home>Home</a></li><li><a href=#/admin/rooms>Admin</a></li></ul></md-toolbar>\");}]);"],"sourceRoot":"/source/"}