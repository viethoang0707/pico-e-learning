"use strict";angular.module("app",["ngAnimate","ngCookies","ngSanitize","ngMessages","ngAria","ngRoute","ngLocale","toastr","pascalprecht.translate","ui.bootstrap","ui.router","underscore","FBAngular","ui.bootstrap.datetimepicker","pageslide-directive","angular-simple-chat","ngAudio","LocalStorageModule","ngFileUpload","ui.select","ngFileSaver","base64","textAngular","ng.deviceDetector","timer","ngMaterial","ngMessages","pascalprecht.translate","ngActivityIndicator","pdf","config","api","mainModule","adminModule","conferenceModule","trainingModule"]),angular.module("app").directive("showBandwidth",["$http","$q","$location","$timeout",function(e,t,n,i){return{restrict:"E",templateUrl:"app/shared/directives/showBandwidth/showBandwidthView.html",link:function(o){function a(){var n,a,l=t.defer();return n=(new Date).getTime(),e({method:"GET",url:r}).then(function(e){a=(new Date).getTime();var t=(a-n)/1e3,r=8*s,d=(r/t).toFixed(2),c=(d/1024).toFixed(2),m=(c/1024).toFixed(2);i(function(){0===o.speedDownMbps?(o.speedDownMbpsOri=Number(m),o.speedDownMbps=3*o.speedDownMbpsOri):(m=(o.speedDownMbpsOri+Number(m))/2,o.speedDownMbpsOri=Number(m.toFixed(2)),o.speedDownMbps=3*o.speedDownMbpsOri),l.resolve()},60)},function(e){l.resolve(null)}),l.promise}var r=n.protocol()+"://"+n.host()+":"+n.port()+"/assets/images/hybrid.jpg",s=23670,l=[];o.measureDownloadSpeedAverage=function(){o.speedDownMbpsOri=0,o.speedDownMbps=0;for(var e=0;100>e;e++)l.push(a);l.reduce(function(e,t){return e.then(function(){return t()})},t.resolve())},o.measureDownloadSpeedAverage()}}}]),angular.module("api",["config","blockUI"]),angular.module("api").factory("$member",["http",function(e){return{addMember:function(t,n){var i="/member",o={token:t.token,meetingId:t.meetingId,member:angular.toJson(t.member)};e.postRequest(i,o,n)},updateMember:function(t,n){var i="/member",o={token:t.token,meetingId:t.meetingId,member:angular.toJson(t.member)};e.putRequest(i,o,n)},removeMember:function(t,n){var i="/member",o={token:t.token,id:t.id};e.deleteRequest(i,o,n)},listMember:function(t,n){var i="/member",o={token:t.token,meetingId:t.meetingId};e.getRequest(i,o,n)},login:function(t,n){var i="/member/login",o={meetingId:t.meetingId,email:t.email,password:t.password};e.postRequest(i,o,n)},trustedLogin:function(t,n){var i="/trusted/login",o={payload:t.payload,checksum:t.checksum};e.postRequest(i,o,n)}}}]),angular.module("api").factory("$meeting",["http",function(e){return{createMeeting:function(t,n){var i="/meeting",o={token:t.token,meeting:angular.toJson(t.meeting)};e.postRequest(i,o,n)},updateMeeting:function(t,n){var i="/meeting",o={token:t.token,meeting:angular.toJson(t.meeting)};e.putRequest(i,o,n)},endMeeting:function(t,n){var i="/meeting/end",o={token:t.token,id:t.meetingId};e.postRequest(i,o,n)},listMeeting:function(t,n){var i="/meeting/",o={token:t.token};e.getRequest(i,o,n)},getMeeting:function(t,n){var i="/meeting/",o={token:t.token,id:t.meetingId};e.getRequest(i,o,n)},setMeetingConfig:function(t,n){var i="/meeting/config",o={token:t.token,config:t.config};e.putRequest(i,o,n)},getMeetingConfig:function(t,n){var i="/meeting/config",o={token:t.token};e.getRequest(i,o,n)},uploadFile:function(t,n){var i="/meeting/upload",o=t.file;e.uploadRequest(i,o,n)}}}]),angular.module("api").factory("$auth",["http",function(e){return{loginAccount:function(t,n){var i="/auth/local",o={email:t.email,password:t.password};e.postRequest(i,o,n)}}}]),angular.module("api").factory("$trainingSocket",["$log","trainingSocketUrl",function(e,t){try{var n=new WebSocket(t);return n}catch(i){return e.error("Cannot connect to server"),null}}]).factory("$conferenceSocket",["$log","conferenceSocketUrl",function(e,t){try{var n=new WebSocket(t);return n}catch(i){return e.error("Cannot connect to server"),null}}]),angular.module("api").factory("http",["$http","apiUrl","blockUI","$log",function(e,t,n,i){var o=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};return{postRequest:function(a,r,s){var l=t+a,d={method:"POST",url:l,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},transformRequest:o,timeout:3e5,data:r};n.start(),i.info("POST request: "+d.data),e(d).then(function(e){200===e.status&&(n.stop(),s("boolean"!=typeof e.data.result||e.data.result?{status:!0,data:e.data}:{status:!1}))},function(e){n.stop(),i.error(e),s({status:!1})})},getRequest:function(a,r,s){var l=t+a,d={method:"GET",url:l,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},transformRequest:o,params:r};n.start(),i.info("GET request: "+d.params),e(d).then(function(e){n.stop(),200===e.status&&s("boolean"!=typeof e.data.result||e.data.result?{status:!0,data:e.data}:{status:!1})},function(e){n.stop(),i.error(e),s({status:!1})})},putRequest:function(a,r,s){var l=t+a,d={method:"PUT",url:l,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},transformRequest:o,data:r};i.info("PUT request: "+d.params),n.start(),e(d).then(function(e){n.stop(),200===e.status&&s("boolean"!=typeof e.data.result||e.data.result?{status:!0,data:e.data}:{status:!1})},function(e){n.stop(),i.error(e),s({status:!1})})},deleteRequest:function(a,r,s){var l=t+a,d={method:"DELETE",url:l,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},transformRequest:o,data:r};i.info("DELETE request: "+d.data),n.start(),e(d).then(function(e){200===e.status&&(n.stop(),s("boolean"!=typeof e.data.result||e.data.result?{status:!0,data:e.data}:{status:!1}))},function(e){n.stop(),i.error(e),s({status:!1})})},uploadRequest:function(e,o,a){var r=t+e,s=new XMLHttpRequest,l=new FormData;s.open("POST",r,!0),n.start(),i.info("UPLOAD request: "+e),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&(n.stop(),a({status:!0,data:angular.fromJson(s.responseText)}))},l.append("file",o),s.send(l)}}}]),angular.module("trainingModule",["api","toastr","config","underscore","LocalStorageModule","pageslide-directive","base64","angular-simple-chat","ngAudio","ngActivityIndicator"]),angular.module("trainingModule").controller("TrainingRoomController",["$scope","$rootScope","$location","$routeParams","_","localStorageService","$log","$interval","$sce","$trainingSocket","$window","deviceDetector","iceServers","$recorder","$mdSidenav","$base64","$timeout","ngAudio","$activityIndicator","toastr","$route","pdfDelegate","$meeting",function(e,t,n,i,o,a,r,s,l,d,c,m,u,p,g,f,v,h,b,w,y,S,x){function k(e,t){this.id=e,this.avail=!1,this.profile=t,this.invited=!1,this.pubWebRtcEndpoint=null,this.pubOfferSdp=null,this.pubState=J,this.pubGatherToken=null,this.pubTimeoutToken=null,this.pubCandidateSendQueue=[],this.subWebRtcEndpoint=null,this.subOfferSdp=null,this.subState=Z,this.subGatherToken=null,this.subCandidateSendQueue=[],this.pubCamera=null,this.subVideoSlot=null,this.markedForSubscription=!1}function $(){e.audio=!0,e.video=!0,e.handUp=!0,e.notiHandUp=!0,e.toggleVideoFlag=!1,e.sound=h.load("assets/sounds/ring.mp3"),e.pdfUrl="assets/images/Intro.pdf",e.zoom=90,e.countAllocated=0,e.meeting=a.get("meeting"),e.myProfile=a.get("member"),e.memberProfiles=a.get("memberList"),e.memberList=[],e.videoSlots=[],e.chatMessage=[];var t=0;o.each(e.memberProfiles,function(n){e.memberList.push(new k(n._id,n)),e.videoSlots.push({allocated:!1,videoId:"remoteCamera"+t,index:t,member:null}),t++}),e.me=o.find(e.memberList,function(t){return t.id==e.myProfile._id}),e.me.pubCamera=document.getElementById("localCamera"),e.presenter=o.find(e.memberList,function(e){return"presenter"==e.profile.role}),e.presenter.subVideoSlot=e.videoSlots[0],e.viewerList=o.filter(e.memberList,function(e){return"presenter"!=e.profile.role})}function R(t){t.memberId=e.me.id,t.meetingId=e.meeting._id;var n=JSON.stringify(t);r.info("Senging message: "+n);try{d.send(n)}catch(i){r.info("Error sending message: "),c.location.reload()}}function C(e){"accepted"==e.response?(L(),z(e.whiteboard)):n.path("/")}function L(){var t={localVideo:localCamera,onicecandidate:I,iceServers:u,oncandidategatheringdone:A};e.me.pubWebRtcEndpoint=kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(t,function(e){return e?(b.stopAnimating(),void r.error(e)):void this.generateOffer(M)}),b.startAnimating(),e.me.pubGatherToken=v(function(){e.me.pubState!=Y&&(e.me.pubState=Y,E())},ie)}function I(t){e.me.pubCandidateSendQueue.push(t)}function M(t,n){return t?(b.stopAnimating(),void r.info(t)):void(e.me.pubOfferSdp=n)}function U(t){b.stopAnimating(),"accepted"!=t.response?(r.info("Disconnect due to reject from server"),e.disconnect()):(e.me.pubWebRtcEndpoint.processAnswer(t.sdpAnswer),o.each(t.candidateList,function(t){e.me.pubWebRtcEndpoint.addIceCandidate(t)}),R({id:"publishAvail"}),e.me.pubState=X,e.sound.stop())}function A(){v.cancel(e.me.pubGatherToken),e.me.pubState!=Y&&(e.me.pubState=Y,E())}function E(){if(!e.me.pubOfferSdp||!e.me.pubCandidateSendQueue.length)return r.info("Disconnect due to device error"),void e.disconnect();var t={id:"publish",sdpOffer:e.me.pubOfferSdp,candidateList:e.me.pubCandidateSendQueue};R(t),e.me.pubOfferSdp=null,e.me.pubCandidateSendQueue=[],e.me.pubTimeoutToken=v(function(){e.me.pubState!=X&&(r.info("Disconnect due to calling timeout"),e.disconnect())},oe)}function D(t){if(t.markedForSubscription=!1,t.subVideoSlot){t.subState=Z,t.id!=e.presenter.id&&(t.subVideoSlot.allocated&&e.countAllocated--,t.subVideoSlot.allocated=!1,t.subVideoSlot.member=null,t.subVideoSlot=null),t.subGatherToken&&v.cancel(t.subGatherToken);try{t.subWebRtcEndpoint&&t.subWebRtcEndpoint.peerConnection.close()}catch(n){r.error(n)}}}function T(t){if(e.me.avail){var n=null;if(n=t.subVideoSlot?t.subVideoSlot:o.find(e.videoSlots,function(e){return!e.allocated&&e.index>0})){t.id!==e.presenter.id&&e.countAllocated++,t.subVideoSlot=n,n.member=t,n.allocated=!0,t.subState=ee;var i=document.getElementById(n.videoId),a={remoteVideo:i,onicecandidate:F.bind({member:t}),iceServers:u,oncandidategatheringdone:O.bind({member:t})};t.subGatherToken=v(function(e){e.subState!=te&&(P(e),e.subState=te)},ie,!0,t),t.subWebRtcEndpoint=kurentoUtils.WebRtcPeer.WebRtcPeerRecvonly(a,function(e){return e?void r.error(e):void this.generateOffer(q.bind({member:t}))})}}}function F(e){this.member.subCandidateSendQueue.push(e)}function q(e,t){return e?void r.error(e):void(this.member.subSdpOffer=t)}function V(t){var n=o.find(e.memberList,function(e){return e.id==t.pubId});"accepted"!=t.response?(n.subState=Z,w.error("Server error, please try again later")):(n.subWebRtcEndpoint.processAnswer(t.sdpAnswer),n.id==e.me.id&&(n.subWebRtcEndpoint.remoteVideo.muted=!0),n.subVideoSlot&&(n.subState=ne,o.each(t.candidateList,function(e){n.subWebRtcEndpoint.addIceCandidate(e)}),R({id:"subscribeAvail",pubId:t.pubId})),H())}function O(){v.cancel(this.member.subGatherToken),this.member.subState!=te&&(P(this.member),this.member.subState=te)}function P(e){if(!e.subSdpOffer||!e.subCandidateSendQueue.length)return void w.error("Device error");var t={id:"subscribe",pubId:e.id,sdpOffer:e.subSdpOffer,candidateList:e.subCandidateSendQueue};R(t),e.subSdpOffer=null,e.subCandidateSendQueue=[]}function B(t){var n="/";if(e.meeting.logoutUrl){var i=decodeURIComponent(e.meeting.logoutUrl);n=f.decode(i)}c.location.href=n}function W(e){_(e.onlineList)}function H(){var t=o.find(e.memberList,function(e){return e.markedForSubscription});t&&(t.markedForSubscription=!1,T(t))}function _(t){var n=[];o.each(e.memberList,function(e){var i=o.find(t,function(t){return e.id==t._id});i?(e.avail=i.avail,e.invited=i.invited,e.online=!0,e.invited?e.avail?(e.subVideoSlot||(e.markedForSubscription=!0),e.subVideoSlot&&e.subState==Z&&(e.markedForSubscription=!0)):e.subVideoSlot&&n.push(e):n.push(e)):(e.invited&&n.push(e),e.invited=!1,e.avail=!1,e.online=!1)}),o.each(n,function(e){D(e)}),H()}function j(t){e.chatMessage.push({user:t.user,text:t.text})}function z(e){o.each(e,function(e){G(e.event,e.object),Q()})}function N(e,t){G(e,t),Q()}function G(e,t){"insertSlide"==e&&S.$getByHandle("my-pdf-container").load(t),"nextSlidePage"==e&&S.$getByHandle("my-pdf-container").next(),"prevSlidePage"==e&&S.$getByHandle("my-pdf-container").next(),"zoomOutSlide"==e&&S.$getByHandle("my-pdf-container").zoomOut(),"zoomInSlide"==e&&S.$getByHandle("my-pdf-container").zoomIn()}function Q(){e.currPage=S.$getByHandle("my-pdf-container").getCurrentPage(),e.totalPages=S.$getByHandle("my-pdf-container").getPageCount()}var J=0,K=1,Y=2,X=3,Z=0,ee=1,te=2,ne=3,ie=3e4,oe=3e4;e.connect=function(){1==d.readyState?(R({id:"join"}),e.sound.loop=!0,e.sound.play(),e.me.pubState=K):c.location.reload()},e.disconnect=function(){e.me.pubState=J,e.sound.stop();try{e.me.pubWebRtcEndpoint&&e.me.pubWebRtcEndpoint.peerConnection.close(),o.each(e.memberList,function(e){e.subState!=Z&&D(e)}),R({id:"leave"})}catch(t){r.error(t)}},d.onmessage=function(t){var n=JSON.parse(t.data);switch(console.info("Received message: "+t.data),n.id){case"joinResponse":C(n);break;case"end":B();break;case"memberStatus":W(n);break;case"handUp":ae(n);break;case"handDown":re(n);break;case"publishResponse":U(n);break;case"subscribeResponse":V(n);break;case"chat":j(n);break;case"whiteboard":N(n.event,n.object);break;default:console.error("Unrecognized message",n)}e.$apply()},e.resubscribe=function(t){var n=o.find(e.memberList,function(e){return e.id==t});n.invited&&n.avail&&(D(n),T(n))},e.leave=function(){var t="/";if(e.meeting.logoutUrl){var n=decodeURIComponent(e.meeting.logoutUrl);t=f.decode(n)}R({id:"leave"}),c.location.href=t},e.endLesson=function(){R({id:"end"})},e.toggleAudio=function(){var t=e.me.pubWebRtcEndpoint.getLocalStream();if(t){var n=t.getAudioTracks()[0];e.audio=!e.audio,n.enabled=e.audio}},e.toggleVideo=function(){var t=e.me.pubWebRtcEndpoint.getLocalStream();if(t){var n=t.getVideoTracks()[0];e.video=!e.video,n.enabled=e.video}},e.toggleHand=function(){e.handUp=!e.handUp,e.notiHandUp=!1,R(e.handUp?{id:"handDown"}:{id:"handUp"})},e.toggleSidenav=function(e){g(e).toggle()},e.toggleMainVideo=function(){e.toggleVideoFlag=!e.toggleVideoFlag},e.memberInvite=function(t){if(!(e.countAllocated>3)){e.notiHandUp=!0;var n=o.find(e.memberList,function(e){return e.id==t});n.handUp=!1,!n.invited&&n.online&&R({id:"invite",inviteeId:n.id})}},e.memberDiscard=function(t){var n=t.member;n&&(e.countAllocated--,n.handUp=!1,R({id:"discard",inviteeId:n.id}))};var ae=function(t){var n=o.find(e.memberList,function(e){return e.id==t.memberId});n.handUp=!0},re=function(t){var n=o.find(e.memberList,function(e){return e.id==t.memberId});n.handUp=!1};e.chat=function(){var t={id:"chat",text:e.chatInput};R(t),e.chatInput=""},e.sendChatMessage=function(t){"Enter"===event.code&&e.chat()},e.byIndex=function(e){return e.index>0},t.$on("$routeChangeStart",function(e,t,n){n||d.close()}),c.onbeforeunload=function(){d.close(),s.cancel(recordToken)},$(),e.pdfNext=function(){S.$getByHandle("my-pdf-container").next(),Q(),R({id:"whiteboard",event:"nextSlidePage",object:null})},e.pdfPrev=function(){S.$getByHandle("my-pdf-container").prev(),Q(),R({id:"whiteboard",event:"prevSlidePage",object:null})},e.zoomOut=function(){S.$getByHandle("my-pdf-container").zoomOut(),R({id:"whiteboard",event:"zoomOutSlide",object:null}),e.zoom=50===e.zoom?50:e.zoom-10},e.zoomIn=function(){S.$getByHandle("my-pdf-container").zoomIn(),R({id:"whiteboard",event:"zoomInSlide",object:null}),e.zoom+=10},e.uploadDoc=function(t){console.log("file",t),t&&x.uploadFile({file:t},function(t){t.status&&t.data.status&&(console.log("url",t.data.url),e.pdfUrl=t.data.url,e.$apply(),S.$getByHandle("my-pdf-container").load(t.data.url),R({id:"whiteboard",event:"insertSlide",object:t.data.url}))})}}]),angular.module("mainModule",["api","toastr","config","underscore","LocalStorageModule","pascalprecht.translate","base64"]),angular.module("mainModule").controller("TrustedLoginController",["$rootScope","$scope","$member","$location","$log","$routeParams","viMdToast","Fullscreen","localStorageService","$base64",function(e,t,n,i,o,a,r,s,l,d){t.trustedLoginKind="training",t.loginMeeting=function(){s.all();var e={payload:d.decode(a.payload),checksum:a.checksum};n.trustedLogin(e,function(e){e.status&&e.data.status?(l.set("meeting",e.data.meeting),l.set("member",e.data.member),l.set("memberList",e.data.memberList),"conference"===a.kind?i.path("/room"):i.path("/training")):(o.error(e),r.error("Đã có lỗi xảy ra!"))})},t.loginMeetingKeyPress=function(e){"Enter"===e.code&&t.loginMeeting()}}]),angular.module("mainModule").controller("HomeController",["$rootScope","$scope","$member","$location","$log","viMdToast","Fullscreen","localStorageService",function(e,t,n,i,o,a,r,s){t.meetingAuth={kind:"conference"},t.loginMeeting=function(){r.all();var e={meetingId:t.meetingAuth.meetingId,email:t.meetingAuth.email,password:t.meetingAuth.password};n.login(e,function(e){e.status&&e.data.status?(s.set("meeting",e.data.meeting),s.set("member",e.data.member),s.set("memberList",e.data.memberList),"training"===t.meetingAuth.kind?i.path("/training"):i.path("/room")):(o.error(e),a.error("Input incorrect!"))})},t.loginMeetingKeyPress=function(e){"Enter"===e.code&&t.loginMeeting()}}]),angular.module("conferenceModule",["api","toastr","config","underscore","LocalStorageModule","pageslide-directive","base64","angular-simple-chat","ngAudio","ngActivityIndicator"]),angular.module("conferenceModule").controller("RoomController",["$scope","$rootScope","$location","$routeParams","_","localStorageService","$log","$interval","$sce","$conferenceSocket","$window","$mdDialog","deviceDetector","iceServers","$recorder","$mdSidenav","$base64","$timeout","ngAudio","$activityIndicator","toastr","$route",function(e,t,n,i,o,a,r,s,l,d,c,m,u,p,g,f,v,h,b,w,y,S){function x(e,t){this.id=e,this.avail=!1,this.profile=t,this.invited=!1,this.pubWebRtcEndpoint=null,this.pubOfferSdp=null,this.pubState=N,this.pubGatherToken=null,this.pubTimeoutToken=null,this.pubCandidateSendQueue=[],this.subWebRtcEndpoint=null,this.subOfferSdp=null,this.subState=K,this.subGatherToken=null,this.subCandidateSendQueue=[],this.pubCamera=null,this.subVideoSlot=null,this.markedForSubscription=!1}function k(){e.audio=!0,e.video=!0,e.handUp=!0,e.notiHandUp=!0,e.sound=b.load("assets/sounds/ring.mp3"),e.meeting=a.get("meeting"),e.myProfile=a.get("member"),e.memberProfiles=a.get("memberList"),e.memberList=[],e.videoSlots=[],e.chatMessage=[];var t=0;o.each(e.memberProfiles,function(n){e.memberList.push(new x(n._id,n)),e.videoSlots.push({allocated:!1,videoId:"remoteCamera"+t,index:t,member:null,width:0}),t++}),e.me=o.find(e.memberList,function(t){return t.id==e.myProfile._id}),e.me.pubCamera=document.getElementById("localCamera"),e.presenter=o.find(e.memberList,function(e){return"presenter"==e.profile.role}),e.presenter.subVideoSlot=e.videoSlots[0],e.viewerList=o.filter(e.memberList,function(e){return"presenter"!=e.profile.role})}function $(t){t.memberId=e.me.id,t.meetingId=e.meeting._id;var n=JSON.stringify(t);r.info("Senging message: "+n);try{d.send(n)}catch(i){r.info("Error sending message: "),c.location.reload()}}function R(e){"accepted"==e.response?C():n.path("/")}function C(){var t={localVideo:localCamera,onicecandidate:L,iceServers:p,oncandidategatheringdone:U};e.me.pubWebRtcEndpoint=kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(t,function(e){return e?(w.stopAnimating(),void r.error(e)):void this.generateOffer(I)}),w.startAnimating(),e.me.pubGatherToken=h(function(){e.me.pubState!=Q&&(e.me.pubState=Q,A())},ee)}function L(t){e.me.pubCandidateSendQueue.push(t)}function I(t,n){return t?(w.stopAnimating(),void r.info(t)):void(e.me.pubOfferSdp=n)}function M(t){w.stopAnimating(),"accepted"!=t.response?(r.info("Disconnect due to reject from server"),e.disconnect()):(e.me.pubWebRtcEndpoint.processAnswer(t.sdpAnswer),o.each(t.candidateList,function(t){e.me.pubWebRtcEndpoint.addIceCandidate(t)}),$({id:"publishAvail"}),e.me.pubState=J,e.sound.stop())}function U(){h.cancel(e.me.pubGatherToken),e.me.pubState!=Q&&(e.me.pubState=Q,A())}function A(){if(!e.me.pubOfferSdp||!e.me.pubCandidateSendQueue.length)return r.info("Disconnect due to device error"),void e.disconnect();var t={id:"publish",sdpOffer:e.me.pubOfferSdp,candidateList:e.me.pubCandidateSendQueue};$(t),e.me.pubOfferSdp=null,e.me.pubCandidateSendQueue=[],e.me.pubTimeoutToken=h(function(){e.me.pubState!=J&&(r.info("Disconnect due to calling timeout"),e.disconnect())},te)}function E(t){if(t.markedForSubscription=!1,t.subVideoSlot){t.subState=K,t.id!=e.presenter.id&&(t.subVideoSlot.allocated=!1,t.subVideoSlot.member=null,t.subVideoSlot=null),t.subGatherToken&&h.cancel(t.subGatherToken);try{t.subWebRtcEndpoint&&t.subWebRtcEndpoint.peerConnection.close()}catch(n){r.error(n)}}}function D(t){if(e.me.avail){var n=null;if(n=t.subVideoSlot?t.subVideoSlot:o.find(e.videoSlots,function(e){return!e.allocated&&e.index>0})){t.subVideoSlot=n,n.member=t,n.allocated=!0,t.subState=Y,e.numOfAllocated=F(e.videoSlots).length,T(3,e.numOfAllocated,e.videoSlots);var i=document.getElementById(n.videoId),a={remoteVideo:i,onicecandidate:q.bind({member:t}),iceServers:p,oncandidategatheringdone:P.bind({member:t})};t.subGatherToken=h(function(e){e.subState!=X&&(B(e),e.subState=X)},ee,!0,t),t.subWebRtcEndpoint=kurentoUtils.WebRtcPeer.WebRtcPeerRecvonly(a,function(e){return e?void r.error(e):void this.generateOffer(V.bind({member:t}))})}}}function T(t,n,i){var o=Math.floor(n/t);0===o?1===n?e.firstSlot=100:2===n&&(e.firstSlot=Math.floor(50),i.map(function(e){e.allocated&&(e.width=Math.floor(50))})):i.map(function(n){n.allocated&&(n.width=Math.floor(100/t),e.firstSlot=n.width)})}function F(e){var t=o.filter(e,function(e){return e.allocated});return t}function q(e){this.member.subCandidateSendQueue.push(e)}function V(e,t){return e?void r.error(e):void(this.member.subSdpOffer=t)}function O(t){var n=o.find(e.memberList,function(e){return e.id==t.pubId});"accepted"!=t.response?(n.subState=K,y.error("Server error, please try again later")):(n.subWebRtcEndpoint.processAnswer(t.sdpAnswer),n.id==e.me.id&&(n.subWebRtcEndpoint.remoteVideo.muted=!0),n.subVideoSlot&&(n.subState=Z,o.each(t.candidateList,function(e){n.subWebRtcEndpoint.addIceCandidate(e)}),$({id:"subscribeAvail",pubId:t.pubId})),_())}function P(){h.cancel(this.member.subGatherToken),this.member.subState!=X&&(B(this.member),this.member.subState=X)}function B(e){if(!e.subSdpOffer||!e.subCandidateSendQueue.length)return void y.error("Device error");var t={id:"subscribe",pubId:e.id,sdpOffer:e.subSdpOffer,candidateList:e.subCandidateSendQueue};$(t),e.subSdpOffer=null,e.subCandidateSendQueue=[]}function W(t){var n="/";if(e.meeting.logoutUrl){var i=decodeURIComponent(e.meeting.logoutUrl);n=v.decode(i)}c.location.href=n}function H(e){j(e.onlineList)}function _(){var t=o.find(e.memberList,function(e){return e.markedForSubscription});t&&(t.markedForSubscription=!1,D(t))}function j(t){var n=[];o.each(e.memberList,function(e){var i=o.find(t,function(t){return e.id==t._id});i?(e.avail=i.avail,e.invited=i.invited,e.online=!0,e.invited?e.avail?(e.subVideoSlot||(e.markedForSubscription=!0),e.subVideoSlot&&e.subState==K&&(e.markedForSubscription=!0)):e.subVideoSlot&&n.push(e):n.push(e)):(e.invited&&n.push(e),e.invited=!1,e.avail=!1,e.online=!1)}),o.each(n,function(e){E(e)}),_()}function z(t){e.chatMessage.push({user:t.user,text:t.text})}var N=0,G=1,Q=2,J=3,K=0,Y=1,X=2,Z=3,ee=3e4,te=3e4;e.connect=function(){1==d.readyState?($({id:"join"}),e.sound.loop=!0,e.sound.play(),e.me.pubState=G):c.location.reload()},e.disconnect=function(){e.me.pubState=N,e.sound.stop();try{e.me.pubWebRtcEndpoint&&e.me.pubWebRtcEndpoint.peerConnection.close(),o.each(e.memberList,function(e){e.subState!=K&&E(e)}),$({id:"leave"})}catch(t){r.error(t)}},d.onmessage=function(t){var n=JSON.parse(t.data);switch(console.info("Received message: "+t.data),n.id){case"joinResponse":R(n);break;case"end":W();break;case"memberStatus":H(n);break;case"handUp":ne(n);break;case"handDown":ie(n);break;case"publishResponse":M(n);break;case"subscribeResponse":O(n);break;case"chat":z(n);break;default:console.error("Unrecognized message",n)}e.$apply()},e.resubscribe=function(t){e.disableState=!0;var n=o.find(e.memberList,function(e){return e.id==t});n.invited&&n.avail&&(E(n),D(n)),h(function(){e.disableState=!1},3e4)},e.leave=function(){var t="/";if(e.meeting.logoutUrl){var n=decodeURIComponent(e.meeting.logoutUrl);t=v.decode(n)}$({id:"leave"}),c.location.href=t},e.endLesson=function(){$({id:"end"})},e.toggleAudio=function(){var t=e.me.pubWebRtcEndpoint.getLocalStream();if(t){var n=t.getAudioTracks()[0];e.audio=!e.audio,n.enabled=e.audio}},e.toggleVideo=function(){var t=e.me.pubWebRtcEndpoint.getLocalStream();if(t){var n=t.getVideoTracks()[0];e.video=!e.video,n.enabled=e.video}},e.toggleHand=function(){e.handUp=!e.handUp,$(e.handUp?{id:"handUp"}:{id:"handDown"})},e.toggleSidenav=function(e){f(e).toggle()},e.memberInvite=function(t){var n=o.find(e.memberList,function(e){return e.id==t});n.handUp=!1,!n.invited&&n.online&&$({id:"invite",inviteeId:n.id})},e.memberDiscard=function(e){var t=e.member;t&&(t.handUp=!1,$({id:"discard",inviteeId:t.id}))};var ne=function(t){var n=o.find(e.memberList,function(e){return e.id==t.memberId});n.handUp=!0},ie=function(t){var n=o.find(e.memberList,function(e){return e.id==t.memberId});n.handUp=!1};e.chat=function(){var t={id:"chat",text:e.chatInput};$(t),e.chatInput=""},e.sendChatMessage=function(t){"Enter"===event.code&&e.chat()},e.byIndex=function(e){return e.index>0},t.$on("$routeChangeStart",function(e,t,n){n||d.close()}),c.onbeforeunload=function(){d.close(),s.cancel(recordToken)},e.showSettingDialog=function(t){m.show({templateUrl:"app/modules/conference/views/settingDialog.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:e.customFullscreen,controller:["$scope","$mdDialog",function(e,t){e.closeDialog=function(){t.hide()}}]}).then(function(t){e.status='You said the information was "'+t+'".'},function(){e.status="You cancelled the dialog."})},k()}]),angular.module("mainModule").controller("AdminRoomsListCtrl",["$meeting","$member","$rootScope","$scope","$q","$location","$log","$mdSidenav","$base64","sharedProperties","localStorageService",function(e,t,n,i,o,a,r,s,l,d,c){function m(e){var n=o.defer(),a=null,s={token:i.token,meetingId:e._id};return t.listMember(s,function(e){e.status?a=e.data.memberList:r.error("Error get list member:",e),n.resolve(a)}),n.promise}function u(){var t=o.defer(),n=null,a={token:i.token};return e.listMeeting(a,function(e){e.status?n=e.data.meetingList:r.error("Error get rooms list:",e),t.resolve(n)}),t.promise}i.token=c.get("tokenConference"),i.room=null,i.toggleSidenav=function(e){s(e).toggle()},i.showRoomDetail=function(e){i.room=e,m(e).then(function(e){i.room.membersList=e?e:[]})},i.gotoEditRoom=function(){c.set("roomAdmin",i.room),a.path("/admin/rooms/edit")},u().then(function(e){i.roomsList=e?e.reverse():[]})}]),angular.module("mainModule").controller("AdminEditRoomCtrl",["$meeting","$member","$rootScope","$scope","$q","$location","$log","$mdToast","$mdSidenav","$base64","viMdToast","sharedProperties","localStorageService","_",function(e,t,n,i,o,a,r,s,l,d,c,m,u,p){function g(){var t=o.defer(),n=null,a={token:i.token};return e.listMeeting(a,function(e){e.status?n=e.data.meetingList:r.error("Error get rooms list"),t.resolve(n)}),t.promise}function f(){var e=o.defer(),n=null,a={token:i.token,meetingId:i.room._id};return t.listMember(a,function(t){t.status?n=t.data.memberList:r.error("Error get list member"),e.resolve(n)}),e.promise}function v(){i.roomsList=i.roomsList.map(function(e){return e=e._id===i.room._id?i.room:e})}function h(){var t={token:i.token,meeting:{id:i.room._id,name:i.room.name,meetingRef:i.room.meetingRef,welcome:i.room.welcome,duration:i.room.duration,logoutUrl:i.room.logoutUrl}};if(t.meeting.logoutUrl){var n=d.encode(t.meeting.logoutUrl);t.meeting.logoutUrl=encodeURIComponent(n)}e.updateMeeting(t,function(e){e.status?(c.success("Update room success!"),v(),u.set("roomAdmin",i.roomsList[0])):c.error("Update room error!")})}function b(e,t){var n;"create"===e&&t?(i.member._id=t,i.membersList.unshift(i.member)):"remove"===e&&t?(n=p.findIndex(i.membersList,{_id:t}),-1!==n&&i.membersList.splice(n,1)):(n=p.findIndex(i.membersList,{_id:t}),-1!==n&&(i.membersList[t]=i.member))}function w(){var e=o.defer(),n={token:i.token,meetingId:i.room._id,member:i.member};return t.addMember(n,function(t){var n=null;t.status&&t.data.status?(c.success("Add member success!"),n=t.data):c.error("Add member error!"),e.resolve(n)}),e.promise}function y(){i.member.role=i.member.role.toLowerCase();var e=o.defer(),n=null,a={token:i.token,meetingId:i.room._id,member:i.member};return t.updateMember(a,function(t){t.status&&t.data.status?(c.success("Update member success!"),n=t.data):c.error("Update member error!"),e.resolve(n)}),e.promise}function S(){var e=o.defer(),n={token:i.token,id:i.member._id};return t.removeMember(n,function(t){t.status?c.success("Delete member success!"):c.error("Delete member error!"),e.resolve(i.member._id)}),e.promise}if(i.token=u.get("tokenConference"),i.room=u.get("roomAdmin"),i.room.logoutUrl){var x=decodeURIComponent(i.room.logoutUrl);i.room.logoutUrl=d.decode(x)}i.member=null,i.showMemberForm=!1,g().then(function(e){i.roomsList=e?e.reverse():[]}).then(function(){return f()}).then(function(e){i.membersList=e?e.reverse():[]}),i.cancel=function(){a.path("/admin/rooms")},i.save=function(){h()},i.showRoomDetail=function(e){i.showMemberForm=!1,i.room=e,f().then(function(e){i.membersList=e?e.reverse():[]})},i.saveMember=function(){i.member&&i.member._id?y().then(function(e){e&&b("update",null)}):w().then(function(e){e&&b("create",e.id)})},i.removeMember=function(){S().then(function(e){i.member=null,b("remove",e)})},i.showEditMemberForm=function(){i.showMemberForm=!0},i.showAddMemberForm=function(){i.showMemberForm=!0,i.member={}},i.cancelMember=function(){i.showMemberForm=!1},i.showMemberDetail=function(e){i.showMemberForm=!1,i.member=e},i.toggleSidenav=function(e){l(e).toggle()}}]),angular.module("mainModule").controller("AdminCreateRoomCtrl",["$meeting","$rootScope","$scope","$q","$location","$log","$mdSidenav","$base64","viMdToast","Fullscreen","localStorageService",function(e,t,n,i,o,a,r,s,l,d,c){function m(){var t={token:n.token,meeting:n.room};if(n.room.logoutUrl){var i=s.encode(n.room.logoutUrl);t.meeting.logoutUrl=encodeURIComponent(i)}e.createMeeting(t,function(e){e.status&&e.data.status?(l.success("Create room success!"),n.room._id=e.data.id,c.set("roomAdmin",n.room),o.path("/admin/rooms/edit")):l.error("Create room error!")})}function u(){var t=i.defer(),o=null,r={token:n.token};return e.listMeeting(r,function(e){e.status?o=e.data.meetingList:a.error("Error get rooms list:",e),t.resolve(o)}),t.promise}n.token=c.get("tokenConference"),n.room={},n.token||o.path("/admin"),n.save=function(){m()},n.cancel=function(){o.path("/admin/rooms")},u().then(function(e){n.roomsList=e?e.reverse():[]}),n.toggleSidenav=function(e){r(e).toggle()}}]),angular.module("mainModule").controller("AdminAuthCtrl",["$auth","$rootScope","$scope","$q","$location","$mdToast","viMdToast","Fullscreen","localStorageService",function(e,t,n,i,o,a,r,s,l){n.auth={emailLogin:"",passwordLogin:""},n.loginAccount=function(){var t={};t.email=n.auth.emailLogin,t.password=n.auth.passwordLogin,e.loginAccount(t,function(e){e.status?(l.set("tokenConference",e.data.token),o.path("/admin/rooms")):r.error("Email or password incorrect!")})},n.loginAccountKeyPress=function(e){"Enter"===e.code&&n.loginAccount()}}]),angular.module("app").factory("$utilities",function(){var e={resizeImg:function(e,t,n,i){var o=e.width,a=e.height,r=1,s=1,l=1;s=t/o,l=n/a,r=l>s?s:l;var d=document.createElement("canvas"),c=d.getContext("2d"),m=document.createElement("canvas"),u=m.getContext("2d"),p=document.createElement("canvas"),g=p.getContext("2d");m.width=o,m.height=a,u.drawImage(e,0,0),p.width=o,p.height=a,g.drawImage(m,0,0,m.width,m.height,0,0,p.width,p.height);for(var f=1,v=r*f,h=1;f>=h;h++)m.width=o*v/h,
m.height=a*v/h,u.drawImage(p,0,0,p.width,p.height,0,0,m.width,m.height),p.width=o*v/h,p.height=a*v/h,g.drawImage(m,0,0,m.width,m.height,0,0,p.width,p.height);d.width=o*v/f,d.height=a*v/f,c.drawImage(p,0,0,p.width,p.height,0,0,d.width,d.height),90==i||270==i?(d.width=p.height,d.height=p.width):(d.width=p.width,d.height=p.height),c.clearRect(0,0,d.width,d.height),90==i||270==i?c.translate(p.height/2,p.width/2):c.translate(p.width/2,p.height/2),c.rotate(i*Math.PI/180),c.drawImage(p,-p.width/2,-p.height/2);var b=d.toDataURL();return b},b64toBlob:function(e,t,n){t=t||"",n=n||512;for(var i=atob(e),o=[],a=0;a<i.length;a+=n){for(var r=i.slice(a,a+n),s=new Array(r.length),l=0;l<r.length;l++)s[l]=r.charCodeAt(l);var d=new Uint8Array(s);o.push(d)}var c=new Blob(o,{type:t});return c}};return e}),angular.module("app").factory("$utilities",function(){var e={resizeImg:function(e,t,n,i){var o=e.width,a=e.height,r=1,s=1,l=1;s=t/o,l=n/a,r=l>s?s:l;var d=document.createElement("canvas"),c=d.getContext("2d"),m=document.createElement("canvas"),u=m.getContext("2d"),p=document.createElement("canvas"),g=p.getContext("2d");m.width=o,m.height=a,u.drawImage(e,0,0),p.width=o,p.height=a,g.drawImage(m,0,0,m.width,m.height,0,0,p.width,p.height);for(var f=1,v=r*f,h=1;f>=h;h++)m.width=o*v/h,m.height=a*v/h,u.drawImage(p,0,0,p.width,p.height,0,0,m.width,m.height),p.width=o*v/h,p.height=a*v/h,g.drawImage(m,0,0,m.width,m.height,0,0,p.width,p.height);d.width=o*v/f,d.height=a*v/f,c.drawImage(p,0,0,p.width,p.height,0,0,d.width,d.height),90==i||270==i?(d.width=p.height,d.height=p.width):(d.width=p.width,d.height=p.height),c.clearRect(0,0,d.width,d.height),90==i||270==i?c.translate(p.height/2,p.width/2):c.translate(p.width/2,p.height/2),c.rotate(i*Math.PI/180),c.drawImage(p,-p.width/2,-p.height/2);var b=d.toDataURL();return b},b64toBlob:function(e,t,n){t=t||"",n=n||512;for(var i=atob(e),o=[],a=0;a<i.length;a+=n){for(var r=i.slice(a,a+n),s=new Array(r.length),l=0;l<r.length;l++)s[l]=r.charCodeAt(l);var d=new Uint8Array(s);o.push(d)}var c=new Blob(o,{type:t});return c}};return e}),angular.module("api").factory("$recorder",["$log",function(e){function t(t){if(t.data&&t.data.size>0&&o.push(t.data),"firefox"==deviceDetector.browser&&!$scope.recording){var n=new Blob(o,{type:"video/webm"}),i=new File([n],"upload.webm");e.info("Broadcast firefox"),a(i)}}function n(t){e.info("Recorder stopped: ",t)}var i,o,a;return{start:function(a){o=[];var r={mimeType:"video/webm;codecs=vp8"};MediaRecorder.isTypeSupported(r.mimeType)||(e.info(r.mimeType+" is not Supported"),r={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(r.mimeType)||(e.info(r.mimeType+" is not Supported"),r={mimeType:"video/webm"},MediaRecorder.isTypeSupported(r.mimeType)||(e.info(r.mimeType+" is not Supported"),r={mimeType:""})));try{i=new MediaRecorder(a,r)}catch(s){return console.error("Exception while creating MediaRecorder: "+s),void alert("Exception while creating MediaRecorder: "+s+". mimeType: "+r.mimeType)}e.info("Created MediaRecorder",i,"with options",r),i.onstop=n,i.ondataavailable=t,i.start()},stop:function(t){if(a=t,i.stop(),e.info("Stop recording",o),"chrome"==deviceDetector.browser){var n=new Blob(o,{type:"video/webm"}),r=new File([n],"upload.webm");e.info("Broadcast chrome"),a(r)}}}}]),angular.module("app").directive("keyEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.keyEnter)}),t.preventDefault())})}}),angular.module("app").directive("fileModel",["$parse",function(e){return{restrict:"A",link:function(t,n,i){var o=e(i.fileModel),a=o.assign;n.bind("change",function(){t.$apply(function(){a(t,n[0].files[0])})})}}}]),angular.module("app").directive("angucompleteAlt",["$q","$parse","$http","$sce","$timeout","$templateCache","$interpolate",function(e,t,n,i,o,a,r){function s(t,a,r,s){function x(e){ue=null,t.hideResults(e),document.body.removeEventListener("click",x)}function k(e){t.notEmpty=e,le=t.searchStr,t.fieldRequired&&s&&t.inputName&&s[t.inputName].$setValidity(se,e)}function $(e){"function"==typeof t.selectedObject?t.selectedObject(e):t.selectedObject=e,k(e?!0:!1)}function R(e,t){var n,i;if(t){n=t.split("."),i=e;for(var o=0;o<n.length;o++)i=i[n[o]]}else i=e;return i}function C(e){return t.titleField.split(",").map(function(t){return R(e,t)}).join(" ")}function L(e,n){e&&("object"==typeof e?(t.searchStr=C(e),$({originalObject:e})):"string"==typeof e&&e.length>0?t.searchStr=e:console&&console.error&&console.error("Tried to set "+(n?"initial":"")+" value of angucomplete to",e,"which is an invalid value"),k(!0))}function I(){t.showDropdown=!1,t.results=[],ce&&(ce.scrollTop=0)}function M(e){return e.which?e.which:e.keyCode}function U(e){return function(n){return t[e]?t[e](n):n}}function A(e){$({originalObject:e}),t.clearSelected&&(t.searchStr=null),I()}function E(e,n){var o,a,r;return r=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),e?(e.match&&e.replace||(e=e.toString()),a=e.match(r),o=a?e.replace(r,'<span class="'+t.matchClass+'">'+a[0]+"</span>"):e,i.trustAsHtml(o)):void 0}function D(){t.showDropdown=ne,t.currentIndex=t.focusFirst?0:-1,t.results=[]}function T(e){!e||e.length<ae||(t.localData?t.$apply(function(){K(e)}):t.remoteApiHandler?J(e):Q(e))}function F(e){var n=M(e);if(n!==m&&n!==d)if(n===c||n===p)e.preventDefault();else if(n===l)e.preventDefault(),!t.showDropdown&&t.searchStr&&t.searchStr.length>=ae&&(D(),t.searching=!0,T(t.searchStr));else if(n===u)I(),t.$apply(function(){oe.val(t.searchStr)});else{if(0===ae&&!t.searchStr)return;t.searchStr&&""!==t.searchStr?t.searchStr.length>=ae&&(D(),re&&o.cancel(re),t.searching=!0,re=o(function(){T(t.searchStr)},t.pause)):t.showDropdown=!1,le&&le!==t.searchStr&&!t.clearSelected&&t.$apply(function(){$()})}}function q(){de&&de.resolve()}function V(e){!t.overrideSuggestions||t.selectedObject&&t.selectedObject.originalObject===t.searchStr||(e&&e.preventDefault(),o.cancel(re),q(),A(t.searchStr))}function O(e){var t=getComputedStyle(e);return e.offsetHeight+parseInt(t.marginTop,10)+parseInt(t.marginBottom,10)}function P(){return ce.getBoundingClientRect().top+parseInt(getComputedStyle(ce).maxHeight,10)}function B(){return a[0].querySelectorAll(".angucomplete-row")[t.currentIndex]}function W(){return B().getBoundingClientRect().top-(ce.getBoundingClientRect().top+parseInt(getComputedStyle(ce).paddingTop,10))}function H(e){ce.scrollTop=ce.scrollTop+e}function _(){var e=t.results[t.currentIndex];t.matchClass?oe.val(C(e.originalObject)):oe.val(e.title)}function j(e){var n=M(e),i=null,o=null;n===p&&t.results?(t.currentIndex>=0&&t.currentIndex<t.results.length?(e.preventDefault(),t.selectResult(t.results[t.currentIndex])):(V(e),I()),t.$apply()):n===l&&t.results?(e.preventDefault(),t.currentIndex+1<t.results.length&&t.showDropdown&&(t.$apply(function(){t.currentIndex++,_()}),me&&(i=B(),P()<i.getBoundingClientRect().bottom&&H(O(i))))):n===c&&t.results?(e.preventDefault(),t.currentIndex>=1?(t.$apply(function(){t.currentIndex--,_()}),me&&(o=W(),0>o&&H(o-1))):0===t.currentIndex&&t.$apply(function(){t.currentIndex=-1,oe.val(t.searchStr)})):n===g?t.results&&t.results.length>0&&t.showDropdown?-1===t.currentIndex&&t.overrideSuggestions?V():(-1===t.currentIndex&&(t.currentIndex=0),t.selectResult(t.results[t.currentIndex]),t.$digest()):t.searchStr&&t.searchStr.length>0&&V():n===u&&e.preventDefault()}function z(e,n){var i,o,a,r,s,l;if(e&&e.length>0)for(t.results=[],i=0;i<e.length;i++){if(t.titleField&&""!==t.titleField&&(r=s=C(e[i])),t.subTitleField&&""!==t.subTitleField){var d=R(e[i],t.subTitleField);d&&(r+="- "+d)}o="",t.descriptionField&&(o=l=R(e[i],t.descriptionField)),a="",t.imageField&&(a=R(e[i],t.imageField)),t.matchClass&&(s=E(r,n),l=E(o,n)),t.results[t.results.length]={title:s,description:l,image:a,originalObject:e[i]}}else t.results=[];t.autoMatch&&1===t.results.length&&Y(t.results[0],{title:r,desc:o||""},t.searchStr)?t.showDropdown=!1:0!==t.results.length||ie?t.showDropdown=!0:t.showDropdown=!1,t.results=t.results.slice(0,15)}function N(e){return function(n,i,o,a){i||o||a||!n.data||(n=n.data),t.searching=!1,z(R(ee(n),t.remoteUrlDataField),e)}}function G(e,n,i,o){0!==n&&-1!==n&&(n||i||o||(n=e.status),t.remoteUrlErrorCallback?t.remoteUrlErrorCallback(e,n,i,o):console&&console.error&&console.error("http error"))}function Q(i){var o={},a=t.remoteUrl+encodeURIComponent(i);t.remoteUrlRequestFormatter&&(o={params:t.remoteUrlRequestFormatter(i)},a=t.remoteUrl),t.remoteUrlRequestWithCredentials&&(o.withCredentials=!0),q(),de=e.defer(),o.timeout=de.promise,n.get(a,o).success(N(i)).error(G)}function J(n){q(),de=e.defer(),t.remoteApiHandler(n,de.promise).then(N(n))["catch"](G)}function K(e){var n,i,o,a,r=t.searchFields.split(","),s=[];for("undefined"!=typeof t.parseInput()&&(e=t.parseInput()(e)),n=0;n<t.localData.length;n++){for(i=!1,o=0;o<r.length;o++)a=R(t.localData[n],r[o])||"",i=i||a.toString().toLowerCase().indexOf(e.toString().toLowerCase())>=0;i&&(s[s.length]=t.localData[n])}t.searching=!1,z(s,e)}function Y(e,n,i){if(!i)return!1;for(var o in n)if(n[o].toLowerCase()===i.toLowerCase())return t.selectResult(e),!0;return!1}function X(){t.localData?z(t.localData,""):t.remoteApiHandler?J(""):Q("")}var Z,ee,te,ne,ie,oe=a.find("input"),ae=f,re=null,se=w,le=null,de=null,ce=a[0].querySelector(".angucomplete-dropdown"),me=!1,ue=null;a.on("mousedown",function(e){e.target.id?(ue=e.target.id,ue===t.id+"_dropdown"&&document.body.addEventListener("click",x)):ue=e.target.className}),t.currentIndex=t.focusFirst?0:null,t.searching=!1,te=t.$watch("initialValue",function(e){e&&(te(),L(e,!0))}),t.$watch("fieldRequired",function(e,n){e!==n&&(e?k(le&&-1!==t.currentIndex?!0:!1):s[t.inputName].$setValidity(se,!0))}),t.$on("angucomplete-alt:clearInput",function(e,n){n&&n!==t.id||(t.searchStr=null,$(),k(!1),I())}),t.$on("angucomplete-alt:changeInput",function(e,n,i){n&&n===t.id&&L(i)}),t.onFocusHandler=function(){t.focusIn&&t.focusIn(),0!==ae||t.searchStr&&0!==t.searchStr.length||(t.currentIndex=t.focusFirst?0:t.currentIndex,t.showDropdown=!0,X())},t.hideResults=function(){ue&&(ue===t.id+"_dropdown"||ue.indexOf("angucomplete")>=0)?ue=null:(Z=o(function(){I(),t.$apply(function(){t.searchStr&&t.searchStr.length>0&&oe.val(t.searchStr)})},b),q(),t.focusOut&&t.focusOut(),t.overrideSuggestions&&t.searchStr&&t.searchStr.length>0&&-1===t.currentIndex&&V())},t.resetHideResults=function(){Z&&o.cancel(Z)},t.hoverRow=function(e){t.currentIndex=e},t.selectResult=function(e){t.matchClass&&(e.title=C(e.originalObject),e.description=R(e.originalObject,t.descriptionField)),t.clearSelected?t.searchStr=null:t.searchStr=e.title,$(e),I()},t.inputChangeHandler=function(e){return e.length<ae?(q(),I()):0===e.length&&0===ae&&(t.searching=!1,X()),t.inputChanged&&(e=t.inputChanged(e)),e},t.fieldRequiredClass&&""!==t.fieldRequiredClass&&(se=t.fieldRequiredClass),t.minlength&&""!==t.minlength&&(ae=parseInt(t.minlength,10)),t.pause||(t.pause=h),t.clearSelected||(t.clearSelected=!1),t.overrideSuggestions||(t.overrideSuggestions=!1),t.fieldRequired&&s&&k(t.initialValue?!0:!1),t.inputType=r.type?r.type:"text",t.textSearching=r.textSearching?r.textSearching:y,t.textNoResults=r.textNoResults?r.textNoResults:S,ne="false"===t.textSearching?!1:!0,ie="false"===t.textNoResults?!1:!0,t.maxlength=r.maxlength?r.maxlength:v,oe.on("keydown",j),oe.on("keyup",F),ee=U("remoteUrlResponseFormatter"),o(function(){var e=getComputedStyle(ce);me=e.maxHeight&&"auto"===e.overflowY})}var l=40,d=39,c=38,m=37,u=27,p=13,g=9,f=3,v=524288,h=500,b=200,w="autocomplete-required",y="Searching...",S="No results found",x="/angucomplete-alt/index.html";return a.put(x,'<div class="angucomplete-holder" ng-class="{\'angucomplete-dropdown-visible\': showDropdown}">  <input style="margin: 0px; border: none; height: 34px; width: 90%;" id="{{id}}_value" name="{{inputName}}" ng-class="{\'angucomplete-input-not-empty\': notEmpty}" ng-model="searchStr" ng-disabled="disableInput" type="{{inputType}}" placeholder="{{placeholder}}" maxlength="{{maxlength}}" ng-focus="onFocusHandler()" class="{{inputClass}}" ng-focus="resetHideResults()" ng-blur="hideResults($event)" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="inputChangeHandler(searchStr)"/>  <div id="{{id}}_dropdown" class="angucomplete-dropdown" ng-show="showDropdown">    <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching"></div>    <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>    <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'angucomplete-selected-row\': $index == currentIndex}">      <div ng-if="imageField" class="angucomplete-image-holder">        <img ng-if="result.image && result.image != \'\'" ng-src="{{result.image}}" class="angucomplete-image"/>        <div ng-if="!result.image && result.image != \'\'" class="angucomplete-image-default"></div>      </div>      <div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>      <div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div>      <div ng-if="matchClass && result.description && result.description != \'\'" class="angucomplete-description" ng-bind-html="result.description"></div>      <div ng-if="!matchClass && result.description && result.description != \'\'" class="angucomplete-description">{{result.description}}</div>    </div>  </div></div>'),{restrict:"EA",require:"^?form",scope:{selectedObject:"=",disableInput:"=",initialValue:"=",localData:"=",remoteUrlRequestFormatter:"=",remoteUrlRequestWithCredentials:"@",remoteUrlResponseFormatter:"=",remoteUrlErrorCallback:"=",remoteApiHandler:"=",id:"@",type:"@",placeholder:"@",remoteUrl:"@",remoteUrlDataField:"@",titleField:"@",descriptionField:"@",imageField:"@",inputClass:"@",pause:"@",searchFields:"@",minlength:"@",matchClass:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"=",fieldRequiredClass:"@",inputChanged:"=",autoMatch:"@",focusOut:"&",focusIn:"&",inputName:"@",focusFirst:"@",parseInput:"&",subTitleField:"@"},templateUrl:function(e,t){return t.templateUrl||x},compile:function(e){var t=r.startSymbol(),n=r.endSymbol();if("{{"!==t||"}}"!==n){var i=e.html().replace(/\{\{/g,t).replace(/\}\}/g,n);e.html(i)}return s}}}]),angular.module("trainingModule").config(["$routeProvider","$sceDelegateProvider","localStorageServiceProvider",function(e,t,n){e.when("/training",{templateUrl:"app/modules/training/views/trainingRoom.html",controller:"TrainingRoomController",controllerAs:"app/modules/training/controllers/trainingRoom"})}]),angular.module("mainModule").config(["$routeProvider",function(e){e.when("/home",{templateUrl:"app/modules/main/views/main.html",controller:"HomeController",controllerAs:"app/modules/main/controllers/main"}).when("/trustedlogin",{templateUrl:"app/modules/main/views/trustedlogin.html",controller:"TrustedLoginController",controllerAs:"app/modules/main/controllers/trustedlogin"})}]),angular.module("conferenceModule").config(["$routeProvider","$sceDelegateProvider","localStorageServiceProvider",function(e,t,n){e.when("/room",{templateUrl:"app/modules/conference/views/room.html",controller:"RoomController",controllerAs:"app/modules/conference/controllers/room"})}]),angular.module("adminModule",["api","toastr","config","underscore","LocalStorageModule"]),angular.module("adminModule").config(["$routeProvider",function(e){e.when("/admin",{templateUrl:"app/modules/admin/views/adminAuthView.html",controller:"AdminAuthCtrl",controllerAs:"app/modules/admin/controllers/adminAuthController"}).when("/admin/rooms",{templateUrl:"app/modules/admin/views/adminRoomsListView.html",controller:"AdminRoomsListCtrl",controllerAs:"app/modules/admin/controllers/adminRoomsListController"}).when("/admin/rooms/create",{templateUrl:"app/modules/admin/views/adminCreateRoomView.html",controller:"AdminCreateRoomCtrl",controllerAs:"app/modules/admin/controllers/adminCreateRoomController"}).when("/admin/rooms/edit",{templateUrl:"app/modules/admin/views/adminEditRoomView.html",controller:"AdminEditRoomCtrl",controllerAs:"app/modules/admin/controllers/adminEditRoomCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("config",[]).constant("apiUrl","https://training.demo.vietinterview.com:9444/api").constant("trainingSocketUrl","wss://training.demo.vietinterview.com:9445/one2many").constant("conferenceSocketUrl","wss://training.demo.vietinterview.com:9446/many2many").constant("iceServers",[{url:"turn:125.212.233.5:3478?transport=udp",credential:"123456",username:"quang"}]).constant("enabledLog",!0),angular.module("app").service("sharedProperties",function(){var e=null;return{setObject:function(t){e=t},getObject:function(){return e}}}),angular.module("app").service("viMdToast",["$mdToast",function(e){function t(t,n){e.show(e.simple().textContent(t).position(o).toastClass(n).hideDelay(a))}function n(e){t(e,r)}function i(e){t(e,s)}var o="top right",a=2e3,r="vi-toast-danger",s="vi-toast-success";return{error:n,success:i}}]),angular.module("app").run(["$log",function(e){e.debug("Application started")}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{templateUrl:"app/modules/main/views/main.html",controller:"HomeController",controllerAs:"app/modules/main/controllers/main"})}]),angular.module("app").filter("decodeBase64",["$base64",function(e){return function(t){var n="";return t&&(n=e.decode(t)),n}}]),angular.module("app").config(["$logProvider","$mdThemingProvider","$mdIconProvider","$translateProvider","toastrConfig","enabledLog","$activityIndicatorProvider",function(e,t,n,i,o,a,r){e.debugEnabled(a),o.allowHtml=!0,o.timeOut=3e3,o.positionClass="toast-top-right",o.preventDuplicates=!0,o.closeButton=!0,o.progressBar=!0,i.useStaticFilesLoader({prefix:"./assets/locale/locale-",suffix:".json"}),i.preferredLanguage("vi"),i.fallbackLanguage("vi"),r.setActivityIndicatorStyle("SpinnerDark")}]),angular.module("app").run(["$templateCache",function(e){e.put("app/shared/directives/showBandwidth/showBandwidthView.html",'<div layout=row><!-- <span>{{"directives.showBandwidth.speed" | translate}}: {{speedDownMbps | number}}Mbps</span> --><div flex=50 class=progress-speed><span class=begin>0</span> <span class=end>30</span><md-progress-linear md-mode=determinate value={{speedDownMbps}}></md-progress-linear></div><div flex=50>{{speedDownMbpsOri}} Mbps <button class="vi-center menuBtn" style="margin-left: 10px" aria-label="Network speed" ng-click=measureDownloadSpeedAverage();><i style=color:#2196F3 class="fa fa-clock-o fa-lg" aria-hidden=true></i><!-- <md-tooltip md-direction="bottom">\r\n              {{"directives.showBandwidth.test" | translate}}\r\n            </md-tooltip> --></button></div></div>'),e.put("app/modules/admin/views/adminAuthView.html",'<main class=auth-main layout=column layout-align="center center" ng-keypress=loginAccountKeyPress($event)><div class=auth-block><div class="md-display-1 vi-center auth-admin-logo"><img src=assets/images/logo_trananh.jpg alt=""></div><form name=authForm><md-input-container class=md-block><label>Email</label><input name=email ng-model=auth.emailLogin required><div ng-messages=authForm.email.$error><div ng-message=required>{{"auth.required" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>{{"auth.password" | translate}}</label><input name=password type=password ng-model=auth.passwordLogin required><div ng-messages=authForm.password.$error><div ng-message=required>{{"auth.required" | translate}}</div></div></md-input-container><md-button ng-click=loginAccount() class="md-raised md-primary vi-btn-reset">{{"auth.login" | translate}}</md-button></form></div></main>'),e.put("app/modules/admin/views/adminCreateRoomView.html",'<div style="width: 100%" ng-include="\'app/modules/admin/views/shared/toolbarView.html\'"></div><div layout=row flex><md-sidenav class="md-whiteframe-2dp md-sidenav-left vi-sidenav" md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')" md-whiteframe=4><div style="width: 100%" ng-include="\'app/modules/admin/views/shared/roomsListView.html\'"></div></md-sidenav><md-content flex id=content><div layout=row><h3 class="md-display-1 vi-row vi-headline">{{"admin.roomsList.createTitle" | translate}}</h3></div><div layout=row class="room-info vi-row vi-col"><div style="width: 100%" ng-include="\'app/modules/admin/views/shared/roomFormView.html\'"></div></div></md-content></div>'),e.put("app/modules/admin/views/adminEditRoomView.html",'<div style="width: 100%" ng-include="\'app/modules/admin/views/shared/toolbarView.html\'"></div><div layout=row flex><md-sidenav class="md-whiteframe-2dp md-sidenav-left vi-sidenav" md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')" md-whiteframe=4><div style="width: 100%" ng-include="\'app/modules/admin/views/shared/roomsListView.html\'"></div></md-sidenav><md-content flex id=content><div layout=row><h3 class="md-display-1 vi-row vi-headline">{{"admin.roomsList.editTitle" | translate}} "{{room.name}}"</h3></div><div layout=row class="room-info vi-row vi-col"><md-tabs flex md-dynamic-height md-border-bottom><md-tab label="{{\'admin.roomsList.room\' | translate}}"><md-content class=md-padding><div style="width: 100%" ng-include="\'app/modules/admin/views/shared/roomFormView.html\'"></div></md-content></md-tab><md-tab label="{{\'admin.roomsList.member\' | translate}}"><md-content class=md-padding><h3 class=md-title>{{"admin.roomsList.totalMembers" | translate}}: {{membersList.length | number}}</h3><div layout=row><div flex=30><div class=vi-panel><md-list class=vi-members-list><md-list-item class=md-2-line ng-repeat="member in membersList" ng-click=showMemberDetail(member)><div class="md-list-item-text vi-member-item"><h3 class="md-title vi-member-name">{{member.name}}</h3><p class=vi-member-email>{{member.role}}</p></div></md-list-item></md-list><p style=text-align:center ng-show="membersList.length == 0">{{"admin.roomsList.addMemberMsg" | translate}}</p></div></div><div flex=70 class=vi-row><!-- Begin btn group --><div layout=row class=vi-btn-group-member><div flex=70 layout=row layout-align=start><md-button class="md-raised vi-btn vi-warn" ng-click=showEditMemberForm(); style="margin-left: 0"><i class="fa fa-pencil" aria-hidden=true></i> {{"admin.roomsList.edit" | translate}}</md-button><md-button class="md-raised vi-btn vi-success" ng-click=showAddMemberForm();><i class="fa fa-plus" aria-hidden=true></i> {{"admin.roomsList.add" | translate}}</md-button></div><div flex=30 layout=row layout-align=end><md-button class="md-raised vi-btn vi-danger" style="margin-right: 0" ng-click=removeMember();><i class="fa fa-times" aria-hidden=true></i> {{"admin.roomsList.add" | translate}}</md-button></div></div><!-- End btn group --><!-- Begin user info panel --><div class=vi-panel><div ng-show=!showMemberForm><md-list ng-show=member><md-list-item layout=row class=md-1-line><div flex=20 class=vi-title>{{"admin.roomsList.memberName" | translate}}</div><div flex=80>{{member.name}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=20 class=vi-title>{{"admin.roomsList.memberRole" | translate}}</div><div flex=80>{{member.name}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=20 class=vi-title>Email</div><div flex=80>{{member.email}}</div></md-list-item></md-list><p style=text-align:center ng-show=!member>{{"admin.roomsList.chooseMember" | translate}}</p></div><!-- Begin form edit user --><form name=memberForm ng-show=showMemberForm class=vi-col><div layout=row><md-input-container flex=60 class=md-block><label>{{"admin.roomsList.memberName" | translate}}</label><input name=name ng-model=member.name required><div ng-messages=memberForm.name.$error><div ng-message=required>This is required!</div></div></md-input-container><md-input-container flex class=md-block><label>{{"admin.roomsList.memberRole" | translate}}</label><md-select ng-model=member.role><md-option value=presenter>Presenter</md-option><md-option value=member>Member</md-option></md-select></md-input-container></div><div layout=row><md-input-container flex=60 class=md-block><label>Email</label><input name=email ng-model=member.email required><div ng-messages=memberForm.email.$error><div ng-message=required>{{"admin.roomsList.required" | translate}}</div></div></md-input-container><md-input-container flex class=md-block><label>{{"auth.password" | translate}}</label><input name=password type=password ng-model=member.password required><div ng-messages="memberForm.password.$error && !member.password"><div ng-message=required>{{"admin.roomsList.required" | translate}}</div></div></md-input-container></div><div layout=row><md-button ng-click=cancelMember() class="md-raised vi-btn vi-danger">{{"admin.roomsList.cancel" | translate}}</md-button><md-button ng-click=saveMember() class="md-raised md-primary">{{"admin.roomsList.save" | translate}}</md-button></div></form><!-- End form edit user --></div><!-- End user info panel --></div></div></md-content></md-tab></md-tabs></div></md-content></div>'),e.put("app/modules/admin/views/adminRoomsListView.html",'<div style="width: 100%" ng-include="\'app/modules/admin/views/shared/toolbarView.html\'"></div><div layout=row flex><md-sidenav class="md-whiteframe-2dp md-sidenav-left vi-sidenav" md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')" md-whiteframe=4><div style="width: 100%" ng-include="\'app/modules/admin/views/shared/roomsListView.html\'"></div></md-sidenav><md-content flex id=content class=content-admin-rooms-list><div layout=row class="vi-btn-group vi-btn-group-room"><div flex=70 layout=row layout-align=start><md-button class="md-raised vi-btn vi-warn" ng-click=gotoEditRoom();><i class="fa fa-pencil" aria-hidden=true></i> {{"admin.roomsList.edit" | translate}}</md-button><md-button ng-href=#/admin/rooms/create class="md-raised vi-btn vi-success"><i class="fa fa-plus" aria-hidden=true></i> {{"admin.roomsList.create" | translate}}</md-button></div><!-- <div flex="30" layout="row" layout-align="end">\r\n        <md-button class="md-raised vi-btn vi-danger">\r\n          <i class="fa fa-ban" aria-hidden="true"></i> Close\r\n        </md-button>\r\n      </div>  --></div><div layout=row><h3 flex=60 flex-xs=100 class="md-display-1 vi-row vi-headline">{{"admin.roomsList.totalRooms" | translate}}: {{roomsList.length | number}}</h3><div flex=40 flex-xs=100 style="margin: 0 15px"><!-- <show-bandwidth class="bandwidth vi-right"></show-bandwidth> --></div></div><div layout=row layout-xs=column><div flex=50 flex-xs=100 class="vi-panel vi-row vi-col"><h3 class=md-headline>{{room.name ? room.name : "admin.roomsList.chooseRoom" | translate}}</h3><div layout=column><md-list ng-show=room><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Room Id</div><div flex=70>{{room._id}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Room Reference</div><div flex=70>{{room.meetingRef}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>{{"admin.roomsList.duration" | translate}}</div><div flex=70>{{room.duration ? room.duration : "" | number}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>{{"admin.roomsList.status" | translate}}</div><div flex=70>{{room.active ? "active" : "inactive"}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Logout Url</div><div flex=70 style="word-wrap: break-word">{{room.logoutUrl ? room.logoutUrl : "" | decodeBase64}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>Welcome title</div><div flex=70>{{room.welcome ? room.welcome : ""}}</div></md-list-item><md-list-item layout=row class=md-1-line><div flex=30 class=vi-title>{{"admin.roomsList.totalMembers" | translate}}</div><div flex=70>{{room.membersList.length | number}}</div></md-list-item></md-list></div></div><div flex=50 flex-xs=100 class="vi-panel vi-row vi-col members-list"><h3 class=md-headline>{{"admin.roomsList.membersList" | translate}}</h3><md-list class=vi-members-list><md-list-item class="md-3-line vi-md-list-user-item" ng-repeat="member in room.membersList"><div class="md-list-item-text vi-member-item"><h3 class="md-title vi-member-name">{{member.name}}</h3><p>{{member.email}}</p><p class=vi-member-email>{{member.role}}</p></div></md-list-item></md-list></div></div></md-content></div>'),e.put("app/modules/conference/views/room.html",'<!-- Start toolbar --><md-toolbar layout=row class="md-toolbar-tools vi-toolbar"><div flex=40><!-- <button hide-gt-sm class="vi-center menuBtn" ng-click="toggleSidenav(\'left\')" aria-label="Toggle Menu">\r\n            <i class="fa fa-bars" aria-hidden="true"></i>\r\n        </button> --> <img src=assets/images/logo_trananh_blue.png alt=Trananh style="width: 200px"></div><div flex=20 flex-sm=40 flex-xs=40 class=vi-center><h2 class="md-display-1 vi-logo">{{meeting.name}}</h2></div><div flex=40 class=vi-right><ul class="list-inline vi-nav-right"><li class=vi-nav-right-item ng-show="me.profile.role==\'presenter\'" ng-click=endLesson()><i class="fa fa-hourglass-end" aria-hidden=true></i> <span>{{"conference.endLesson" | translate}}</span></li><li class=vi-nav-right-item ng-click=showSettingDialog($event)><i class="fa fa-cog" aria-hidden=true></i> <span>{{"conference.setting" | translate}}</span></li><li ng-click=leave() class=vi-nav-right-item><i class="fa fa-sign-out" aria-hidden=true></i> <span>{{"conference.logout" | translate}}</span></li></ul></div></md-toolbar><!-- End toolbar --><div layout=row><!-- Start sidebar --><md-sidenav class="md-sidenav-left vi-sidenav" md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')"><div class="panel panel-info" style="height: 100%; padding: 0px; margin: 0px"><div class="localCameraDiv box" style="width: 100%; margin: auto"><div align=center class=web-cam><video id=localCamera autoplay muted poster=assets/images/avatar-03.png></video></div><div class="btn-local-group-video vi-center"><span ng-click=toggleAudio() class=vi-icon ng-class="audio?\'icon-on\':\'icon-off\'" style="cursor: pointer"><i class="fa fa-microphone"></i><md-tooltip>{{video ? \'conference.offVolume\' : \'conference.offVolume\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleVideo() class=vi-icon ng-class="video?\'icon-on\':\'icon-off\'" style="cursor: pointer"><i class="fa fa-camera"></i><md-tooltip>{{video ? \'conference.offCamera\' : \'conference.onCamera\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleHand() ng-show="me.profile.role!=\'presenter\'" class=vi-icon ng-class="handUp?\'icon-on\':\'icon-off\'" style="cursor: pointer"><i class="fa fa-hand-paper-o"></i></span></div><div class=vi-center><md-button class="md-fab md-mini" aria-label=Connect ng-click=connect() ng-disabled=me.pubState ng-class="\'btn-icon-on\'"><i class="fa fa-volume-control-phone"></i><md-tooltip>{{ \'conference.connect\' | translate}}</md-tooltip></md-button><md-button class="md-fab md-mini" aria-label=Disconnect ng-click=disconnect() ng-disabled=!me.pubState ng-class="\'btn-icon-off\'"><i class="glyphicon glyphicon-phone-alt"></i><md-tooltip>{{ \'conference.disconnect\' | translate}}</md-tooltip></md-button></div></div><div class=panel-body style="height: 100%"><ul class="list-unstyled members-list-room box"><li class=title>{{"conference.presenter" | translate}}</li><li class=content><span ng-class="presenter.online ? \'fa fa-circle vi-online\' : \'fa fa-circle vi-offline\'" aria-hidden=true></span> {{presenter.profile.name}}</li><li class=title>{{"conference.learners" | translate}} <span ng-show="me.profile.role==\'presenter\'" class="fa fa-hand-paper-o btn-handup" ng-class="!notiHandUp ? \'icon-on animated infinite bounce\' : \'icon-off\'" style="cursor: pointer; float: right; margin-left: 10px" aria-hidden=true ng-click=""></span></li><li class=content style="position: relative" ng-repeat="viewer in viewerList"><span ng-class="viewer.online ? \'fa fa-circle vi-online\' : \'fa fa-circle vi-offline\'" aria-hidden=true></span> {{viewer.profile.name}} <span ng-show="me.profile.role==\'presenter\'" class="fa fa-video-camera" ng-class="viewer.invited ? \'icon-on\' : \'icon-off\'" style="cursor: pointer; float: right; margin-left: 10px" aria-hidden=true ng-click=memberInvite(viewer.id)></span> <span ng-show="me.profile.role==\'presenter\'" class="fa fa-hand-paper-o btn-handup" ng-class="viewer.handUp ? \'icon-on animated infinite bounce\' : \'icon-off\'" style="cursor: pointer; float: right; margin-left: 10px" aria-hidden=true ng-click=""></span></li></ul></div></div></md-sidenav><!-- End sidebar --><section layout=row flex class=content-wrapper><!-- <div class="overlay" ng-show="!me.pubState"></div> --><!-- Start conference board --><md-content flex><div class=main-content><!-- <div class="presenter main box conference-board" layout="row" layout-wrap> --><div class="main box conference-board" layout=row layout-wrap><div flex={{firstSlot}} class=video-wrapper><md-progress-circular ng-show="presenter.subState == 1 || presenter.subState == 2" class="md-hue-2 md-warn progress" md-diameter=30px></md-progress-circular><video id=remoteCamera0 controls poster=assets/images/avatar-03.png autoplay></video><div layout=row class=abs-bar><div flex=60><span class=label-name>{{presenter.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(presenter.id) class=btn-refresh style="cursor: pointer"><i class="fa fa-refresh"></i><md-tooltip>Refresh video</md-tooltip></span></div></div></div><div flex={{slot.width}} class=video-wrapper ng-show=slot.allocated ng-repeat="slot in videoSlots | filter:byIndex"><md-progress-circular ng-show="slot.member.subState == 1 || slot.member.subState == 2" class="md-hue-2 md-warn progress" md-diameter=30px></md-progress-circular><video ng-attr-id="{{ \'remoteCamera\' + ($index+1) }}" controls autoplay poster=assets/images/avatar-03.png style="width: 100%"></video><div layout=row class=abs-bar><div flex=60><span class=label-name>{{slot.member.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(slot.member.id) class=btn-refresh style="cursor: pointer"><i class="fa fa-refresh"></i><md-tooltip md-direction=left>Refresh video</md-tooltip></span><span ng-show="me.profile.role==\'presenter\'" ng-click=memberDiscard(slot) class="btn-close vi-center"><i class="fa fa-times fa-lg"></i><md-tooltip md-direction=right>Close</md-tooltip></span></div></div></div></div></div></md-content><!-- End conference board --><!-- Start chat panel --><md-sidenav class="md-sidenav-right vi-chat-sidenav" md-is-locked-open="$mdMedia(\'min-width: 400px\')" md-component-id=right><div class="chat-content-wrapper box"><div class="chat-content box" style="overflow-y: auto"><div class=chat-box-title>Chat box</div><ul class="messages-list list-unstyled"><li class="md-1-line message-item" ng-repeat="msg in chatMessage"><div class=md-list-item-text><span class=user>{{msg.user}}: </span><span class=message>{{msg.text}}</span></div></li></ul></div><div layout=row class="input-message-group-training box" ng-keypress=sendChatMessage($event)><md-input-container flex=80><label>{{"conference.chatMsg" | translate}}</label><input type=text ng-model=chatInput></md-input-container><div flex=20 class=btn-send-wrapper><md-button class="md-fab md-primary" aria-label="Send message" ng-click=chat()><i class="fa fa-paper-plane" aria-hidden=true></i></md-button></div></div></div></md-sidenav><!-- End chat panel --></section></div>'),
e.put("app/modules/conference/views/settingDialog.html","<h1>Setting dialog</h1>"),e.put("app/modules/main/views/main.html",'<main class=auth-main layout=column layout-align="center center" ng-keypress=loginMeetingKeyPress($event)><div class=auth-block><div class="md-display-1 vi-center auth-room-logo"><img src=assets/images/logo_trananh.jpg alt=""></div><form name=authMeetingForm><md-input-container class=md-block><label>RoomId</label><input name=roomId ng-model=meetingAuth.meetingId required><div ng-messages=authMeetingForm.roomId.$error><div ng-message=required>{{"auth.required" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>Email</label><input name=email ng-model=meetingAuth.email required><div ng-messages=authMeetingForm.email.$error><div ng-message=required>{{"auth.required" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>{{"auth.password" | translate}}</label><input name=password type=password ng-model=meetingAuth.password required><div ng-messages=authMeetingForm.password.$error><div ng-message=required>{{"auth.required" | translate}}</div></div></md-input-container><md-radio-group ng-model=meetingAuth.kind layout=row class=md-block><md-radio-button flex value=training class=md-primary>Training</md-radio-button><md-radio-button flex value=conference class=md-primary>Conference</md-radio-button></md-radio-group><md-button ng-click=loginMeeting() class="md-raised md-primary vi-btn-reset btn-login">{{"auth.login" | translate}}</md-button></form></div></main>'),e.put("app/modules/main/views/trustedlogin.html",'<main class="auth-main auth-main-trusted" layout=column layout-align="center center" ng-keypress=loginMeetingKeyPress($event)><div class=auth-block-trusted layout=row><div class=vi-col flex=60 flex-xs=100 flex-offset=40 flex-offset-xs=0><img class=logo-trusted src=assets/images/logo_trananh_white_color.png alt=VietInterview><h3 class=md-headline>{{"training.title" | translate}}</h3><md-button class="md-raised btn-trusted vi-btn-reset" ng-click=loginMeeting()>{{"training.enter" | translate}}</md-button></div></div></main>'),e.put("app/modules/training/views/trainingRoom.html",'<!-- Start toolbar --><md-toolbar layout=row class="md-toolbar-tools vi-toolbar"><div flex=30><!-- <button hide-gt-sm class="vi-center menuBtn" ng-click="toggleSidenav(\'left\')" aria-label="Toggle Menu">\r\n            <i class="fa fa-bars" aria-hidden="true"></i>\r\n        </button> --> <img src=assets/images/logo_trananh_blue.png alt=Trananh style="width: 200px"></div><div flex=40 flex-sm=40 flex-xs=40 class=vi-center><h2 class="md-display-1 vi-logo">{{meeting.name}}</h2></div><div flex=30 class=vi-right><ul class="list-inline vi-nav-right"><li class=vi-nav-right-item ng-show="me.profile.role==\'presenter\'" ng-click=endLesson()><i class="fa fa-hourglass-end" aria-hidden=true></i> <span>{{"training.endLesson" | translate}}</span></li><li ng-click=leave() class=vi-nav-right-item><i class="fa fa-sign-out" aria-hidden=true></i> <span>{{"training.logout" | translate}}</span></li></ul></div></md-toolbar><!-- End toolbar --><div layout=row flex><!-- Start sidebar --><md-sidenav class="md-sidenav-left vi-sidenav" md-component-id=left md-is-locked-open="$mdMedia(\'gt-sm\')"><div class="panel panel-info" style="height: 100%; padding: 0px; margin: 0px"><div class="localCameraDiv box" style="width: 100%; margin: auto"><div align=center class=web-cam><video id=localCamera autoplay muted poster=assets/images/avatar-03.png></video></div><div class="btn-local-group-video vi-center"><span ng-click=toggleAudio() class=vi-icon ng-class="audio?\'icon-on\':\'icon-off\'" style="cursor: pointer"><i class="fa fa-microphone"></i><md-tooltip>{{video ? \'training.offVolume\' : \'training.offVolume\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleVideo() class=vi-icon ng-class="video?\'icon-on\':\'icon-off\'" style="cursor: pointer"><i class="fa fa-camera"></i><md-tooltip>{{video ? \'training.offCamera\' : \'training.onCamera\' | translate}}</md-tooltip></span>&nbsp; <span ng-click=toggleHand() ng-show="me.profile.role!=\'presenter\'" class=vi-icon ng-class="handUp?\'icon-on\':\'icon-off\'" style="cursor: pointer"><i class="fa fa-hand-paper-o"></i></span></div><div class=vi-center><md-button class="md-fab md-mini" aria-label=Connect ng-click=connect() ng-disabled=me.pubState ng-class="\'btn-icon-on\'"><i class="fa fa-volume-control-phone"></i><md-tooltip>{{ \'training.connect\' | translate}}</md-tooltip></md-button><md-button class="md-fab md-mini" aria-label=Disconnect ng-click=disconnect() ng-disabled=!me.pubState ng-class="\'btn-icon-off\'"><i class="glyphicon glyphicon-phone-alt"></i><md-tooltip>{{ \'training.disconnect\' | translate}}</md-tooltip></md-button></div></div><div class=panel-body style="height: 100%"><ul class="list-unstyled members-list-room box"><li class=title>{{"training.presenter" | translate}}</li><li class=content><span ng-class="presenter.online ? \'fa fa-circle vi-online\' : \'fa fa-circle vi-offline\'" aria-hidden=true></span> {{presenter.profile.name}}</li><li class=title>{{"training.learners" | translate}} <span ng-show="me.profile.role==\'presenter\'" class="fa fa-hand-paper-o btn-handup" ng-class="!notiHandUp ? \'icon-on animated infinite bounce\' : \'icon-off\'" style="cursor: pointer; float: right; margin-left: 10px" aria-hidden=true ng-click=""></span></li><li class=content style="position: relative" ng-repeat="viewer in viewerList"><span ng-class="viewer.online ? \'fa fa-circle vi-online\' : \'fa fa-circle vi-offline\'" aria-hidden=true></span> {{viewer.profile.name}} <span ng-show="me.profile.role==\'presenter\'" class="fa fa-video-camera" ng-class="viewer.invited ? \'icon-on\' : \'icon-off\'" style="cursor: pointer; float: right; margin-left: 10px" aria-hidden=true ng-click=memberInvite(viewer.id)></span> <span ng-show="me.profile.role==\'presenter\'" class="fa fa-hand-paper-o btn-handup" ng-class="viewer.handUp ? \'icon-on animated infinite bounce\' : \'icon-off\'" style="cursor: pointer; float: right; margin-left: 10px" aria-hidden=true ng-click=""></span></li></ul></div></div></md-sidenav><!-- End sidebar --><section layout=row flex class=content-wrapper><div class=overlay ng-show=!me.pubState></div><!-- Start conference board --><md-content flex><div class=main-content><div class=my-pdf-container><div class="toolbar-pdf-viewer box" layout=row ng-show="me.profile.role==\'presenter\'"><div flex=30><md-button class="md-raised vi-success vi-btn" ngf-select=uploadDoc($file) ngf-max-size=10MB><i class="fa fa-plus" aria-hidden=true></i> Upload</md-button></div><div flex=40 class=vi-center><md-button class="md-raised vi-btn-default" ng-click=pdfPrev()><i class="fa fa-chevron-left" aria-hidden=true></i></md-button><input type=text class="vi-input vi-pdf-input" ng-value="currPage + \'/\' + totalPages"><md-button class="md-raised vi-btn-default" ng-click=pdfNext()><i class="fa fa-chevron-right" aria-hidden=true></i></md-button></div><div flex=30 class=vi-right><md-button class="md-raised vi-btn-default" ng-click=zoomOut(0.1)><i class="fa fa-search-minus" aria-hidden=true></i></md-button><input flex=60 class="vi-input vi-pdf-input" type=text ng-value="zoom + \'%\'" disabled><md-button class="md-raised vi-btn-default" ng-click=zoomIn(0.1)><i class="fa fa-search-plus" aria-hidden=true></i></md-button></div></div><div style="margin-top: 5px" class="pdf-content box vi-center"><pdf-viewer delegate-handle=my-pdf-container url=pdfUrl scale=.9 show-toolbar=false headers="{ \'x-you-know-whats-awesome\': \'EVERYTHING\' }"></pdf-viewer></div></div></div></md-content><!-- End conference board --><!-- Start chat panel --><md-sidenav class="md-sidenav-right vi-chat-sidenav vi-chat-sidenav-training" md-is-locked-open="$mdMedia(\'min-width: 280px\')" md-component-id=right><div class="presenter main box video-wrapper" layout=row layout-wrap ng-show="me.profile.role!=\'presenter\'"><!-- <div ng-show="presenter.subState == 1 || presenter.subState == 2" \r\n                    ng-activity-indicator skip-ng-show="yes"\r\n                    ng-class="toggleVideoFlag ? \'hide-panel\' : \'\'"></div> --><md-progress-circular ng-show="presenter.subState == 1 || presenter.subState == 2" class="md-hue-2 md-warn progress" ng-class="toggleVideoFlag ? \'hide-panel\' : \'\'" md-diameter=30px></md-progress-circular><video id=remoteCamera0 controls poster=assets/images/conference-01.png autoplay style="min-height: 180px" ng-class="toggleVideoFlag ? \'hide-panel\' : \'\'"></video><div layout=row class=btn-group-video ng-class="!toggleVideoFlag ? \'abs-bar\' : \'static-bar\'"><div flex=60><span class=label-name>{{"training.presenter" | translate}}: {{presenter.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(presenter.id) class=btn-refresh style="cursor: pointer"><i class="fa fa-refresh"></i><md-tooltip>{{\'training.refresh\' | translate}}</md-tooltip></span><span ng-click=toggleMainVideo() class=btn-collapse style="cursor: pointer"><i class="fa fa-minus" aria-hidden=true></i><md-tooltip>{{\'training.collapse\' | translate}}</md-tooltip></span></div></div></div><md-tabs md-dynamic-height="" md-border-bottom="" class=box><md-tab label=Chat><md-content class=md-padding><div class="chat-content chat-content-training box" style="overflow-y: auto"><div class=chat-box-title>Chat box</div><ul class="messages-list list-unstyled"><li class="md-1-line message-item" ng-repeat="msg in chatMessage"><div class=md-list-item-text><span class=user>{{msg.user}}: </span><span class=message>{{msg.text}}</span></div></li></ul></div><div layout=row class="input-message-group-training box" ng-keypress=sendChatMessage($event)><md-input-container flex=80><label>{{"training.chatMsg" | translate}}</label><input type=text ng-model=chatInput></md-input-container><div flex=20 class=btn-send-wrapper><md-button class="md-fab md-primary" aria-label="Send message" ng-click=chat()><i class="fa fa-paper-plane" aria-hidden=true></i></md-button></div></div></md-content></md-tab><md-tab label=Videos><md-content class=md-padding><div layout=row layout-wrap class="participant main members-video-panel members-video-training-panel"><div flex=50 class="video-member video-wrapper" ng-show=slot.allocated ng-repeat="slot in videoSlots | filter:byIndex"><!--  <div ng-show="slot.member.subState ==1 || slot.member.subState ==2 " ng-activity-indicator skip-ng-show="yes"></div> --><md-progress-circular ng-show="slot.member.subState == 1 || slot.member.subState == 2" class="md-hue-2 md-warn progress" md-diameter=30px></md-progress-circular><video ng-attr-id="{{ \'remoteCamera\' + ($index+1) }}" controls autoplay poster=assets/images/avatar_1.png style="width: 100%"></video><div layout=row class=abs-bar><div flex=60><span class=label-name>{{slot.member.profile.name}}</span></div><div flex=40 class=vi-right><span ng-click=resubscribe(slot.member.id) class=btn-refresh style="cursor: pointer"><i class="fa fa-refresh"></i> </span><span ng-show="me.profile.role==\'presenter\'" ng-click=memberDiscard(slot) class="btn-close vi-center"><i class="fa fa-times fa-lg"></i></span></div></div></div><div flex=50 ng-hide="countAllocated == 1"><img src=assets/images/video-placeholder.png style="width: 100%; display: block; margin-bottom: 5px"></div><div flex=50 ng-hide="countAllocated == 2"><img src=assets/images/video-placeholder.png style="width: 100%; display: block; margin-bottom: 5px"></div><div flex=50 ng-hide="countAllocated == 3"><img src=assets/images/video-placeholder.png style="width: 100%; display: block; margin-bottom: 5px"></div></div></md-content></md-tab></md-tabs></md-sidenav><!-- End chat panel --></section></div>'),e.put("app/modules/admin/views/shared/roomFormView.html",'<form name=creatRoomForm><md-input-container class=md-block><label>{{"admin.roomsList.nameRoom" | translate}}</label><input name=name type=text ng-model=room.name required><div ng-messages=creatRoomForm.name.$error><div ng-message=required>{{"admin.roomsList.required" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>Room Refercence</label><input name=meetingRef type=text ng-model=room.meetingRef required><div ng-messages=creatRoomForm.meetingRef.$error><div ng-message=required>{{"admin.roomsList.required" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>{{"admin.roomsList.duration" | translate}}</label><input name=duration type=number ng-model=room.duration required><div ng-messages=creatRoomForm.duration.$error><div ng-message=required>{{"admin.roomsList.required" | translate}}</div></div></md-input-container><md-input-container class=md-block><label>Logout Url</label><input name=logoutUrl type=text ng-model=room.logoutUrl></md-input-container><md-input-container class=md-block><label>Webcome title</label><input name=welcome type=text ng-model=room.welcome></md-input-container><md-button ng-click=cancel() class="md-raised vi-btn vi-danger">{{"admin.roomsList.cancel" | translate}}</md-button><md-button ng-click=save() class="md-raised md-primary">{{"admin.roomsList.save" | translate}}</md-button></form>'),e.put("app/modules/admin/views/shared/roomsListView.html",'<md-list class=rooms-list><md-list-item ng-repeat="room in roomsList"><span style="margin-top: -15px" ng-class="room.active ? \'fa fa-circle vi-online\' : \'fa fa-circle vi-offline\'" aria-hidden=true></span><md-button ng-click=showRoomDetail(room)><h3 class=md-title>{{room.name}}</h3><div class=room-status-group><span>RefId: {{room.meetingRef}}</span></div></md-button></md-list-item></md-list>'),e.put("app/modules/admin/views/shared/toolbarView.html",'<md-toolbar layout=row class="md-toolbar-tools vi-toolbar"><div flex hide-gt-sm><button class="vi-center menuBtn" ng-click="toggleSidenav(\'left\')" aria-label="Toggle Menu"><i class="fa fa-bars" aria-hidden=true></i></button></div><h2 flex class="md-display-1 vi-logo">Vietinterview <span hide-sm hide-xs>- Conference Room</span></h2><ul flex class="list-inline vi-right"><li><a href=#/admin/home>Home</a></li><li><a href=#/admin/rooms>Admin</a></li></ul></md-toolbar>')}]);
//# sourceMappingURL=../maps/scripts/app-af2b63c615.js.map
